<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; TEMA 4: REGRESIÓN LOGISTICA – Análisis Estadístico con Ordenador de Datos Médicos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./TEMA-5.html" rel="next">
<link href="./TEMA-3.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./TEMA-4.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">TEMA 4: REGRESIÓN LOGISTICA</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Análisis Estadístico con Ordenador de Datos Médicos</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bienvenido!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TEMA-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">TEMA 1: PRUEBAS DIAGNÓSTICAS Y CURVAS ROC</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TEMA-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">TEMA 2: ANÁLISIS DE LA VARIANZA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TEMA-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">TEMA 3: REGRESIÓN LINEAL MÚLTIPLE</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TEMA-4.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">TEMA 4: REGRESIÓN LOGISTICA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TEMA-5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">TEMA 5: ANÁLISIS DE SUPERVIVENCIA</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción"><span class="header-section-number">4.1</span> Introducción</a></li>
  <li><a href="#regresión-lineal-versus-logística" id="toc-regresión-lineal-versus-logística" class="nav-link" data-scroll-target="#regresión-lineal-versus-logística"><span class="header-section-number">4.2</span> Regresión lineal versus logística</a></li>
  <li><a href="#breve-introducción-al-método-de-estimación-de-máxima-verosimilitud" id="toc-breve-introducción-al-método-de-estimación-de-máxima-verosimilitud" class="nav-link" data-scroll-target="#breve-introducción-al-método-de-estimación-de-máxima-verosimilitud"><span class="header-section-number">4.3</span> Breve introducción al método de estimación de máxima verosimilitud</a></li>
  <li><a href="#regresión-logística-univariable-versus-multivariable" id="toc-regresión-logística-univariable-versus-multivariable" class="nav-link" data-scroll-target="#regresión-logística-univariable-versus-multivariable"><span class="header-section-number">4.4</span> Regresión logística univariable versus multivariable</a></li>
  <li><a href="#regresión-logística-binaria-univariable" id="toc-regresión-logística-binaria-univariable" class="nav-link" data-scroll-target="#regresión-logística-binaria-univariable"><span class="header-section-number">4.5</span> Regresión logística binaria univariable</a>
  <ul class="collapse">
  <li><a href="#variable-independiente-cuantitativa" id="toc-variable-independiente-cuantitativa" class="nav-link" data-scroll-target="#variable-independiente-cuantitativa"><span class="header-section-number">4.5.1</span> Variable independiente cuantitativa</a></li>
  <li><a href="#variable-independiente-cualitativa" id="toc-variable-independiente-cualitativa" class="nav-link" data-scroll-target="#variable-independiente-cualitativa"><span class="header-section-number">4.5.2</span> Variable independiente cualitativa</a></li>
  </ul></li>
  <li><a href="#regresión-logística-binaria-multivariable" id="toc-regresión-logística-binaria-multivariable" class="nav-link" data-scroll-target="#regresión-logística-binaria-multivariable"><span class="header-section-number">4.6</span> Regresión logística binaria multivariable</a>
  <ul class="collapse">
  <li><a href="#interacción" id="toc-interacción" class="nav-link" data-scroll-target="#interacción"><span class="header-section-number">4.6.1</span> Interacción</a></li>
  <li><a href="#selección-de-modelos" id="toc-selección-de-modelos" class="nav-link" data-scroll-target="#selección-de-modelos"><span class="header-section-number">4.6.2</span> Selección de modelos</a></li>
  <li><a href="#calidad-de-un-modelo" id="toc-calidad-de-un-modelo" class="nav-link" data-scroll-target="#calidad-de-un-modelo"><span class="header-section-number">4.6.3</span> Calidad de un modelo</a></li>
  <li><a href="#curva-roc-y-auc-después-de-un-modelo-de-regresión-logística" id="toc-curva-roc-y-auc-después-de-un-modelo-de-regresión-logística" class="nav-link" data-scroll-target="#curva-roc-y-auc-después-de-un-modelo-de-regresión-logística"><span class="header-section-number">4.6.4</span> Curva ROC y AUC después de un modelo de regresión logística</a></li>
  <li><a href="#reporte-de-resultados" id="toc-reporte-de-resultados" class="nav-link" data-scroll-target="#reporte-de-resultados"><span class="header-section-number">4.6.5</span> Reporte de resultados</a></li>
  <li><a href="#condiciones-de-aplicación" id="toc-condiciones-de-aplicación" class="nav-link" data-scroll-target="#condiciones-de-aplicación"><span class="header-section-number">4.6.6</span> Condiciones de aplicación</a></li>
  </ul></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography">Referencias</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">TEMA 4: REGRESIÓN LOGISTICA</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Cuando hayamos terminado este tema, seremos capaces de:</p>
<pre><code>-   Comprender los conceptos básicos de la regresión logística y su aplicación en el análisis de datos médicos.
-   Aprender a interpretar los coeficientes de un modelo de regresión logística.
-   Desarrollar habilidades para evaluar la calidad y el ajuste de un modelo de regresión logística.</code></pre>
<section id="introducción" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="introducción"><span class="header-section-number">4.1</span> Introducción</h2>
<p>La regresión es una herramienta común en estadística para probar y cuantificar relaciones entre variables. Las dos regresiones más comunes son la regresión lineal y la logística. Una regresión <strong>lineal</strong> se utiliza cuando la variable dependiente es <strong>cuantitativa</strong>, mientras que una regresión <strong>logística</strong> se utiliza cuando la variable dependiente es <strong>cualitativa</strong>, en concreto dicotómica (binaria). Tanto la regresión lineal como la logística se dividen en diferentes tipos. Antes de detallarlos, recapitulemos primero qué tipo de variable puede ser:</p>
<ul>
<li>Una <strong>variable cuantitativa</strong> mide una cantidad; los valores que puede tomar son números. Se divide en:
<ul>
<li><strong>Discreta</strong>: los valores que puede tomar son contables y tienen un número finito de posibilidades (los valores suelen ser enteros, por ejemplo, el número de hijos).</li>
<li><strong>Continua</strong>: los valores que puede tomar no son contables y tienen un número infinito de posibilidades (los valores suelen tener decimales, o al menos los decimales son técnicamente posibles, por ejemplo, el peso).<br>
</li>
</ul></li>
<li>Una <strong>variable cualitativa</strong> (también conocida como categórica) no es numérica y sus valores se ajustan a categorías. También se divide en dos tipos:
<ul>
<li><strong>Nominal</strong>: no es posible ni está implícito un orden en las categorías (por ejemplo, el sexo).</li>
<li><strong>Ordinal</strong>: existe un orden implícito en las categorías (por ejemplo, el estado de salud, como malo/regular/bueno).</li>
</ul></li>
</ul>
<p>Una variable <strong>binaria</strong>, también conocida como dicotómica, es un caso especial de variable cualitativa nominal cuando hay <strong>solo dos categorías</strong>.</p>
<p>Ahora que los tipos de variables están claros, resumamos los diferentes tipos de regresión:</p>
<ul>
<li><strong>Regresión lineal</strong>:<br>
- La regresión lineal <strong>simple</strong> se utiliza cuando el objetivo es estimar la relación entre una variable dependiente cuantitativa continua (también llamada variable de resultado o respuesta) y <strong>solo una</strong> variable independiente (también llamada variable explicativa, covariable o predictora) de cualquier tipo.<br>
- La regresión lineal <strong>múltiple</strong> se utiliza cuando el objetivo es estimar la relación entre una variable dependiente cuantitativa continua y <strong>dos o más</strong> variables independientes (de nuevo, de cualquier tipo).<br>
</li>
<li><strong>Regresión logística</strong>: - La regresión logística <strong>binaria</strong> se utiliza cuando el objetivo es estimar la relación entre una <strong>variable dependiente binaria</strong> (= dos resultados) y una o más variables independientes (de cualquier tipo).<br>
- La regresión logística <strong>multinomial</strong> se utiliza cuando el objetivo es estimar la relación entre una <strong>variable dependiente nominal</strong> con tres o más resultados <em>no ordenados</em> y una o más variables independientes (de cualquier tipo). - La regresión logística <strong>ordinal</strong> se utiliza cuando el objetivo es estimar la relación entre una <strong>variable dependiente ordinal</strong> con tres o más resultados <em>ordenados</em> y una o más variables independientes (de cualquier tipo).</li>
</ul>
<p>Ten en cuenta que existe otro tipo de regresión: la <strong>regresión de Poisson</strong>. Este tipo de regresión se utiliza cuando el objetivo es estimar la relación entre una variable dependiente que está en forma de datos de conteo (número de ocurrencias de un evento de interés durante un período de tiempo o espacio determinado, por ejemplo, <span class="math inline">\(0, 1, 2, \ldots\)</span>) y una o más variables independientes.</p>
<p>Las regresiones logísticas y de Poisson forman parte de un tipo más amplio de modelo llamado <strong>modelos lineales generalizados</strong> (abreviado como <strong>GLM</strong>). El nombre “modelos lineales generalizados” proviene del hecho de que estos modelos permiten “generalizar” el modelo lineal clásico. De hecho, se pueden utilizar en muchas situaciones, por ejemplo, al analizar una variable dependiente que no es necesariamente cuantitativa continua o cuando los residuos no se distribuyen normalmente (que son requisitos previos para un modelo lineal). El libro <strong>An Introduction to Categorical Data Analysis</strong> es una excelente introducción del análisis de datos categóricos, incluidas las regresiones logísticas y de Poisson <span class="citation" data-cites="Agresti07">[<a href="#ref-Agresti07" role="doc-biblioref">1</a>]</span>. Otro referente es el libro <strong>Regression Methods in Biostatistics: Linear, Logistic, Survival, and Repeated Measures Models</strong> <span class="citation" data-cites="Vittinghoff12">[<a href="#ref-Vittinghoff12" role="doc-biblioref">2</a>]</span>.</p>
</section>
<section id="regresión-lineal-versus-logística" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="regresión-lineal-versus-logística"><span class="header-section-number">4.2</span> Regresión lineal versus logística</h2>
<p>Sabemos que una regresión lineal es una forma conveniente de estimar la relación entre una variable dependiente cuantitativa continua y una o más variables independientes (de cualquier tipo). Por ejemplo, supongamos que nos gustaría estimar la relación entre dos variables cuantitativas, <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>. Usando el método de mínimos cuadrados ordinarios (el estimador más común utilizado en la regresión lineal), obtenemos la siguiente línea de regresión:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TEMA-4_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Ahora supongamos que estamos interesados en estimar el impacto de la edad en si un paciente tiene o no una determinada enfermedad. La edad se considera una variable cuantitativa continua, mientras que tener la enfermedad es binario (un paciente está enfermo o sano). Visualmente, podríamos tener algo como esto:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TEMA-4_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Si ajustamos una línea de regresión (utilizando el método de mínimos cuadrados ordinarios) a los puntos, obtenemos el siguiente gráfico:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TEMA-4_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Vemos que la línea de regresión va por debajo de 0 y por encima de 1 con respecto al eje <span class="math inline">\(y\)</span>. Dado que la variable dependiente <code>enfermedad</code> no puede tomar valores por debajo de 0 (= sano) ni por encima de 1 (= enfermo), ¡es obvio que una regresión lineal no es apropiada para estos datos. Además de esta limitación, los supuestos de normalidad y homocedasticidad, que se requieren en la regresión lineal, claramente no son apropiados con estos datos, ya que la variable dependiente es binaria y sigue una distribución Binomial. R no te impedirá realizar una regresión lineal con datos binarios, pero producirá un modelo de poco interés (incorrectamente especificado con una mala interpretación de la relación entre variables). Aquí es donde una regresión logística se vuelve útil, ya que toma en consideración estas limitaciones <span class="citation" data-cites="Menard02">[<a href="#ref-Menard02" role="doc-biblioref">3</a>]</span>.</p>
<p>Aplicado a nuestro ejemplo, así es como se ajustan los puntos utilizando una regresión logística binaria:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TEMA-4_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Está claro que este modelo es más apropiado. La curva (conocida como <strong>sigmoide</strong>) se obtiene mediante una transformación de los valores predichos. Hay varias opciones posibles para la función de enlace, cuyo objetivo es restringir los valores predichos para que estén dentro del rango de los valores observados. La más utilizada en la práctica es la <strong>función logit</strong>, que relaciona la probabilidad de ocurrencia de un evento (acotada entre 0 y 1) con la combinación lineal de las variables independientes. La función logit también resulta ser la función de enlace canónica para una distribución de Bernoulli o Binomial. Esta transformación asegura que, sin importar en qué rango se encuentren los valores de <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span> solo tomará números entre 0 y 1.</p>
<p>Su formula es:</p>
<p><span class="math display">\[logit(\pi) = \log\left(\frac{\pi}{1 - \pi}\right)\]</span></p>
<p>donde <span class="math inline">\(\pi\)</span> es la probabilidad de que ocurra un evento (éxito) y se denota como <span class="math inline">\(\pi = P(éxito)\)</span>.</p>
<p>Se podría decir que los valores ajustados (= representados por la curva azul) que toman valores entre 0 y 1 tampoco parecen tener sentido, ya que un paciente solo puede estar sano o enfermo (y, por lo tanto, la variable dependiente solo puede tomar el valor 0 o 1, respectivamente). Sin embargo, en una regresión logística binaria no se modela directamente el resultado de no enfermedad/enfermedad, sino la <strong>probabilidad</strong> de que un paciente tenga la enfermedad o no, dadas sus características. Esta probabilidad se enmarcará en términos de una probabilidad de observar o no la enfermedad en un paciente, que de hecho está incluida entre 0 y 1, o 0% y 100%.</p>
<p>En general, con una regresión logística nos gustaría <strong>modelar cómo varía la probabilidad de éxito con las variables independientes</strong> y determinar si estos cambios son estadísticamente significativos o no. En realidad, vamos a modelar el logaritmo de los odds, y el modelo de regresión logística se escribirá de la siguiente manera:</p>
<p><span class="math display">\[\begin{align}
\log(odds(éxito)) &amp;= logit(\pi) \\
&amp;= \log\left(\frac{\pi}{1 - \pi}\right) \\
&amp;= \beta_0 + \beta_1 X_1 + \cdots + \beta_p X_p
\end{align}\]</span></p>
<p>donde <span class="math inline">\(\pi\)</span> <span class="math inline">\((0 \le \pi \le 1)\)</span> es la probabilidad de que ocurra un evento (éxito) y se denota como <span class="math inline">\(\pi = P(éxito)\)</span>. Encontramos los valores de <span class="math inline">\(\hat{\beta}_0\)</span>, <span class="math inline">\(\hat{\beta}_1\)</span>, <span class="math inline">\(\ldots\)</span>, <span class="math inline">\(\hat{\beta}_p\)</span>, que se utilizan como estimaciones para <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\ldots\)</span>, <span class="math inline">\(\beta_p\)</span>, utilizando el método de máxima verosimilitud. Este método es uno de los varios métodos utilizados en estadística para estimar los parámetros de un modelo matemático. El objetivo del estimador es estimar los parámetros <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\ldots\)</span>, <span class="math inline">\(\beta_p\)</span> que maximizan la función de log-verosimilitud. Las regresiones logísticas son muy comunes en el campo de la medicina, por ejemplo, para:</p>
<ul>
<li>Estimar los factores de riesgo asociados con una enfermedad o una condición dañina.</li>
<li>Predecir el riesgo de desarrollar una enfermedad basándose en las características de un paciente.</li>
<li>Determinar los factores biológicos más importantes asociados con una enfermedad o condición específica.</li>
</ul>
<p>Sin embargo, las regresiones logísticas se utilizan en muchos otros dominios, por ejemplo, en:</p>
<ul>
<li><strong>Sector bancario</strong>: estimar la solvencia de un deudor basándose en su perfil (ingresos, activos, pasivos, etc.).</li>
<li><strong>Marketing</strong>: estimar la propensión de un cliente a comprar un producto o servicio basándose en su perfil (edad, sexo, salario, compras anteriores, etc.).</li>
<li><strong>Deportes</strong>: estimar la probabilidad de que un jugador gane contra otro jugador en función de las características de los dos oponentes.</li>
<li><strong>Política</strong>: responder a la pregunta “¿Votaría un ciudadano por nuestro partido político en las próximas elecciones?”.
<ul>
<li>Etc.</li>
</ul></li>
</ul>
</section>
<section id="breve-introducción-al-método-de-estimación-de-máxima-verosimilitud" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="breve-introducción-al-método-de-estimación-de-máxima-verosimilitud"><span class="header-section-number">4.3</span> Breve introducción al método de estimación de máxima verosimilitud</h2>
<p>El método de máxima verosimilitud es un enfoque estadístico utilizado para estimar los parámetros de un modelo matemático. La idea principal detrás de este método es encontrar los valores de los parámetros que maximizan la función de verosimilitud, que mide qué tan probable es observar los datos dados los parámetros del modelo. En el contexto de la regresión logística, el método de máxima verosimilitud se utiliza para estimar los coeficientes del modelo (<span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, …, <span class="math inline">\(\beta_p\)</span>) que describen la relación entre las variables independientes y la variable dependiente binaria. La función de verosimilitud se define como la probabilidad conjunta de observar los datos dados los parámetros del modelo. La función de verosimilitud para la regresión logística se expresa como:</p>
<p><span class="math display">\[L(\beta_0, \beta_1, \ldots, \beta_p) = \prod_{i=1}^{n} P(Y_i | X_i; \beta_0, \beta_1, \ldots, \beta_p)\]</span></p>
<p>donde <span class="math inline">\(P(Y_i | X_i; \beta_0, \beta_1, \ldots, \beta_p)\)</span> es la probabilidad condicional de observar el valor <span class="math inline">\(Y_i\)</span> dado el vector de variables independientes <span class="math inline">\(X_i\)</span> y los parámetros del modelo.</p>
<p>Para facilitar el proceso de maximización, se suele trabajar con la función de log-verosimilitud, que es el logaritmo natural de la función de verosimilitud:</p>
<p><span class="math display">\[\ell(\beta_0, \beta_1, \ldots, \beta_p) = \log L(\beta_0, \beta_1, \ldots, \beta_p) = \sum_{i=1}^{n} \log P(Y_i | X_i; \beta_0, \beta_1, \ldots, \beta_p)\]</span></p>
<p>El objetivo del método de máxima verosimilitud es encontrar los valores de los parámetros (<span class="math inline">\(\hat{\beta}_0\)</span>, <span class="math inline">\(\hat{\beta}_1\)</span>, …, <span class="math inline">\(\hat{\beta}_p\)</span>) que maximizan la función de log-verosimilitud. Esto se logra resolviendo el siguiente problema de optimización:</p>
<p><span class="math display">\[\hat{\beta}_0, \hat{\beta}_1, \ldots, \hat{\beta}_p = \arg\max_{\beta_0, \beta_1, \ldots, \beta_p} \ell(\beta_0, \beta_1, \ldots, \beta_p)\]</span> Para el modelo de regresión logística, la función de log-verosimilitud para la regresión logística binaria se puede expresar como: <span class="math display">\[\ell(\beta_0, \beta_1, \ldots, \beta_p) = \sum_{i=1}^{n} \left[ Y_i \log(\pi_i) + (1 - Y_i) \log(1 - \pi_i) \right]\]</span> donde <span class="math inline">\(\pi_i\)</span> es la probabilidad predicha de que <span class="math inline">\(Y_i = 1\)</span> dado el vector de variables independientes <span class="math inline">\(X_i\)</span> y los parámetros del modelo, y se calcula como:</p>
<p><span class="math display">\[\pi_i = \frac{1}{1 + e^{-(\beta_0 + \beta_1 X_{i1} + \ldots + \beta_p X_{ip})}}\]</span> Notese que la función de log-verosimilitud es una suma de términos que dependen de los valores observados de la variable dependiente <span class="math inline">\(Y_i\)</span> y las probabilidades predichas <span class="math inline">\(\pi_i\)</span>. El primer término, <span class="math inline">\(Y_i \log(\pi_i)\)</span>, contribuye a la función de log-verosimilitud cuando <span class="math inline">\(Y_i = 1\)</span>, mientras que el segundo término, <span class="math inline">\((1 - Y_i) \log(1 - \pi_i)\)</span>, contribuye cuando <span class="math inline">\(Y_i = 0\)</span>. Esta formula se deriva de la distribución Bernoulli de la variable dependiente en la regresión logística binaria. Asi, la función de log-verosimilitud mide qué tan bien el modelo con los parámetros dados explica los datos observados. La maximización de esta función permite encontrar los valores de los parámetros que mejor explican la relación entre las variables independientes y la variable dependiente binaria. Además la función de log-verosimilitud es más fácil de manejar matemáticamente que la función de verosimilitud original, ya que convierte el producto en una suma, lo que simplifica los cálculos y la optimización.</p>
<p>El método de máxima verosimilitud es ampliamente utilizado en estadística y econometría debido a sus propiedades deseables, como la consistencia y la eficiencia de los estimadores. Sin embargo, es importante tener en cuenta que la maximización de la función de log-verosimilitud puede ser un proceso computacionalmente intensivo, especialmente cuando se trabaja con grandes conjuntos de datos o modelos complejos. En R, la función <code>glm()</code> utiliza el método de máxima verosimilitud para estimar los coeficientes de un modelo de regresión logística. Y se computa de forma iterativa utilizando el <strong>algoritmo de Newton-Raphson</strong> o el método de Fisher Scoring. El primero es un método numérico para encontrar las raíces de una función, mientras que el segundo es una variante del primero que utiliza la información de la varianza de los datos para mejorar la convergencia. Las raíces de la función de log-verosimilitud corresponden a los valores de los parámetros que maximizan la función, es decir, los estimadores de máxima verosimilitud. Y esto se hace iterativamente hasta que se alcanza la convergencia, es decir, hasta que los cambios en los valores de los parámetros entre iteraciones sucesivas son suficientemente pequeños. Este algoritmo es eficiente y converge rápidamente en la mayoría de los casos, lo que lo hace adecuado para estimar los coeficientes de modelos de regresión logística. Y se describe matematicamente como: <span class="math display">\[\beta^{(t+1)} = \beta^{(t)} - H^{-1}(\beta^{(t)}) \nabla \ell(\beta^{(t)})\]</span> donde <span class="math inline">\(\beta^{(t)}\)</span> es el vector de parámetros en la iteración <span class="math inline">\(t\)</span>, <span class="math inline">\(\nabla \ell(\beta^{(t)})\)</span> es el gradiente de la función de log-verosimilitud evaluado en <span class="math inline">\(\beta^{(t)}\)</span>, y <span class="math inline">\(H(\beta^{(t)})\)</span> es la matriz Hessiana de la función de log-verosimilitud evaluada en <span class="math inline">\(\beta^{(t)}\)</span>. El proceso se repite hasta que se alcanza la convergencia. Un ejemplo en R es el siguiente:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar datos</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>logit_pi <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> X</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">exp</span>(logit_pi) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(logit_pi))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> pi)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X, <span class="at">Y =</span> Y)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>           X Y
1  1.3709584 1
2 -0.5646982 0
3  0.3631284 0
4  0.6328626 1
5  0.4042683 1
6 -0.1061245 1</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ajustar modelo de regresión logística</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> data, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># manualmente calcular la función de log-verosimilitud</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>log_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(params, data) {</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  beta_0 <span class="ot">&lt;-</span> params[<span class="dv">1</span>]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  beta_1 <span class="ot">&lt;-</span> params[<span class="dv">2</span>]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> data<span class="sc">$</span>X</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> data<span class="sc">$</span>Y</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  logit_pi <span class="ot">&lt;-</span> beta_0 <span class="sc">+</span> beta_1 <span class="sc">*</span> X</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  pi <span class="ot">&lt;-</span> <span class="fu">exp</span>(logit_pi) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(logit_pi))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">*</span> <span class="fu">log</span>(pi) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> Y) <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> pi))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span>ll) <span class="co"># devolver el negativo para minimizar</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># encontrar los valores de beta_0 y beta_1 que maximizan la función de log-verosimilitud</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>initial_params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>optim_result <span class="ot">&lt;-</span> <span class="fu">optim</span>(initial_params, log_likelihood, <span class="at">data =</span> data)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># mostrar los resultados de optimización</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>optim_result<span class="sc">$</span>par</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.91913376  0.03542776</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparar con los coeficientes del modelo ajustado</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)           X 
-0.91915123  0.03524851 </code></pre>
</div>
</div>
</section>
<section id="regresión-logística-univariable-versus-multivariable" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="regresión-logística-univariable-versus-multivariable"><span class="header-section-number">4.4</span> Regresión logística univariable versus multivariable</h2>
<p>Las regresiones logísticas binarias univariables y luego las regresiones logísticas binarias multivariables. Recuerda que en ambos casos, la variable dependiente debe ser una variable cualitativa con dos resultados (de ahí el nombre de regresión logística <em>binaria</em>). La diferencia entre una regresión logística binaria univariable y multivariable radica en que:</p>
<ul>
<li>Para una regresión logística binaria <strong>univariable</strong>, solo hay <strong>una variable independiente</strong>.</li>
<li>Para una regresión logística binaria <strong>multivariable</strong>, hay <strong>dos o más variables independientes</strong>.</li>
</ul>
<p>Es cierto que el término “univariable” puede ser confuso aquí porque hay dos variables en el modelo (es decir, una variable dependiente y una variable independiente). Sin embargo, se llama regresión logística binaria univariable para indicar que solo se considera una variable independiente en el modelo, a diferencia de la regresión logística binaria multivariable, donde se consideran varias variables independientes en el modelo.</p>
<p>Para hacer un paralelismo con la regresión lineal:</p>
<ul>
<li>Una regresión logística binaria univariable es el equivalente a una regresión lineal simple.</li>
<li>Una regresión logística binaria multivariable es el equivalente a una regresión lineal múltiple.</li>
</ul>
<p>cuando la variable dependiente es binaria en lugar de cuantitativa continua. Esta es la razón por la que una regresión logística binaria univariable a veces se llama regresión logística binaria simple y una regresión logística binaria multivariable a veces se llama regresión logística binaria múltiple.</p>
<p>El número de variables dependientes caracteriza el modelo como univariado o multivariado; univariado se refiere a un modelo con una sola variable dependiente, mientras que multivariado se refiere a un modelo que predice simultáneamente más de una variable dependiente. Por lo general, la intención es diferenciar los modelos en función del número de variables independientes. Esta distinción se hace gracias a los términos univariable y multivariable. Multivariable se refiere a un modelo que relaciona múltiples variables predictoras con una variable dependiente, mientras que univariable se refiere a un modelo que relaciona una única variable independiente con una variable dependiente.</p>
<p>Para estas ilustrar la aplicación del método vamos a utilizar el conjunto de datos <strong>“Heart Disease”</strong>, disponible en el paquete de R <code>{kmed}</code>. Este data frame consta de 14 variables, de las cuales solo vamos a utilizar 5:</p>
<ol type="1">
<li><code>age</code>: edad en años</li>
<li><code>sex</code>: sexo (FALSE = mujer, TRUE = hombre)</li>
<li><code>cp</code>: tipo de dolor torácico (1 = angina típica, 2 = angina atípica, 3 = dolor no anginoso, 4 = asintomático)</li>
<li><code>thalach</code>: frecuencia cardíaca máxima alcanzada</li>
<li><code>class</code>: diagnóstico de enfermedad cardíaca (dividido en 4 clases)</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># importar y renombrar el conjunto de datos</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kmed)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> heart</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># seleccionar variables</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    age,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    sex,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    cp,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    thalach,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    class</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimir la estructura del conjunto de datos</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   297 obs. of  5 variables:
 $ age    : num  63 67 67 37 41 56 62 57 63 53 ...
 $ sex    : logi  TRUE TRUE TRUE TRUE FALSE TRUE ...
 $ cp     : Factor w/ 4 levels "1","2","3","4": 1 4 4 3 2 2 4 4 4 4 ...
 $ thalach: num  150 108 129 187 172 178 160 163 147 155 ...
 $ class  : int  0 2 1 0 0 0 3 0 2 1 ...
 - attr(*, "na.action")= 'omit' Named int [1:6] 88 167 193 267 288 303
  ..- attr(*, "names")= chr [1:6] "88" "167" "193" "267" ...</code></pre>
</div>
</div>
<p>Ten en cuenta que se utiliza el operador <strong>pipe</strong> <code>|&gt;</code> y el paquete <code>{dplyr}</code> para seleccionar variables. Consulta <a href="https://www.google.com/search?q=/blog/introduction-to-data-manipulation-in-r-with-dplyr/">más técnicas de manipulación de datos</a> utilizando este paquete si estás interesado. Para mayor legibilidad, renombramos las variables <code>cp</code>, <code>thalach</code> y <code>class</code> con nombres más informativos:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># renombrar variables</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">chest_pain =</span> cp,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_heartrate =</span> thalach,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">heart_disease =</span> class</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Para una regresión logística binaria en R, se recomienda que todas las variables cualitativas se transformen en factores. Transformamos las variables <code>sex</code> y <code>chest_pain</code> en factor y establecemos las etiquetas correspondientes:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recodificar sexo</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat<span class="sc">$</span>sex,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"mujer"</span>, <span class="st">"hombre"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># recodificar dolor_torácico</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>chest_pain <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat<span class="sc">$</span>chest_pain,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"angina típica"</span>, <span class="st">"angina atípica"</span>, <span class="st">"dolor no anginoso"</span>, <span class="st">"asintomático"</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>La variable dependiente en el ejemplot, <code>heart_disease</code> (nuestra variable dependiente) está actualmente codificada con valores discretos <a href="https://www.google.com/search?q=/blog/data-types-in-r/%23integer">integers</a> que van de 0 a 4. Por lo tanto, primero la clasificamos en 2 clases estableciendo 0 para los valores 0 y 1 para los valores distintos de 0, utilizando la función <code>ifelse()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recodificar heart_disease en 2 clases</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>heart_disease <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>heart_disease <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Luego la transformamos en un factor y establecemos las etiquetas correspondientes utilizando la función <code>factor()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># establecer etiquetas para heart_disease</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>heart_disease <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat<span class="sc">$</span>heart_disease,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sin enfermedad"</span>, <span class="st">"enfermedad"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Ten en cuenta el orden de los niveles de tu variable dependiente, ya que tendrá un impacto en las interpretaciones. En R, el primer nivel dado por <code>levels()</code> siempre se toma como el nivel de referencia. En nuestro caso, el primer nivel es la ausencia de la enfermedad y el segundo nivel es la presencia de la enfermedad:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(dat<span class="sc">$</span>heart_disease)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sin enfermedad" "enfermedad"    </code></pre>
</div>
</div>
<p>Esto significa que cuando construyamos los modelos, estimaremos el impacto de la(s) variable(s) independiente(s) en la <strong>presencia</strong> de la enfermedad. Esta es la razón por la que, para variables dependientes del tipo no/sí, falso/verdadero, ausencia/presencia de una condición, etc., se recomienda establecer el nivel no, falso, ausencia de la condición, etc., como el nivel de referencia. De hecho, suele ser más fácil interpretar el impacto de una variable independiente en la presencia de una condición/enfermedad que lo contrario. Si deseas cambiar el nivel de referencia, esto se puede hacer con la función <code>relevel()</code>. Aquí tienes una vista previa del data frame final y algunas básicas:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimir las primeras 6 observaciones</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  age    sex        chest_pain max_heartrate  heart_disease
1  63 hombre     angina típica           150 sin enfermedad
2  67 hombre      asintomático           108     enfermedad
3  67 hombre      asintomático           129     enfermedad
4  37 hombre dolor no anginoso           187 sin enfermedad
5  41  mujer    angina atípica           172 sin enfermedad
6  56 hombre    angina atípica           178 sin enfermedad</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estadísticas descriptivas básicas</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      age            sex                  chest_pain  max_heartrate  
 Min.   :29.00   mujer : 96   angina típica    : 23   Min.   : 71.0  
 1st Qu.:48.00   hombre:201   angina atípica   : 49   1st Qu.:133.0  
 Median :56.00                dolor no anginoso: 83   Median :153.0  
 Mean   :54.54                asintomático     :142   Mean   :149.6  
 3rd Qu.:61.00                                        3rd Qu.:166.0  
 Max.   :77.00                                        Max.   :202.0  
        heart_disease
 sin enfermedad:160  
 enfermedad    :137  
                     
                     
                     
                     </code></pre>
</div>
</div>
<p>El data frame está ahora listo para ser analizado más a fondo a través de regresiones logísticas binarias univariables y multivariables.</p>
</section>
<section id="regresión-logística-binaria-univariable" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="regresión-logística-binaria-univariable"><span class="header-section-number">4.5</span> Regresión logística binaria univariable</h2>
<p>Como se mencionó anteriormente, comenzamos con una regresión logística binaria univariable, es decir, una regresión logística binaria con una sola variable independiente. En R, se puede realizar una regresión logística binaria con la función <code>glm()</code> y el argumento <code>family = "binomial"</code>. Al igual que en la regresión lineal, la fórmula utilizada dentro de la función debe escribirse como <code>variable dependiente ~ variable independiente</code> (¡en este orden!). Mientras que la variable dependiente debe ser categórica con dos niveles, la variable independiente puede ser de cualquier tipo. Sin embargo, las interpretaciones difieren dependiendo de si la variable independiente es cualitativa o cuantitativa. Para ser exhaustivos, ilustramos este tipo de regresión con una variable independiente tanto cuantitativa como cualitativa, comenzando con una variable independiente cuantitativa.</p>
<section id="variable-independiente-cuantitativa" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="variable-independiente-cuantitativa"><span class="header-section-number">4.5.1</span> Variable independiente cuantitativa</h3>
<p>Supongamos que queremos estimar el impacto de la edad de un paciente en la presencia de una enfermedad cardíaca. En este caso, <code>edad</code> es nuestra variable independiente y <code>enfermedad_cardiaca</code> es nuestra variable dependiente:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar modelo</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(heart_disease <span class="sc">~</span> age,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Los resultados del modelo se guardan en el objeto <code>m1</code>. De nuevo, al igual que en la regresión lineal, se puede acceder a los resultados gracias a la función <code>summary()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimir resultados</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = heart_disease ~ age, family = "binomial", data = dat)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -3.05122    0.76862  -3.970  7.2e-05 ***
age          0.05291    0.01382   3.829 0.000128 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 409.95  on 296  degrees of freedom
Residual deviance: 394.25  on 295  degrees of freedom
AIC: 398.25

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>Los resultados más importantes en esta salida se muestran en la tabla después de <code>Coefficients</code>. La parte inferior de la salida resume la distribución de los residuos de devianza. En resumen, los residuos de devianza miden qué tan bien se ajustan las observaciones al modelo. Cuanto más cerca esté el residuo de 0, mejor será el ajuste de la observación. Dentro de la tabla <code>Coefficients</code>, nos centramos en la primera y última columna (las otras dos columnas corresponden al error estándar y al estadístico de prueba, que se utilizan para calcular el valor <span class="math inline">\(p\)</span>):</p>
<ul>
<li>La columna <code>Estimate</code> corresponde a los coeficientes <span class="math inline">\(\hat{\beta}_0\)</span> y <span class="math inline">\(\hat{\beta}_1\)</span>.</li>
<li>La columna <code>Pr(&gt;|z|)</code> corresponde a los valores <span class="math inline">\(p\)</span>.</li>
</ul>
<p>R realiza una prueba de hipótesis para cada coeficiente, es decir, <span class="math inline">\(H_0: \beta_j = 0\)</span> versus <span class="math inline">\(H_1: \beta_j \neq 0\)</span> para <span class="math inline">\(j = 0, 1\)</span> a través de la <strong>prueba de Wald</strong>, e imprime los valores <span class="math inline">\(p\)</span> en la última columna. Por lo tanto, podemos comparar estos valores <span class="math inline">\(p\)</span> con el nivel de significancia elegido (generalmente <span class="math inline">\(\alpha = 0.05\)</span>) para concluir si cada uno de los coeficientes es significativamente diferente de 0 o no. Cuanto menor sea el valor <span class="math inline">\(p\)</span>, mayor será la evidencia de que el coeficiente es diferente de 0. Esto es similar a la regresión lineal. Los coeficientes son un poco más difíciles de interpretar en la regresión logística que en la regresión lineal porque la relación entre las variables dependientes e independientes no es lineal. Interpretemos primero el coeficiente de la edad, <span class="math inline">\(\hat{\beta}_1\)</span>, que es el coeficiente más importante de los dos.</p>
<p>Primero, dado que el valor <span class="math inline">\(p\)</span> de la prueba sobre el coeficiente para la edad es &lt; 0.05, concluimos que es significativamente diferente de 0, lo que significa que la edad está significativamente asociada con la presencia de una enfermedad cardíaca (al nivel de significancia del 5%). Ten en cuenta que si la prueba no fuera significativa (es decir, el valor <span class="math inline">\(p \ge \alpha\)</span>), nos abstendríamos de interpretar el coeficiente, ya que significa que, basándonos en los datos disponibles, no podemos concluir que la edad esté asociada con la presencia de una enfermedad cardíaca en la población.</p>
<p>Segundo, recuerda que:</p>
<ul>
<li>Cuando <span class="math inline">\(\beta_1 = 0\)</span>, <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> son independientes.</li>
<li>Cuando <span class="math inline">\(\beta_1 &gt; 0\)</span>, la probabilidad de que <span class="math inline">\(Y = 1\)</span> <em>aumenta</em> con <span class="math inline">\(X\)</span>.</li>
<li>Cuando <span class="math inline">\(\beta_1 &lt; 0\)</span>, la probabilidad de que <span class="math inline">\(Y = 1\)</span> <em>disminuye</em> con <span class="math inline">\(X\)</span>.</li>
</ul>
<p>En nuestro contexto, tenemos:</p>
<ul>
<li>Cuando <span class="math inline">\(\hat{\beta}_1 = 0\)</span>, la probabilidad de desarrollar una enfermedad cardíaca es <em>independiente</em> de la edad.</li>
<li>Cuando <span class="math inline">\(\hat{\beta}_1 &gt; 0\)</span>, la probabilidad de desarrollar una enfermedad cardíaca <em>aumenta</em> con la edad.</li>
<li>Cuando <span class="math inline">\(\hat{\beta}_1 &lt; 0\)</span>, la probabilidad de desarrollar una enfermedad cardíaca <em>disminuye</em> con la edad.</li>
</ul>
<p>Aquí tenemos <span class="math inline">\(\hat{\beta}_1 =\)</span> 0.053 <span class="math inline">\(&gt; 0\)</span>, por lo que ya sabemos que cuanto mayor es el paciente, más probable es que desarrolle una enfermedad cardíaca. Esto tiene sentido.</p>
<p>Ahora que conocemos la dirección de la relación, nos gustaría <strong>cuantificar</strong> esta relación. Esto se hace fácilmente gracias a los <strong>odds ratios (OR)</strong>. Los OR se encuentran tomando el exponencial de los coeficientes. En R, el exponencial se calcula gracias a la función <code>exp()</code>. La odds de un evento es la razón entre la probabilidad de que ocurra el evento y la probabilidad de que no ocurra. Por ejemplo, si la probabilidad de que un paciente desarrolle una enfermedad cardíaca es 0.8, entonces la probabilidad de que no desarrolle la enfermedad es 0.2, y los odds de desarrollar la enfermedad son <span class="math inline">\(0.8 / 0.2 = 4\)</span>. Esto significa que los odds a favor de desarrollar una enfermedad cardíaca son 4 a 1. Su formula es: <span class="math display">\[odds(éxito) = \frac{P(éxito)}{1 - P(éxito)}.\]</span> La OR es la razón entre dos odds. En nuestro caso, los OR se pueden interpretar como el cambio en los odds de desarrollar una enfermedad cardíaca cuando la edad aumenta en 1 unidad (es decir, 1 año). Matemáticamente, los OR se definen como:</p>
<p><span class="math display">\[OR = \frac{odds(éxito | X + 1)}{odds(éxito | X)}.\]</span></p>
<p>Los OR se pueden interpretar de la siguiente manera: el OR es el cambio multiplicativo en los odds a favor de <span class="math inline">\(Y = 1\)</span> cuando <span class="math inline">\(X\)</span> aumenta en 1 unidad. Aplicado a nuestro contexto, calculamos el OR para la edad calculando <span class="math inline">\(\exp(\hat{\beta}_1) =\)</span> exp(0.053).</p>
<p>Usando R, esto da:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OR para la edad</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(m1)[<span class="st">"age"</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     age 
1.054331 </code></pre>
</div>
</div>
<p>Podríamos tambiém multiplicar este valor por 10 para obtener el porcentaje de aumento en los odds cuando la edad aumenta en 10 años:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OR para un aumento de 10 años en la edad</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(m1)[<span class="st">"age"</span>] <span class="sc">*</span> <span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     age 
1.697345 </code></pre>
</div>
</div>
<p>Basándonos en este resultado, podemos decir que un año extra de edad aumenta los odds (es decir, la probabilidad) de desarrollar una enfermedad cardíaca en un factor de 1.054. Por lo tanto, los odds de desarrollar una enfermedad cardíaca aumentan en (1.054 - 1) <span class="math inline">\(\times\)</span> 100 = 5.4% cuando un paciente envejece un año.</p>
<p>Para resumir:</p>
<ul>
<li>Cuando el coeficiente <span class="math inline">\(\hat{\beta}_1 = 0 \Rightarrow\)</span> OR <span class="math inline">\(= \exp(\hat{\beta}_1) = 1 \Rightarrow P(Y = 1)\)</span> es <em>independiente</em> de <span class="math inline">\(X \Rightarrow\)</span> <em>no hay</em> relación entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>.</li>
<li>Cuando el coeficiente <span class="math inline">\(\hat{\beta}_1 &gt; 0 \Rightarrow\)</span> OR <span class="math inline">\(= \exp(\hat{\beta}_1) &gt; 1 \Rightarrow P(Y = 1)\)</span> <em>aumenta</em> con <span class="math inline">\(X \Rightarrow\)</span> hay una relación <em>positiva</em> entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>.</li>
<li>Cuando el coeficiente <span class="math inline">\(\hat{\beta}_1 &lt; 0 \Rightarrow\)</span> OR <span class="math inline">\(= \exp(\hat{\beta}_1) &lt; 1 \Rightarrow P(Y = 1)\)</span> <em>disminuye</em> con <span class="math inline">\(X \Rightarrow\)</span> hay una relación <em>negativa</em> entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>.</li>
</ul>
<p>Ahora interpretamos el intercepto <span class="math inline">\(\hat{\beta}_0\)</span>.</p>
<p>Primero, miramos el valor <span class="math inline">\(p\)</span> de la prueba sobre el intercepto. Siendo este valor <span class="math inline">\(p\)</span> &lt; 0.05, concluimos que el intercepto es significativamente diferente de 0 (al nivel de significancia del 5%).</p>
<p>Segundo, de manera similar a la regresión lineal, para obtener una interpretación del intercepto, necesitamos encontrar una situación en la que el otro coeficiente, <span class="math inline">\(\beta_1\)</span>, se anule.</p>
<p>En nuestro caso, ocurre cuando un paciente tiene 0 años. Podemos necesitar o no interpretar los resultados en tal situación, y en muchas situaciones la interpretación no tiene sentido, por lo que es más una interpretación hipotética. Sin embargo, de nuevo para ser exhaustivos, mostramos cómo interpretar el intercepto. Ten en cuenta que también es posible centrar la variable numérica para que el intercepto tenga una interpretación más significativa. Para un paciente de 0 años, los odds de desarrollar una enfermedad cardíaca son <span class="math inline">\(\exp(\hat{\beta}_0) =\)</span> exp(-3.051) = 0.047. Al interpretar un intercepto, a menudo tiene más sentido interpretarlo como la probabilidad de que <span class="math inline">\(Y = 1\)</span>, que se puede calcular de la siguiente manera:</p>
<p><span class="math display">\[\frac{\exp(\hat{\beta}_0)}{1 + \exp(\hat{\beta}_0)}.\]</span></p>
<p>En nuestro caso, corresponde a la probabilidad de que un paciente de 0 años desarrolle una enfermedad cardíaca, que es igual a:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prob(enfermedad cardíaca) para edad = 0</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(m1)[<span class="dv">1</span>]) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="fu">coef</span>(m1)[<span class="dv">1</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
 0.04516478 </code></pre>
</div>
</div>
<p>Esto significa que, si confiamos en nuestro modelo, se espera que un recién nacido desarrolle una enfermedad cardíaca con una probabilidad del 4.52%.</p>
<p>Se puede calcular un intervalo de confianza para cualquiera de los OR utilizando la función <code>confint()</code>. Por ejemplo, un intervalo de confianza del 95% para el OR para la edad:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># IC del 95% para el OR para la edad</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(m1,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parm =</span> <span class="st">"age"</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   2.5 %   97.5 % 
1.026699 1.083987 </code></pre>
</div>
</div>
<p>Recuerda que al evaluar un OR, el valor nulo es 1, no 0. Un OR de 1 en este estudio significaría que no hay asociación entre la edad y la presencia de enfermedad cardíaca. Si el intervalo de confianza del 95% del OR no incluye el 1, concluimos que existe una asociación significativa entre la edad y la presencia de enfermedad cardíaca. Por el contrario, si incluye el 1, no rechazamos la hipótesis de que no hay asociación entre la edad y la presencia de enfermedad cardíaca.</p>
<p>En nuestro caso, el IC del 95% no incluye el 1, por lo que concluimos, al nivel de significancia del 5%, que existe una asociación significativa entre la edad y la presencia de enfermedad cardíaca.</p>
<p>Notarás que es la misma conclusión que con el valor <span class="math inline">\(p\)</span>. Esto es normal, siempre será así:</p>
<ul>
<li>Si el valor <span class="math inline">\(p\)</span> &lt; 0.05, el 1 no estará incluido en el IC del 95%.</li>
<li>Si el valor <span class="math inline">\(p \ge\)</span> 0.05, el 1 estará incluido en el IC del 95%.</li>
</ul>
<p>Esto significa que puedes elegir si sacas tu conclusión sobre la asociación entre las dos variables basándote en el IC del 95% o en el valor <span class="math inline">\(p\)</span>.</p>
<p>Estimar la relación entre variables es la razón principal para construir modelos. Otro objetivo es predecir la variable dependiente basándose en valores recién observados de la(s) variable(s) independiente(s). Esto se puede hacer con la función <code>predict()</code>.</p>
<p>Supongamos que nos gustaría predecir la probabilidad de desarrollar una enfermedad cardíaca para un paciente de 30 años:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predecir la probabilidad de desarrollar una enfermedad cardíaca</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="fu">c</span>(<span class="dv">30</span>)),</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"response"</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimir la predicción</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>pred</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1 
0.1878525 </code></pre>
</div>
</div>
<p>Se predice que un paciente de 30 años tiene un 18.79% de probabilidad de desarrollar una enfermedad cardíaca.</p>
<p>Ten en cuenta que si deseas construir un intervalo de confianza para esta predicción, se puede hacer añadiendo el argumento <code>se = TRUE</code> en la función <code>predict()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predecir la probabilidad de desarrollar una enfermedad cardíaca</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="fu">c</span>(<span class="dv">30</span>)),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">TRUE</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimir la predicción</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>pred<span class="sc">$</span>fit</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1 
0.1878525 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># intervalo de confianza del 95% para la predicción</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> pred<span class="sc">$</span>fit <span class="sc">-</span> (<span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> pred<span class="sc">$</span>se.fit)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> pred<span class="sc">$</span>fit <span class="sc">+</span> (<span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> pred<span class="sc">$</span>se.fit)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(lower, upper)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1          1 
0.07873357 0.29697138 </code></pre>
</div>
</div>
<p>La función <code>plot_model()</code> disponible en el paquete de R <code>{sjPlot}</code> hace un buen trabajo al visualizar los resultados del modelo:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cargar paquete</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># gráfico</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m1,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"pred"</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">terms =</span> <span class="st">"age"</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Prob(enfermedad cardíaca)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TEMA-4_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>El gráfico muestra la probabilidad de desarrollar una enfermedad cardíaca en función de la edad y confirma los resultados encontrados anteriormente:<br>
- Vemos que la probabilidad de desarrollar una enfermedad cardíaca aumenta con la edad (lo cual era de esperar dado que el OR para el coeficiente de la edad es &gt; 1).<br>
- También vemos que la probabilidad de desarrollar una enfermedad cardíaca para un paciente de 30 años es ligeramente inferior al 20%.</p>
</section>
<section id="variable-independiente-cualitativa" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="variable-independiente-cualitativa"><span class="header-section-number">4.5.2</span> Variable independiente cualitativa</h3>
<p>Supongamos ahora que estamos interesados en estimar la relación entre la probabilidad de desarrollar una enfermedad cardíaca y el sexo (que es una variable cualitativa). Recuerda que cuando la variable independiente era cuantitativa, <span class="math inline">\(\exp(\hat{\beta}_1)\)</span> era el cambio multiplicativo en los odds a favor de <span class="math inline">\(Y = 1\)</span> cuando <span class="math inline">\(X\)</span> aumenta en 1 unidad. Siendo <span class="math inline">\(X\)</span> el sexo, el único aumento de unidad posible es de 0 a 1 (o de 1 a 2 si el sexo se codifica como un factor), por lo que podemos escribir una interpretación en términos de mujer/hombre. De nuevo, ten en cuenta cuál es el orden de los niveles para la variable sexo. En nuestro caso, el nivel mujer viene antes que el nivel hombre:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># niveles para sexo</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(dat<span class="sc">$</span>sex)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "mujer"  "hombre"</code></pre>
</div>
</div>
<p>Así que es, en efecto, el cambio multiplicativo de los odds tomando como referencia de <span class="math inline">\(Y = 1\)</span> ** mujer<strong>. Si el nivel hombre viniera antes que el nivel mujer en nuestro conjunto por lo tanto <span class="math inline">\(\exp(\hat{\beta}_1)\)</span> es el cambio multiplicativo de los odds a favor de <span class="math inline">\(Y = 1\)</span> para </strong>hombres versus mujeres**.</p>
<p>En nuestro caso, obtenemos los siguientes resultados:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar modelo</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(heart_disease <span class="sc">~</span> sex,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimir resultados</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = heart_disease ~ sex, family = "binomial", data = dat)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -1.0438     0.2326  -4.488 7.18e-06 ***
sexhombre     1.2737     0.2725   4.674 2.95e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 409.95  on 296  degrees of freedom
Residual deviance: 386.12  on 295  degrees of freedom
AIC: 390.12

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OR para sexo</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(m2)[<span class="st">"sexhombre"</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>sexhombre 
 3.573933 </code></pre>
</div>
</div>
<p>que se pueden interpretar de la siguiente manera:</p>
<ul>
<li>El valor <span class="math inline">\(p\)</span> de la prueba sobre el coeficiente para el sexo es &lt; 0.05, por lo que concluimos que el sexo está significativamente asociado con la presencia de enfermedad cardíaca (al nivel de significancia del 5%).</li>
<li>Además, al observar el coeficiente para el sexo, <span class="math inline">\(\hat{\beta}_1 =\)</span> 1.274, podemos decir que:
<ul>
<li>Para los hombres, los odds de desarrollar una enfermedad cardíaca se multiplican por un factor de exp(1.274) = 3.574 en comparación con las mujeres.</li>
<li>En otras palabras, los odds de desarrollar una enfermedad cardíaca para los hombres son 3.574 veces los odds para las mujeres.</li>
<li>Esto significa que los odds de desarrollar una enfermedad cardíaca son (3.574 - 1) <span class="math inline">\(\times\)</span> 100 = 257.4% más altos para los hombres que para las mujeres.</li>
</ul></li>
<li>Finalmente, el OR para el sexo es 3.574, y su IC del 95% es:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># IC del 95% para el OR para el sexo</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(m2,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parm =</span> <span class="st">"sexhombre"</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   2.5 %   97.5 % 
2.118346 6.183549 </code></pre>
</div>
</div>
<pre><code>  - Dado que el IC del 95% no incluye el 1, concluimos, al nivel de significancia del 5%, que existe una asociación significativa entre el sexo y la presencia de enfermedad cardíaca. Esta es la misma conclusión que con el valor $p$.
  - Esto significa que los hombres tienen significativamente más probabilidades de desarrollar una enfermedad cardíaca que las mujeres.
  - Si el IC del 95% hubiera incluido el 1, no habríamos rechazado la hipótesis de que no hay asociación entre el sexo y la presencia de enfermedad cardíaca.</code></pre>
</section>
</section>
<section id="regresión-logística-binaria-multivariable" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="regresión-logística-binaria-multivariable"><span class="header-section-number">4.6</span> Regresión logística binaria multivariable</h2>
<p>La interpretación de los coeficientes en la regresión logística multivariable es similar a la interpretación en la regresión univariable, excepto que esta vez estima el cambio multiplicativo en los odds a favor de <span class="math inline">\(Y = 1\)</span> cuando <span class="math inline">\(X\)</span> aumenta en 1 unidad, <strong>mientras que las otras variables independientes permanecen sin cambios</strong>. Esto es similar a la regresión lineal múltiple, donde un coeficiente da el cambio esperado de <span class="math inline">\(Y\)</span> por un aumento de 1 unidad de <span class="math inline">\(X\)</span>, manteniendo constantes todas las demás variables <span class="citation" data-cites="Menard02">[<a href="#ref-Menard02" role="doc-biblioref">3</a>]</span>.</p>
<p>Las principales ventajas de utilizar una regresión logística multivariable en comparación con una regresión logística univariable son:</p>
<ul>
<li>Considerar el efecto simultáneo (en lugar de aislado) de las variables independientes.</li>
<li>Tener en cuenta posibles efectos de confusión y/o interacción.</li>
<li>Mejorar las predicciones.</li>
</ul>
<p>Para esta ilustración, supongamos que nos gustaría estimar la relación entre la enfermedad cardíaca y todas las variables presentes en el data frame, es decir, edad, sexo, tipo de dolor torácico y frecuencia cardíaca máxima alcanzada:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar modelo</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(heart_disease <span class="sc">~</span> .,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimir resultados</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = heart_disease ~ ., family = "binomial", data = dat)

Coefficients:
                             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                 -0.060150   1.962091  -0.031 0.975544    
age                          0.042814   0.019009   2.252 0.024302 *  
sexhombre                    1.686330   0.349352   4.827 1.39e-06 ***
chest_painangina atípica    -0.120481   0.641396  -0.188 0.851000    
chest_paindolor no anginoso -0.124331   0.571093  -0.218 0.827658    
chest_painasintomático       1.963723   0.548877   3.578 0.000347 ***
max_heartrate               -0.030326   0.007975  -3.802 0.000143 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 409.95  on 296  degrees of freedom
Residual deviance: 275.26  on 290  degrees of freedom
AIC: 289.26

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p>Ten en cuenta que la fórmula <code>heart_disease ~ .</code> es un atajo para incluir en el modelo todas las variables presentes en el data frame como variables independientes, excepto <code>heart_disease</code>. Basándonos en los valores <span class="math inline">\(p\)</span> que se muestran en la última columna de la tabla de coeficientes, concluimos que, a un nivel de significancia del 5%, la edad, el sexo y la frecuencia cardíaca máxima alcanzada están significativamente asociados con la enfermedad cardíaca (valores <span class="math inline">\(p\)</span> &lt; 0.05).</p>
<p>Para las variables <code>age</code>, <code>sex</code> y <code>max_heartrate</code>, solo hay un valor <span class="math inline">\(p\)</span>. Para la variable <code>chest_pain</code>, se muestran 3 valores <span class="math inline">\(p\)</span>. Esto es normal: al igual que en la regresión lineal cuando se incluye en el modelo una variable categórica con más de dos niveles, se realiza una prueba para cada comparación entre el nivel de referencia y los otros niveles. En nuestro caso, el nivel de referencia para la variable <code>chest_pain</code> es <code>typical angina</code> (angina típica), ya que aparece primero:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(dat<span class="sc">$</span>chest_pain)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "angina típica"     "angina atípica"    "dolor no anginoso"
[4] "asintomático"     </code></pre>
</div>
</div>
<p>Por lo tanto, se realiza una prueba para la comparación entre:</p>
<ol type="1">
<li><code>typical angina</code> y <code>atypical angina</code> (angina atípica),</li>
<li><code>typical angina</code> y <code>non-anginal pain</code> (dolor no anginoso), y</li>
<li><code>typical angina</code> y <code>asymptomatic</code> (asintomático).</li>
</ol>
<p>Pero aquí no nos interesa comparar los niveles de la variable de dolor torácico, nos gustaría probar el efecto general del dolor torácico en la enfermedad cardíaca. Para ello, vamos a comparar dos modelos mediante una prueba de razón de verosimilitud (LRT):</p>
<ol type="1">
<li>Un modelo que incluye todas las variables de interés <strong>y</strong> la variable <code>chest_pain</code>.</li>
<li>El mismo modelo exacto pero que <strong>excluye</strong> la variable <code>chest_pain</code>.</li>
</ol>
<p>El primero se conoce como modelo completo, mientras que el segundo se conoce como modelo reducido.</p>
<p>Comparamos estos dos modelos con la función <code>anova()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar modelo reducido</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>mod_reduced <span class="ot">&lt;-</span> <span class="fu">glm</span>(heart_disease <span class="sc">~</span> age <span class="sc">+</span> sex <span class="sc">+</span> max_heartrate,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># comparar modelo reducido con modelo completo</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_reduced, m2,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">test =</span> <span class="st">"LRT"</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: heart_disease ~ age + sex + max_heartrate
Model 2: heart_disease ~ age + sex + chest_pain + max_heartrate
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1       293     325.12                          
2       290     275.26  3    49.86 8.558e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Observa que el modelo reducido debe ir antes que el modelo completo en la función <code>anova()</code>. La hipótesis nula de esta prueba es que los dos modelos son equivalentes.</p>
<p>A un nivel de significancia del 5% (ver el valor <span class="math inline">\(p\)</span> a la derecha de la salida de R), rechazamos la hipótesis nula y concluimos que el modelo completo es significativamente mejor que el modelo reducido para explicar la presencia de enfermedad cardíaca. Esto significa que el dolor torácico está significativamente asociado con la enfermedad cardíaca (lo cual era de esperar, ya que la comparación entre <code>typical angina</code> y <code>asymptomatic</code> resultó ser significativa). Hemos identificado que las cuatro variables independientes estaban significativamente asociadas con la presencia de enfermedad cardíaca, podemos interpretar los coeficientes para conocer la dirección de las relaciones y, lo más importante, cuantificar la fuerza de estas relaciones.</p>
<p>Al igual que en la regresión logística binaria univariable, es más fácil interpretar estas relaciones a través de los OR. Pero esta vez, también imprimimos el IC del 95% del OR además del OR (redondeado a 3 decimales) para que podamos ver fácilmente cuáles son significativamente diferentes de 1:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OR y IC del 95%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="at">OR =</span> <span class="fu">coef</span>(m2), <span class="fu">confint</span>(m2))), <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                               OR 2.5 % 97.5 %
(Intercept)                 0.942 0.020 44.353
age                         1.044 1.006  1.084
sexhombre                   5.400 2.776 10.971
chest_painangina atípica    0.886 0.252  3.191
chest_paindolor no anginoso 0.883 0.293  2.814
chest_painasintomático      7.126 2.509 22.030
max_heartrate               0.970 0.955  0.985</code></pre>
</div>
</div>
<p>A partir de los OR y sus IC del 95% calculados anteriormente, concluimos que:</p>
<ul>
<li><strong>Edad</strong>: los odds de tener una enfermedad cardíaca se multiplican por un factor de 1.04 por cada aumento de una unidad en la edad, manteniendo todo lo demás constante.</li>
<li><strong>Sexo</strong>: los odds de desarrollar una enfermedad cardíaca para los hombres son 5.4 veces los odds para las mujeres, manteniendo todo lo demás constante.</li>
<li><strong>Dolor torácico</strong>: los odds de desarrollar una enfermedad cardíaca para las personas que sufren de dolor torácico del tipo “asintomático” son 7.13 veces los odds para las personas que sufren de dolor torácico del tipo “angina típica”, manteniendo todo lo demás constante. Nos abstenemos de interpretar las otras comparaciones ya que no son significativas al nivel de significancia del 5% (el 1 está incluido en su IC del 95%).</li>
<li><strong>Frecuencia cardíaca máxima alcanzada</strong>: los odds de tener una enfermedad cardíaca se multiplican por un factor de 0.97 por cada aumento de una unidad en la frecuencia cardíaca máxima alcanzada, manteniendo todo lo demás constante.</li>
<li><strong>Intercepto</strong>: también nos abstenemos de interpretar el intercepto ya que no es significativamente diferente de 0 al nivel de significancia del 5% (el 1 está incluido en el IC del 95%). Recuerda que siempre podemos escribir las interpretaciones en términos del porcentaje de aumento/disminución de los odds con la fórmula <span class="math inline">\((OR - 1) \times 100\)</span>, donde OR corresponde al odds ratio.</li>
</ul>
<p>Por ejemplo, para la frecuencia cardíaca máxima alcanzada, el OR = 0.97, por lo que la interpretación se convierte en: los odds de desarrollar una enfermedad cardíaca aumentan en (0.97 <span class="math inline">\(- 1) \times 100 =\)</span> -3% por cada aumento de una unidad en la frecuencia cardíaca máxima alcanzada, lo que equivale a decir que los odds de desarrollar una enfermedad cardíaca <em>disminuyen</em> en 3% por cada aumento de una unidad en la frecuencia cardíaca máxima alcanzada.</p>
<p>Con fines ilustrativos, supongamos ahora que nos gustaría predecir la probabilidad de que un nuevo paciente desarrolle una enfermedad cardíaca. Supongamos que esta paciente es una mujer de 32 años, que sufre de dolor torácico del tipo no anginoso y alcanzó una frecuencia cardíaca máxima de 150. La probabilidad de que desarrolle una enfermedad cardíaca es:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># crear data frame del nuevo paciente</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>new_patient <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="dv">32</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex =</span> <span class="st">"mujer"</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">chest_pain =</span> <span class="st">"dolor no anginoso"</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_heartrate =</span> <span class="dv">150</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co"># predecir la probabilidad de desarrollar una enfermedad cardíaca e Intervalo de confianza del 95%</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(m2,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> new_patient,</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">se.fit =</span> <span class="cn">TRUE</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Imprimir la predicción e intervalo</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> pred<span class="sc">$</span>fit <span class="sc">-</span> (<span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> pred<span class="sc">$</span>se.fit)</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> pred<span class="sc">$</span>fit <span class="sc">+</span> (<span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> pred<span class="sc">$</span>se.fit)</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(pred<span class="sc">$</span>fit, lower, upper)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>           1            1            1 
 0.033459485 -0.007961903  0.074880872 </code></pre>
</div>
</div>
<p>Si confiamos en nuestro modelo, se predice que la probabilidad de que esta nueva paciente desarrolle una enfermedad cardíaca es del 3.35%. También podemos visualizar los resultados gracias a la función <code>plot_model()</code>, tres efectos al mismo tiempo:</p>
<ol type="1">
<li>Efecto de la edad, el sexo y el tipo de dolor torácico en la probabilidad predicha de desarrollar una enfermedad cardíaca.</li>
<li>Efecto de la frecuencia cardíaca máxima alcanzada, el sexo y el tipo de dolor torácico en la probabilidad predicha de desarrollar una enfermedad cardíaca.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. edad, sexo y dolor torácico sobre la prob. de enfermedad</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m2,</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"pred"</span>,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"chest_pain"</span>, <span class="st">"sex"</span>),</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci.lvl =</span> <span class="cn">NA</span> <span class="co"># eliminar bandas de confianza</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Prob(enfermedad cardíaca)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TEMA-4_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. frec. cardíaca máx., dolor torácico y sexo sobre la prob. de enfermedad</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m2,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"pred"</span>,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"max_heartrate"</span>, <span class="st">"chest_pain"</span>, <span class="st">"sex"</span>),</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci.lvl =</span> <span class="cn">NA</span> <span class="co"># eliminar bandas de confianza</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Prob(enfermedad cardíaca)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TEMA-4_files/figure-html/unnamed-chunk-30-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Para mayor claridad en los gráficos, las bandas de confianza se eliminan gracias a <code>ci.lvl = NA</code>.</p>
<p>Estos gráficos confirman los resultados obtenidos anteriormente, es decir:</p>
<ul>
<li>Hay una relación <em>positiva</em> entre la edad y la presencia de enfermedad cardíaca.</li>
<li>Hay una relación <em>negativa</em> entre la frecuencia cardíaca máxima alcanzada y la presencia de enfermedad cardíaca.</li>
<li>Los odds de desarrollar una enfermedad cardíaca son mayores para los pacientes que sufren de dolor torácico de tipo asintomático y similares para los otros 3 tipos de dolor torácico.</li>
<li>Los odds de desarrollar una enfermedad cardíaca son mayores para los hombres que para las mujeres.</li>
</ul>
<section id="interacción" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="interacción"><span class="header-section-number">4.6.1</span> Interacción</h3>
<p>En las secciones anteriores, se omitieron los posibles efectos de interacción. Una interacción ocurre cuando la relación entre una variable independiente y la variable de resultado depende del valor o nivel que toma otra variable independiente. Por el contrario, si la relación entre una variable independiente y la variable dependiente permanece sin cambios sin importar el valor que tome otra variable independiente, no podemos concluir que haya un efecto de interacción. En nuestro caso, habría una interacción si, por ejemplo, la relación entre la edad y la enfermedad cardíaca dependiera del sexo. Habría una interacción, por ejemplo, si la relación entre la edad y la enfermedad cardíaca fuera positiva para las mujeres y negativa para los hombres, o viceversa. O si la relación entre la edad y la enfermedad cardíaca fuera mucho más fuerte o mucho más débil para las mujeres que para los hombres.</p>
<p>Veamos si hay una interacción entre la edad y el sexo y, lo que es más importante, si esta interacción es significativa o no. Para ello, necesitamos construir dos modelos:</p>
<ol type="1">
<li>Un modelo que contenga solo los efectos principales, es decir, sin la interacción.</li>
<li>Un modelo que contenga los efectos principales <strong>y</strong> la interacción.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar modelo sin interacción</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(heart_disease <span class="sc">~</span> age <span class="sc">+</span> sex,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar modelo con interacción</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>m3_inter <span class="ot">&lt;-</span> <span class="fu">glm</span>(heart_disease <span class="sc">~</span> age <span class="sc">*</span> sex,</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat,</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3_inter)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = heart_disease ~ age * sex, family = "binomial", 
    data = dat)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)   -4.21323    1.61745  -2.605  0.00919 **
age            0.05570    0.02758   2.019  0.04346 * 
sexhombre      0.64180    1.88470   0.341  0.73346   
age:sexhombre  0.01506    0.03286   0.458  0.64666   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 409.95  on 296  degrees of freedom
Residual deviance: 364.23  on 293  degrees of freedom
AIC: 372.23

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>Primero evaluamos la interacción visualmente a través de la función <code>plot_model()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gráfico</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m3_inter,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"pred"</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"sex"</span>),</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci.lvl =</span> <span class="cn">NA</span> <span class="co"># eliminar bandas de confianza</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Prob(enfermedad cardíaca)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TEMA-4_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Dado que las dos curvas de las probabilidades predichas son relativamente similares y siguen el mismo patrón, la relación entre la edad y la presencia de enfermedad cardíaca no parece depender del sexo, lo que indica que, de hecho, puede que no haya interacción. Sin embargo, nos gustaría probarlo de manera más formal a través de una prueba estadística.</p>
<p>Para ello, podemos comparar los dos modelos (el que no tiene interacción frente al que sí la tiene) con una prueba de razón de verosimilitud (LRT), utilizando la función <code>anova()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m3, m3_inter,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">test =</span> <span class="st">"LRT"</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: heart_disease ~ age + sex
Model 2: heart_disease ~ age * sex
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
1       294     364.43                     
2       293     364.23  1  0.20741   0.6488</code></pre>
</div>
</div>
<p>Recuerda que siempre es el modelo reducido como primer argumento en la función <code>anova()</code>, y luego el modelo más complejo como segundo argumento.</p>
<p>La prueba confirma lo que supusimos basándonos en el gráfico: a un nivel de significancia del 5%, no rechazamos la hipótesis nula de que los dos modelos son equivalentes. Dado que la única diferencia entre los dos modelos es que se añade un término de interacción en el modelo completo, no rechazamos la hipótesis de que no hay interacción entre la edad y el sexo (valor <span class="math inline">\(p\)</span> = 0.649).</p>
<p>Esta conclusión también podría haberse obtenido de manera más simple con la función <code>drop1()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(m3_inter,</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">test =</span> <span class="st">"LRT"</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
heart_disease ~ age * sex
        Df Deviance    AIC     LRT Pr(&gt;Chi)
&lt;none&gt;       364.23 372.23                 
age:sex  1   364.43 370.43 0.20741   0.6488</code></pre>
</div>
</div>
<p>Como puedes ver, esto da el mismo valor <span class="math inline">\(p\)</span> de 0.649.</p>
<p>En la práctica, una interacción no significativa se elimina del modelo antes de interpretar sus resultados. En nuestro caso, solo permanecerían en el modelo los efectos principales de la edad y el sexo. Esto nos lleva a la selección de modelos, o qué variables deben incluirse en nuestro modelo final. Esto se discute en la siguiente sección.</p>
</section>
<section id="selección-de-modelos" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="selección-de-modelos"><span class="header-section-number">4.6.2</span> Selección de modelos</h3>
<p>En la práctica, a menudo tenemos varios modelos, que corresponden a las diferentes combinaciones de variables independientes y sus interacciones. Encontrar el mejor modelo no es fácil. En general, la mejor práctica es obtener un modelo final que sea lo más <strong>parsimonioso</strong> posible, es decir, con la menor cantidad de parámetros posible. Un modelo parsimonioso es más fácil de interpretar y generalizar, y también más potente desde un punto de vista estadístico. Por otro lado, no debe ser demasiado simple para que siga capturando las variaciones o patrones en los datos. En general, aunque más variables suelen ser mejores que una, demasiadas suelen ser peor que unas pocas.</p>
<p>Los dos enfoques más comunes para obtener un modelo final son los siguientes:</p>
<ol type="1">
<li>Ajustar el modelo eliminando los efectos principales y sus interacciones que no son significativos con respecto a sus valores <span class="math inline">\(p\)</span>, obtenidos al probar la nulidad de los coeficientes correspondientes mediante una prueba estadística como la prueba de razón de verosimilitud o la prueba de Wald. Si hay varios efectos principales o interacciones que no son significativos, las interacciones deben eliminarse antes de eliminar cualquier efecto principal. Además, se recomienda eliminar las interacciones y las variables independientes una por una (comenzando por la que tiene el valor <span class="math inline">\(p\)</span> más alto), ya que eliminar una variable o una interacción puede hacer que otra variable o interacción que inicialmente no era significativa se vuelva significativa.</li>
<li>Ajustar el modelo utilizando el <strong>AIC</strong> (Criterio de Información de Akaike) o el <strong>BIC</strong> (Criterio de Información Bayesiano). Estos procedimientos permiten seleccionar el mejor modelo (según el AIC o el BIC) encontrando un equilibrio entre simplicidad y complejidad. Estos procesos de selección suelen conducir a un modelo final con la menor cantidad de parámetros posible, pero que captura la mayor cantidad de información posible de los datos. Ten en cuenta que solo se pueden comparar modelos con la misma variable dependiente utilizando AIC o BIC. Los modelos con diferentes variables dependientes no se pueden comparar utilizando estos criterios.</li>
</ol>
<p>El primer método requiere que:</p>
<ul>
<li>Los supuestos subyacentes sean válidos.</li>
<li>El tamaño de la muestra sea suficientemente grande.</li>
<li>Los modelos estén anidados (es decir, el modelo completo incluye al menos todas las variables incluidas en el modelo reducido).</li>
</ul>
<p>Además, el segundo método se puede utilizar con criterios ampliamente aceptados al seleccionar variables y, lo que es más importante, de una manera completamente autónoma en R.</p>
<p>Por esta razón, el segundo método es recomendado y más utilizado en la práctica.</p>
<p>Este segundo método, conocido como <strong>selección por pasos (stepwise)</strong>, se divide en 3 tipos:</p>
<ol type="1">
<li><strong>Selección hacia atrás (backward selection)</strong>: partimos del modelo más completo (que contiene todas las variables independientes y, por lo general, también sus interacciones), y las interacciones/efectos principales se eliminan en cada paso hasta que el modelo no se puede mejorar.</li>
<li><strong>Selección hacia adelante (forward selection)</strong>: partimos del modelo más básico que contiene solo el intercepto, y las variables independientes/interacciones se agregan en cada paso hasta que el modelo no se puede mejorar.</li>
<li><strong>Selección mixta (mixed selection)</strong>: aplicamos tanto la selección hacia atrás <strong>como</strong> la selección hacia adelante para determinar el mejor modelo según el criterio deseado.</li>
</ol>
<p>Mostramos cómo seleccionar el mejor modelo según el AIC utilizando la selección mixta por pasos, ilustrada con todas las variables presentes en el data frame como variables independientes y todas las posibles interacciones de segundo orden:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar modelo inicial</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(heart_disease <span class="sc">~</span> (age <span class="sc">+</span> sex <span class="sc">+</span> chest_pain <span class="sc">+</span> max_heartrate)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># seleccionar el mejor modelo según AIC usando selección mixta</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>m4_final <span class="ot">&lt;-</span> <span class="fu">step</span>(m4,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">direction =</span> <span class="st">"both"</span>, <span class="co"># both = selección mixta</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">trace =</span> <span class="cn">FALSE</span> <span class="co"># no mostrar los pasos intermedios</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co"># mostrar resultados del modelo final</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m4_final)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = heart_disease ~ age + sex + chest_pain + max_heartrate + 
    age:max_heartrate, family = "binomial", data = dat)

Coefficients:
                              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                 19.4386591  8.1904201   2.373 0.017628 *  
age                         -0.3050017  0.1414986  -2.156 0.031122 *  
sexhombre                    1.7055353  0.3507149   4.863 1.16e-06 ***
chest_painangina atípica    -0.0086463  0.6547573  -0.013 0.989464    
chest_paindolor no anginoso -0.0590333  0.5844000  -0.101 0.919538    
chest_painasintomático       1.9724490  0.5649516   3.491 0.000481 ***
max_heartrate               -0.1605658  0.0540933  -2.968 0.002994 ** 
age:max_heartrate            0.0023314  0.0009433   2.471 0.013457 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 409.95  on 296  degrees of freedom
Residual deviance: 268.60  on 289  degrees of freedom
AIC: 284.6

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p>Según el AIC (que es el criterio predeterminado al usar la función <code>step()</code>), el mejor modelo es el que incluye:</p>
<ul>
<li><code>age</code> (edad),</li>
<li><code>sex</code> (sexo),</li>
<li><code>chest_pain</code> (dolor torácico),</li>
<li><code>max_heartrate</code> (frecuencia cardíaca máxima), y</li>
<li>la interacción entre <code>age</code> y <code>max_heartrate</code>.</li>
</ul>
<p>Para tu información, también puedes comparar modelos manualmente de forma sencilla utilizando el AIC o el pseudo-<span class="math inline">\(R^2\)</span> con la función <code>tab_model()</code>, también disponible en el paquete de R <code>{sjPlot}</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m2, m3_inter, m4_final,</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.ci =</span> <span class="cn">FALSE</span>, <span class="co"># eliminar IC</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.aic =</span> <span class="cn">TRUE</span>, <span class="co"># mostrar AIC</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.style =</span> <span class="st">"numeric_stars"</span> <span class="co"># mostrar valores p y estrellas</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">heart disease</th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">heart disease</th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">heart disease</th>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Odds Ratios</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Odds Ratios</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Odds Ratios</td>
<td style="text-align: center;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.94 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.976</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.01 <sup>**</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.009</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">276759408.51 <sup>*</sup></td>
<td style="text-align: center;"><strong>0.018</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">age</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.04 <sup>*</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.024</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.06 <sup>*</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.043</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.74 <sup>*</sup></td>
<td style="text-align: center;"><strong>0.031</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">sex [hombre]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">5.40 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.90 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.733</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">5.50 <sup>***</sup></td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">chest pain [angina<br>
atípica]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.89 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.851</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.99 <sup></sup></td>
<td style="text-align: center;">0.989</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">chest pain [dolor no<br>
anginoso]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.88 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.828</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.94 <sup></sup></td>
<td style="text-align: center;">0.920</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">chest pain [asintomático]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">7.13 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">7.19 <sup>***</sup></td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">max heartrate</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.97 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.85 <sup>**</sup></td>
<td style="text-align: center;"><strong>0.003</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">age × sex [hombre]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.02 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.647</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">age × max heartrate</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.00 <sup>*</sup></td>
<td style="text-align: center;"><strong>0.013</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="2" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">297</td>
<td colspan="2" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">297</td>
<td colspan="2" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">297</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> Tjur</td>
<td colspan="2" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.393</td>
<td colspan="2" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.144</td>
<td colspan="2" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.409</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">AIC</td>
<td colspan="2" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">289.263</td>
<td colspan="2" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">372.227</td>
<td colspan="2" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">284.599</td>
</tr>
<tr class="odd">
<td colspan="7" style="text-align: right; font-style: italic; border-top: double black;">* p&lt;0.05&nbsp;&nbsp;&nbsp;** p&lt;0.01&nbsp;&nbsp;&nbsp;*** p&lt;0.001</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>El <strong>pseudo-<span class="math inline">\(R^2\)</span></strong> es una generalización del coeficiente de determinación <span class="math inline">\(R^2\)</span> que se usa a menudo en la regresión lineal para juzgar la calidad de un modelo. Al igual que el <span class="math inline">\(R^2\)</span> en la regresión lineal, el pseudo-<span class="math inline">\(R^2\)</span> varía de 0 a 1 y puede interpretarse como el porcentaje de la devianza nula explicado por la(s) variable(s) independiente(s). Cuanto mayor sea el pseudo-<span class="math inline">\(R^2\)</span> y menor el AIC, mejor será el modelo.</p>
<p>Ten en cuenta que existen varios pseudo-<span class="math inline">\(R^2\)</span>, como:</p>
<ul>
<li>Razón de verosimilitud <span class="math inline">\(R^2\_{L}\)</span>,</li>
<li>Cox y Snell <span class="math inline">\(R^2\_{CS}\)</span>,</li>
<li>Nagelkerke <span class="math inline">\(R^2\_{N}\)</span>,</li>
<li>McFadden <span class="math inline">\(R^2\_{McF}\)</span>, y</li>
<li>Tjur <span class="math inline">\(R^2\_{T}\)</span>.</li>
</ul>
<p>La función <code>tab_model()</code> proporciona el Tjur <span class="math inline">\(R^2\_{T}\)</span> por defecto.</p>
<p>Basándonos en el AIC y el Tjur <span class="math inline">\(R^2\_{T}\)</span>, el último modelo se considera el mejor entre los 3 considerados.</p>
<p>Ten en cuenta que, aunque un modelo se considere el mejor entre los que has considerado (basado en uno o varios criterios), no significa necesariamente que se ajuste bien a los datos. Existen varios métodos para verificar la calidad de un modelo y comprobar si es apropiado para los datos disponibles. Este es el tema de la siguiente sección.</p>
</section>
<section id="calidad-de-un-modelo" class="level3" data-number="4.6.3">
<h3 data-number="4.6.3" class="anchored" data-anchor-id="calidad-de-un-modelo"><span class="header-section-number">4.6.3</span> Calidad de un modelo</h3>
<p>Por lo general, el objetivo de construir un modelo es poder predecir, con la mayor precisión posible, la variable de respuesta para nuevos datos. En las siguientes secciones, presentamos algunas medidas para juzgar la calidad de un modelo, comenzando por la más fácil e intuitiva, seguida de dos ampliamente utilizadas en el ámbito médico, y finalmente otras dos métricas comunes en el campo del aprendizaje automático.</p>
<section id="precisión-accuracy" class="level4" data-number="4.6.3.1">
<h4 data-number="4.6.3.1" class="anchored" data-anchor-id="precisión-accuracy"><span class="header-section-number">4.6.3.1</span> Precisión (Accuracy)</h4>
<p>Una buena forma de juzgar la precisión de un modelo es monitorear su rendimiento con nuevos datos y contar con qué frecuencia predice el resultado correcto. Desafortunadamente, cuando tenemos acceso a nuevos datos, a menudo no conocemos el resultado real y, por lo tanto, no podemos verificar si el modelo hace un buen trabajo al predecir el resultado. El truco es:</p>
<ol type="1">
<li><strong>Entrenar</strong> el modelo con el data frame inicial.</li>
<li><strong>Probar</strong> el modelo con los mismos datos exactos (como si fuera un data frame completamente diferente para el cual no conocemos el resultado).</li>
<li><strong>Comparar</strong> las predicciones hechas por el modelo con los resultados reales.</li>
</ol>
<p>Para ilustrar este proceso, tomamos el modelo construido en la sección anterior y lo probamos en el data frame inicial. Además, supongamos que si la probabilidad de que el paciente desarrolle una enfermedad cardíaca es inferior al 50%, consideramos que el resultado predicho es la ausencia de la enfermedad; de lo contrario, el resultado predicho es la presencia de la enfermedad.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># crear un vector de probabilidades predichas</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(m4_final,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">select</span>(dat, <span class="sc">-</span>heart_disease), <span class="co"># eliminar resultados reales</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"response"</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># si la probabilidad &lt; umbral, se considera que el paciente no tiene la enfermedad</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>preds_outcome <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(preds <span class="sc">&lt;</span> <span class="fl">0.5</span>,</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>,</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="co"># transformar predicciones en factor y establecer etiquetas</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>preds_outcome <span class="ot">&lt;-</span> <span class="fu">factor</span>(preds_outcome,</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sin enfermedad"</span>, <span class="st">"enfermedad"</span>)</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="co"># comparar resultado observado vs. predicho</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(dat<span class="sc">$</span>heart_disease, preds_outcome,</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"observado"</span>, <span class="st">"predicho"</span>)</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimir resultados</span></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>tab</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                predicho
observado        sin enfermedad enfermedad
  sin enfermedad            132         28
  enfermedad                 33        104</code></pre>
</div>
</div>
<p>De la tabla de contingencia de los resultados predichos y observados, vemos que el modelo:</p>
<ul>
<li>Predijo correctamente la ausencia de la enfermedad para 132 pacientes.</li>
<li>Predijo incorrectamente la presencia de la enfermedad para 28 pacientes.</li>
<li>Predijo incorrectamente la ausencia de la enfermedad para 33 pacientes.</li>
<li>Predijo correctamente la presencia de la enfermedad para 104 pacientes.</li>
</ul>
<p>El porcentaje de predicciones correctas, conocido como <strong>precisión (accuracy)</strong>, es la suma de las predicciones correctas dividida por el número total de predicciones:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(tab)) <span class="sc">/</span> <span class="fu">sum</span>(tab)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>accuracy</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7946128</code></pre>
</div>
</div>
<p>Este modelo tiene una precisión del 79.5%.</p>
<p>Aunque la precisión es la forma más intuitiva y fácil de medir el rendimiento predictivo de un modelo, tiene algunas desventajas, especialmente porque tenemos que elegir un umbral <em>arbitrario</em> más allá del cual clasificamos una nueva observación como 1 o 0. Se puede encontrar una discusión más detallada sobre esto en el <a href="https://hbiostat.org/blog/post/classification/index.html" target="_blank">blog de Frank Harrell</a>.</p>
<p>En esta ilustración, elegimos el 50% como el umbral a partir del cual se consideraba que un paciente tenía la enfermedad. Sin embargo, ¡podríamos haber elegido otro umbral y los resultados habrían sido diferentes!</p>
</section>
<section id="sensibilidad-y-especificidad" class="level4" data-number="4.6.3.2">
<h4 data-number="4.6.3.2" class="anchored" data-anchor-id="sensibilidad-y-especificidad"><span class="header-section-number">4.6.3.2</span> Sensibilidad y especificidad</h4>
<p>Si trabajas en el campo de la medicina, o si tu investigación está relacionada con las ciencias médicas, probablemente ya hayas oído hablar de <strong>sensibilidad</strong> y <strong>especificidad</strong>.</p>
<p>La <strong>sensibilidad</strong> de un clasificador, también conocida como <em>recall</em>, mide la capacidad de un clasificador para detectar la condición cuando la condición está presente. En nuestro caso, es el porcentaje de personas enfermas que son correctamente identificadas como tales. Formalmente, tenemos:</p>
<p><span class="math display">\[ \text{Sensibilidad} = \frac{\text{Verdaderos positivos}}{\text{Verdaderos positivos} + \text{Falsos negativos}},\]</span></p>
<p>donde los verdaderos positivos son personas correctamente diagnosticadas como enfermas y los falsos negativos son personas incorrectamente diagnosticadas como sanas.</p>
<p>La <strong>especificidad</strong> de un clasificador mide la capacidad de un clasificador para excluir correctamente la condición cuando la condición está ausente. En nuestro caso, es el porcentaje de personas sanas que son correctamente identificadas como no enfermas. Formalmente, tenemos:</p>
<p><span class="math display">\[\text{Especificidad} = \frac{\text{Verdaderos negativos}}{\text{Verdaderos negativos} + \text{Falsos positivos}},\]</span></p>
<p>donde los verdaderos negativos son personas correctamente diagnosticadas como sanas y los falsos positivos son personas incorrectamente diagnosticadas como enfermas.</p>
<p>En R, la sensibilidad y la especificidad se pueden calcular de la siguiente manera:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sensibilidad</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>sensitivity <span class="ot">&lt;-</span> tab[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">/</span> (tab[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">+</span> tab[<span class="dv">2</span>, <span class="dv">1</span>])</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>sensitivity</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7591241</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># especificidad</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>specificity <span class="ot">&lt;-</span> tab[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">/</span> (tab[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span> tab[<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>specificity</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.825</code></pre>
</div>
</div>
<p>Con nuestro modelo, obtenemos:</p>
<ul>
<li>Sensibilidad = 75.9%, y</li>
<li>Especificidad = 82.5%.</li>
</ul>
<p>Cuanto más cerca estén la sensibilidad y la especificidad del 100%, mejor será el modelo. El test de Hosmer y Lemeshow, es otra forma común de evaluar la calidad de un modelo. Este test se basa en la comparación entre los resultados observados y los resultados predichos por el modelo. La hipótesis nula de este test es que no hay diferencia entre los resultados observados y los predichos. A un nivel de significancia del 5%, si el valor <span class="math inline">\(p\)</span> es menor que 0.05, rechazamos la hipótesis nula y concluimos que el modelo no se ajusta bien a los datos <span class="citation" data-cites="Hosmer13">[<a href="#ref-Hosmer13" role="doc-biblioref">4</a>]</span>. Por otro lado, si el valor <span class="math inline">\(p\)</span> es mayor que 0.05, no rechazamos la hipótesis nula y concluimos que el modelo se ajusta bien a los datos. En R, este test se puede realizar fácilmente con la función <code>logitgof()</code> del paquete <code>{generalhoslem}</code>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cargar paquete</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("generalhoslem")</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(generalhoslem)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># realizar test de Hosmer y Lemeshow</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">logitgof</span>(dat<span class="sc">$</span>heart_disease, <span class="fu">fitted</span>(m4_final))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hosmer and Lemeshow test (binary model)

data:  dat$heart_disease, fitted(m4_final)
X-squared = 6.7718, df = 8, p-value = 0.5614</code></pre>
</div>
</div>
<p>El valor <span class="math inline">\(p\)</span> es 0.561. A un nivel de significancia del 5%, no rechazamos la hipótesis nula y concluimos que el modelo se ajusta bien a los datos.</p>
</section>
</section>
<section id="curva-roc-y-auc-después-de-un-modelo-de-regresión-logística" class="level3" data-number="4.6.4">
<h3 data-number="4.6.4" class="anchored" data-anchor-id="curva-roc-y-auc-después-de-un-modelo-de-regresión-logística"><span class="header-section-number">4.6.4</span> Curva ROC y AUC después de un modelo de regresión logística</h3>
<p>Ya hemos visto que cuanto mejor es la calidad del modelo, mejores son las predicciones.</p>
<p>Otra forma común y menos arbitraria de juzgar la calidad de un modelo es calculando el <strong>AUC (Área Bajo la Curva)</strong> y trazando la <strong>curva ROC (Receiver Operating Characteristic)</strong>.</p>
<p>Esto se puede lograr fácilmente gracias al paquete <code>{pROC}</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cargar paquete</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar objeto roc</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">roc</span>(heart_disease <span class="sc">~</span> <span class="fu">fitted</span>(m4_final),</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="co"># trazar curva ROC</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggroc</span>(res, <span class="at">legacy.axes =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TEMA-4_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimir AUC</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>auc</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.87</code></pre>
</div>
</div>
<p>Como la función <code>ggroc()</code> funciona con capas del paquete <code>{ggplot2}</code>, podemos imprimir el AUC directamente en el título del gráfico de la curva ROC:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># trazar curva ROC con AUC e intervalo de confianza en el título del gráfico</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggroc</span>(res, <span class="at">legacy.axes =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"AUC = "</span>, <span class="fu">round</span>(res<span class="sc">$</span>auc, <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TEMA-4_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Estas dos métricas de calidad se pueden interpretar de la siguiente manera:</p>
<ul>
<li>En el gráfico, cuanto más cerca esté la curva ROC de la esquina superior izquierda, mejor será el modelo.</li>
<li>Cuanto más cerca esté el AUC de 1, mejor será el modelo.</li>
</ul>
<p>Basándonos en la curva ROC y el AUC, podemos decir que este modelo es de bueno a muy bueno. Esto significa que el modelo es apropiado para estos datos y que puede ser útil para predecir si un paciente desarrollará o no una enfermedad cardíaca. El intervalo de confianza para la AUC se puede calcular de la siguiente manera:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># IC del 95% para AUC</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ci.auc</span>(res)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI: 0.8299-0.9101 (DeLong)</code></pre>
</div>
</div>
<p>El IC del 95% para la AUC no incluye el valor 0.5, lo que indica que el modelo es significativamente mejor que un modelo aleatorio al nivel de significancia del 5%. Y este se puede graficar de la siguiente manera:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># trazar curva ROC con AUC e intervalo de confianza en el título del gráfico</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggroc</span>(res, <span class="at">legacy.axes =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"AUC = "</span>, <span class="fu">round</span>(res<span class="sc">$</span>auc, <span class="dv">2</span>), <span class="st">" (IC 95%: "</span>, <span class="fu">round</span>(<span class="fu">ci.auc</span>(res)[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">"-"</span>, <span class="fu">round</span>(<span class="fu">ci.auc</span>(res)[<span class="dv">3</span>], <span class="dv">2</span>), <span class="st">")"</span>)) <span class="sc">+</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TEMA-4_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="reporte-de-resultados" class="level3" data-number="4.6.5">
<h3 data-number="4.6.5" class="anchored" data-anchor-id="reporte-de-resultados"><span class="header-section-number">4.6.5</span> Reporte de resultados</h3>
<p>Como hemos visto antes, los <strong>odds ratios</strong> son útiles al reportar los resultados de las regresiones logísticas binarias. Calcular estos odds ratios junto con sus intervalos de confianza no es particularmente difícil. Sin embargo, presentarlos en una tabla para una publicación o un informe puede convertirse rápidamente en una tarea que consume mucho tiempo, en particular si tienes muchos modelos y muchas variables independientes. Afortunadamente, hay dos paquetes que ahorran mucho tiempo y que recomendamos utilizar para reportar los resultados de una regresión logística <span class="citation" data-cites="Peng02">[<a href="#ref-Peng02" role="doc-biblioref">5</a>]</span>.</p>
<p>El primer paquete, llamado <code>{gtsummary}</code>, es útil para reportar los resultados de una regresión a la vez. El segundo es el paquete <code>{finalfit}</code>. Este paquete es más apropiado si necesitas reportar los resultados de varias regresiones a la vez. Aquí tienes un ejemplo con uno de los modelos construidos anteriormente:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cargar paquete</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("gtsummary")</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimir tabla de resultados</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(m4_final, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="xwlsiljrwu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xwlsiljrwu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xwlsiljrwu thead, #xwlsiljrwu tbody, #xwlsiljrwu tfoot, #xwlsiljrwu tr, #xwlsiljrwu td, #xwlsiljrwu th {
  border-style: none;
}

#xwlsiljrwu p {
  margin: 0;
  padding: 0;
}

#xwlsiljrwu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xwlsiljrwu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xwlsiljrwu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xwlsiljrwu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xwlsiljrwu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xwlsiljrwu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xwlsiljrwu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xwlsiljrwu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xwlsiljrwu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xwlsiljrwu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xwlsiljrwu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xwlsiljrwu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xwlsiljrwu .gt_spanner_row {
  border-bottom-style: hidden;
}

#xwlsiljrwu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xwlsiljrwu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xwlsiljrwu .gt_from_md > :first-child {
  margin-top: 0;
}

#xwlsiljrwu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xwlsiljrwu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xwlsiljrwu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xwlsiljrwu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xwlsiljrwu .gt_row_group_first td {
  border-top-width: 2px;
}

#xwlsiljrwu .gt_row_group_first th {
  border-top-width: 2px;
}

#xwlsiljrwu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwlsiljrwu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xwlsiljrwu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xwlsiljrwu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xwlsiljrwu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwlsiljrwu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xwlsiljrwu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xwlsiljrwu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xwlsiljrwu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xwlsiljrwu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xwlsiljrwu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwlsiljrwu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xwlsiljrwu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwlsiljrwu .gt_left {
  text-align: left;
}

#xwlsiljrwu .gt_center {
  text-align: center;
}

#xwlsiljrwu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xwlsiljrwu .gt_font_normal {
  font-weight: normal;
}

#xwlsiljrwu .gt_font_bold {
  font-weight: bold;
}

#xwlsiljrwu .gt_font_italic {
  font-style: italic;
}

#xwlsiljrwu .gt_super {
  font-size: 65%;
}

#xwlsiljrwu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xwlsiljrwu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xwlsiljrwu .gt_indent_1 {
  text-indent: 5px;
}

#xwlsiljrwu .gt_indent_2 {
  text-indent: 10px;
}

#xwlsiljrwu .gt_indent_3 {
  text-indent: 15px;
}

#xwlsiljrwu .gt_indent_4 {
  text-indent: 20px;
}

#xwlsiljrwu .gt_indent_5 {
  text-indent: 25px;
}

#xwlsiljrwu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xwlsiljrwu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>OR</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">age</td>
<td class="gt_row gt_center" headers="estimate">0.74</td>
<td class="gt_row gt_center" headers="conf.low">0.55, 0.96</td>
<td class="gt_row gt_center" headers="p.value">0.031</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">sex</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;mujer</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;hombre</td>
<td class="gt_row gt_center" headers="estimate">5.50</td>
<td class="gt_row gt_center" headers="conf.low">2.82, 11.2</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">chest_pain</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;angina típica</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;angina atípica</td>
<td class="gt_row gt_center" headers="estimate">0.99</td>
<td class="gt_row gt_center" headers="conf.low">0.27, 3.65</td>
<td class="gt_row gt_center" headers="p.value">&gt;0.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;dolor no anginoso</td>
<td class="gt_row gt_center" headers="estimate">0.94</td>
<td class="gt_row gt_center" headers="conf.low">0.30, 3.07</td>
<td class="gt_row gt_center" headers="p.value">&gt;0.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;asintomático</td>
<td class="gt_row gt_center" headers="estimate">7.19</td>
<td class="gt_row gt_center" headers="conf.low">2.44, 22.8</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">max_heartrate</td>
<td class="gt_row gt_center" headers="estimate">0.85</td>
<td class="gt_row gt_center" headers="conf.low">0.76, 0.94</td>
<td class="gt_row gt_center" headers="p.value">0.003</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">age * max_heartrate</td>
<td class="gt_row gt_center" headers="estimate">1.00</td>
<td class="gt_row gt_center" headers="conf.low">1.00, 1.00</td>
<td class="gt_row gt_center" headers="p.value">0.013</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviations: CI = Confidence Interval, OR = Odds Ratio</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Lo que me gusta de este paquete es su facilidad de uso y el hecho de que todos los resultados están bien formateados en una tabla. Es un muy buen punto de partida cuando necesito crear una tabla para una publicación o un informe, para una regresión a la vez. El paquete <code>{finalfit}</code> permite reportar los odds ratios, sus intervalos de confianza y los valores <span class="math inline">\(p\)</span> de una manera muy eficiente. Además, es bastante fácil hacerlo para muchas regresiones al mismo tiempo.</p>
<p>Permíteme presentar el paquete reportando los resultados de:</p>
<ul>
<li>Todas las regresiones logísticas binarias univariables que son posibles con las variables disponibles en el data frame.</li>
<li>Una regresión logística binaria multivariable que incluye todas las variables disponibles en el data frame.</li>
<li>Una regresión logística binaria multivariable que incluye solo algunas de las variables presentes en el data frame.</li>
</ul>
<p>Comenzamos con todas las posibles regresiones logísticas binarias univariables:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cargar paquetes</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("finalfit")</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(finalfit)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co"># establecer variables dependientes e independientes</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>dependent <span class="ot">&lt;-</span> <span class="st">"heart_disease"</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>independent <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"chest_pain"</span>, <span class="st">"max_heartrate"</span>)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar resultados de las regresiones logísticas univariables</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>glmuni <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmuni</span>(dependent, independent) <span class="sc">|&gt;</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit2df</span>(</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">explanatory_name =</span> <span class="st">"Variables"</span>,</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_name =</span> <span class="st">"OR Crudo"</span>,</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_suffix =</span> <span class="st">" (IC 95%)"</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimir resultados</span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>glmuni <span class="sc">|&gt;</span></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="lcpytltsib" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lcpytltsib table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lcpytltsib thead, #lcpytltsib tbody, #lcpytltsib tfoot, #lcpytltsib tr, #lcpytltsib td, #lcpytltsib th {
  border-style: none;
}

#lcpytltsib p {
  margin: 0;
  padding: 0;
}

#lcpytltsib .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lcpytltsib .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lcpytltsib .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lcpytltsib .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lcpytltsib .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lcpytltsib .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lcpytltsib .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lcpytltsib .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lcpytltsib .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lcpytltsib .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lcpytltsib .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lcpytltsib .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lcpytltsib .gt_spanner_row {
  border-bottom-style: hidden;
}

#lcpytltsib .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lcpytltsib .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lcpytltsib .gt_from_md > :first-child {
  margin-top: 0;
}

#lcpytltsib .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lcpytltsib .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lcpytltsib .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lcpytltsib .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lcpytltsib .gt_row_group_first td {
  border-top-width: 2px;
}

#lcpytltsib .gt_row_group_first th {
  border-top-width: 2px;
}

#lcpytltsib .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcpytltsib .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lcpytltsib .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lcpytltsib .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lcpytltsib .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcpytltsib .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lcpytltsib .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lcpytltsib .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lcpytltsib .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lcpytltsib .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lcpytltsib .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcpytltsib .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lcpytltsib .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcpytltsib .gt_left {
  text-align: left;
}

#lcpytltsib .gt_center {
  text-align: center;
}

#lcpytltsib .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lcpytltsib .gt_font_normal {
  font-weight: normal;
}

#lcpytltsib .gt_font_bold {
  font-weight: bold;
}

#lcpytltsib .gt_font_italic {
  font-style: italic;
}

#lcpytltsib .gt_super {
  font-size: 65%;
}

#lcpytltsib .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lcpytltsib .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lcpytltsib .gt_indent_1 {
  text-indent: 5px;
}

#lcpytltsib .gt_indent_2 {
  text-indent: 10px;
}

#lcpytltsib .gt_indent_3 {
  text-indent: 15px;
}

#lcpytltsib .gt_indent_4 {
  text-indent: 20px;
}

#lcpytltsib .gt_indent_5 {
  text-indent: 25px;
}

#lcpytltsib .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lcpytltsib div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Variables" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Variables</th>
<th id="OR-Crudo-(IC-95%)" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">OR Crudo (IC 95%)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Variables">age</td>
<td class="gt_row gt_left" headers="OR Crudo (IC 95%)">1.05 (1.03-1.08, p&lt;0.001)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables">sexhombre</td>
<td class="gt_row gt_left" headers="OR Crudo (IC 95%)">3.57 (2.12-6.18, p&lt;0.001)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variables">chest_painangina atípica</td>
<td class="gt_row gt_left" headers="OR Crudo (IC 95%)">0.51 (0.16-1.66, p=0.255)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables">chest_paindolor no anginoso</td>
<td class="gt_row gt_left" headers="OR Crudo (IC 95%)">0.63 (0.23-1.86, p=0.384)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variables">chest_painasintomático</td>
<td class="gt_row gt_left" headers="OR Crudo (IC 95%)">6.04 (2.39-16.76, p&lt;0.001)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables">max_heartrate</td>
<td class="gt_row gt_left" headers="OR Crudo (IC 95%)">0.96 (0.94-0.97, p&lt;0.001)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Algunas observaciones sobre este código: - Se usa <code>glmuni()</code> porque queremos ejecutar GLM univariables. - Se usa <code>explanatory_name = "Variables"</code> para renombrar la primera columna (por defecto es “explanatory”). - Se usa <code>estimate_name = "OR Crudo"</code> para renombrar la segunda columna e informar al lector que estamos en el caso univariable. En el caso univariable, los OR a menudo se denominan OR crudos porque no están ajustados por los efectos de las otras variables independientes. - Se usa <code>estimate_suffix = " (IC 95%)"</code> para especificar que son los intervalos de confianza del 95% los que están dentro de los paréntesis. - La capa <code>gt()</code> al final del código no es obligatoria. Es solo para que la salida aparezca en una tabla bonita en lugar del formato habitual de las salidas de R. Consulta más información sobre el paquete <code>{gt}</code> en su <a href="https://gt.rstudio.com/" target="_blank">documentación</a>.</p>
<p>A continuación, cómo reportar los resultados de una regresión logística binaria multivariable que incluye todas las variables:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar resultados del modelo completo</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>glmmulti_full <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmulti</span>(dependent, independent) <span class="sc">|&gt;</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit2df</span>(</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">explanatory_name =</span> <span class="st">"Variables"</span>,</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_name =</span> <span class="st">"OR Ajustado - modelo completo"</span>,</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimir resultados</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>glmmulti_full <span class="sc">|&gt;</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="frfmpskvvh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#frfmpskvvh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#frfmpskvvh thead, #frfmpskvvh tbody, #frfmpskvvh tfoot, #frfmpskvvh tr, #frfmpskvvh td, #frfmpskvvh th {
  border-style: none;
}

#frfmpskvvh p {
  margin: 0;
  padding: 0;
}

#frfmpskvvh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#frfmpskvvh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#frfmpskvvh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#frfmpskvvh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#frfmpskvvh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#frfmpskvvh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#frfmpskvvh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#frfmpskvvh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#frfmpskvvh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#frfmpskvvh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#frfmpskvvh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#frfmpskvvh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#frfmpskvvh .gt_spanner_row {
  border-bottom-style: hidden;
}

#frfmpskvvh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#frfmpskvvh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#frfmpskvvh .gt_from_md > :first-child {
  margin-top: 0;
}

#frfmpskvvh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#frfmpskvvh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#frfmpskvvh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#frfmpskvvh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#frfmpskvvh .gt_row_group_first td {
  border-top-width: 2px;
}

#frfmpskvvh .gt_row_group_first th {
  border-top-width: 2px;
}

#frfmpskvvh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#frfmpskvvh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#frfmpskvvh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#frfmpskvvh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#frfmpskvvh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#frfmpskvvh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#frfmpskvvh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#frfmpskvvh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#frfmpskvvh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#frfmpskvvh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#frfmpskvvh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#frfmpskvvh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#frfmpskvvh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#frfmpskvvh .gt_left {
  text-align: left;
}

#frfmpskvvh .gt_center {
  text-align: center;
}

#frfmpskvvh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#frfmpskvvh .gt_font_normal {
  font-weight: normal;
}

#frfmpskvvh .gt_font_bold {
  font-weight: bold;
}

#frfmpskvvh .gt_font_italic {
  font-style: italic;
}

#frfmpskvvh .gt_super {
  font-size: 65%;
}

#frfmpskvvh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#frfmpskvvh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#frfmpskvvh .gt_indent_1 {
  text-indent: 5px;
}

#frfmpskvvh .gt_indent_2 {
  text-indent: 10px;
}

#frfmpskvvh .gt_indent_3 {
  text-indent: 15px;
}

#frfmpskvvh .gt_indent_4 {
  text-indent: 20px;
}

#frfmpskvvh .gt_indent_5 {
  text-indent: 25px;
}

#frfmpskvvh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#frfmpskvvh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Variables" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Variables</th>
<th id="OR-Ajustado---modelo-completo" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">OR Ajustado - modelo completo</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Variables">age</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo completo">1.04 (1.01-1.08, p=0.024)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables">sexhombre</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo completo">5.40 (2.78-10.97, p&lt;0.001)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variables">chest_painangina atípica</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo completo">0.89 (0.25-3.19, p=0.851)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables">chest_paindolor no anginoso</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo completo">0.88 (0.29-2.81, p=0.828)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variables">chest_painasintomático</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo completo">7.13 (2.51-22.03, p&lt;0.001)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables">max_heartrate</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo completo">0.97 (0.95-0.99, p&lt;0.001)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Algunas observaciones sobre este código: - Se usa <code>glmmulti()</code> porque queremos ejecutar GLM multivariables. - Se usa <code>estimate_name = "OR Ajustado - modelo completo"</code> para recordar al lector que estamos en el caso multivariable con todas las variables incluidas. En el caso multivariable, los OR a menudo se denominan OR ajustados porque están ajustados por los efectos de las otras variables independientes.</p>
<p>A continuación, cómo reportar los resultados de una regresión logística binaria multivariable que incluye solo una selección de variables:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seleccionar las variables a incluir en el modelo final</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>independent_final <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"chest_pain"</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar resultados del modelo final</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>glmmulti_final <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmulti</span>(dependent, independent_final) <span class="sc">|&gt;</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit2df</span>(</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">explanatory_name =</span> <span class="st">"Variables"</span>,</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_name =</span> <span class="st">"OR Ajustado - modelo final"</span>,</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_suffix =</span> <span class="st">" (IC 95%)"</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimir resultados</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>glmmulti_final <span class="sc">|&gt;</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="wtscwluruh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wtscwluruh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wtscwluruh thead, #wtscwluruh tbody, #wtscwluruh tfoot, #wtscwluruh tr, #wtscwluruh td, #wtscwluruh th {
  border-style: none;
}

#wtscwluruh p {
  margin: 0;
  padding: 0;
}

#wtscwluruh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wtscwluruh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wtscwluruh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wtscwluruh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wtscwluruh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wtscwluruh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wtscwluruh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wtscwluruh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wtscwluruh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wtscwluruh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wtscwluruh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wtscwluruh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wtscwluruh .gt_spanner_row {
  border-bottom-style: hidden;
}

#wtscwluruh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wtscwluruh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wtscwluruh .gt_from_md > :first-child {
  margin-top: 0;
}

#wtscwluruh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wtscwluruh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wtscwluruh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wtscwluruh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wtscwluruh .gt_row_group_first td {
  border-top-width: 2px;
}

#wtscwluruh .gt_row_group_first th {
  border-top-width: 2px;
}

#wtscwluruh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wtscwluruh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wtscwluruh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wtscwluruh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wtscwluruh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wtscwluruh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wtscwluruh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wtscwluruh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wtscwluruh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wtscwluruh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wtscwluruh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wtscwluruh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wtscwluruh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wtscwluruh .gt_left {
  text-align: left;
}

#wtscwluruh .gt_center {
  text-align: center;
}

#wtscwluruh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wtscwluruh .gt_font_normal {
  font-weight: normal;
}

#wtscwluruh .gt_font_bold {
  font-weight: bold;
}

#wtscwluruh .gt_font_italic {
  font-style: italic;
}

#wtscwluruh .gt_super {
  font-size: 65%;
}

#wtscwluruh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wtscwluruh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wtscwluruh .gt_indent_1 {
  text-indent: 5px;
}

#wtscwluruh .gt_indent_2 {
  text-indent: 10px;
}

#wtscwluruh .gt_indent_3 {
  text-indent: 15px;
}

#wtscwluruh .gt_indent_4 {
  text-indent: 20px;
}

#wtscwluruh .gt_indent_5 {
  text-indent: 25px;
}

#wtscwluruh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wtscwluruh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Variables" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Variables</th>
<th id="OR-Ajustado---modelo-final-(IC-95%)" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">OR Ajustado - modelo final (IC 95%)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Variables">age</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo final (IC 95%)">1.07 (1.03-1.11, p&lt;0.001)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables">sexhombre</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo final (IC 95%)">5.52 (2.88-11.07, p&lt;0.001)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variables">chest_painangina atípica</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo final (IC 95%)">0.82 (0.24-2.82, p=0.743)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables">chest_paindolor no anginoso</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo final (IC 95%)">0.93 (0.32-2.90, p=0.903)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variables">chest_painasintomático</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo final (IC 95%)">9.48 (3.47-28.53, p&lt;0.001)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Ten en cuenta que tienes que seleccionar manualmente las variables (el paquete no elegirá por ti, desafortunadamente). La selección podría hacerse previamente gracias a un procedimiento por pasos, por ejemplo. Ahora la parte más interesante de este paquete:</p>
<ul>
<li>¡Podemos combinar todos estos resultados juntos!</li>
<li>¡Además de algunas estadísticas descriptivas para cada nivel de la variable dependiente!</li>
</ul>
<p>Aquí están todos los resultados combinados y mostrados en una tabla:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar estadísticas descriptivas</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>summary <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary_factorlist</span>(dependent, independent, <span class="at">fit_id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar resultados de las regresiones</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> summary <span class="sc">|&gt;</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalfit_merge</span>(glmuni) <span class="sc">|&gt;</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalfit_merge</span>(glmmulti_full) <span class="sc">|&gt;</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalfit_merge</span>(glmmulti_final)</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimir todos los resultados</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>output <span class="sc">|&gt;</span></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>fit_id, <span class="sc">-</span>index) <span class="sc">|&gt;</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variables =</span> label,</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">" "</span> <span class="ot">=</span> levels</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="btwoplmojd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#btwoplmojd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#btwoplmojd thead, #btwoplmojd tbody, #btwoplmojd tfoot, #btwoplmojd tr, #btwoplmojd td, #btwoplmojd th {
  border-style: none;
}

#btwoplmojd p {
  margin: 0;
  padding: 0;
}

#btwoplmojd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#btwoplmojd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#btwoplmojd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#btwoplmojd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#btwoplmojd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#btwoplmojd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#btwoplmojd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#btwoplmojd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#btwoplmojd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#btwoplmojd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#btwoplmojd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#btwoplmojd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#btwoplmojd .gt_spanner_row {
  border-bottom-style: hidden;
}

#btwoplmojd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#btwoplmojd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#btwoplmojd .gt_from_md > :first-child {
  margin-top: 0;
}

#btwoplmojd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#btwoplmojd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#btwoplmojd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#btwoplmojd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#btwoplmojd .gt_row_group_first td {
  border-top-width: 2px;
}

#btwoplmojd .gt_row_group_first th {
  border-top-width: 2px;
}

#btwoplmojd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#btwoplmojd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#btwoplmojd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#btwoplmojd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#btwoplmojd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#btwoplmojd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#btwoplmojd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#btwoplmojd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#btwoplmojd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#btwoplmojd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#btwoplmojd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#btwoplmojd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#btwoplmojd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#btwoplmojd .gt_left {
  text-align: left;
}

#btwoplmojd .gt_center {
  text-align: center;
}

#btwoplmojd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#btwoplmojd .gt_font_normal {
  font-weight: normal;
}

#btwoplmojd .gt_font_bold {
  font-weight: bold;
}

#btwoplmojd .gt_font_italic {
  font-style: italic;
}

#btwoplmojd .gt_super {
  font-size: 65%;
}

#btwoplmojd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#btwoplmojd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#btwoplmojd .gt_indent_1 {
  text-indent: 5px;
}

#btwoplmojd .gt_indent_2 {
  text-indent: 10px;
}

#btwoplmojd .gt_indent_3 {
  text-indent: 15px;
}

#btwoplmojd .gt_indent_4 {
  text-indent: 20px;
}

#btwoplmojd .gt_indent_5 {
  text-indent: 25px;
}

#btwoplmojd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#btwoplmojd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Variables" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Variables</th>
<th id="a-" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="sin-enfermedad" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">sin enfermedad</th>
<th id="enfermedad" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">enfermedad</th>
<th id="OR-Crudo-(IC-95%)" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">OR Crudo (IC 95%)</th>
<th id="OR-Ajustado---modelo-completo" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">OR Ajustado - modelo completo</th>
<th id="OR-Ajustado---modelo-final-(IC-95%)" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">OR Ajustado - modelo final (IC 95%)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Variables">age</td>
<td class="gt_row gt_left" headers=" ">Mean (SD)</td>
<td class="gt_row gt_right" headers="sin enfermedad">52.6 (9.6)</td>
<td class="gt_row gt_right" headers="enfermedad">56.8 (7.9)</td>
<td class="gt_row gt_left" headers="OR Crudo (IC 95%)">1.05 (1.03-1.08, p&lt;0.001)</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo completo">1.04 (1.01-1.08, p=0.024)</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo final (IC 95%)">1.07 (1.03-1.11, p&lt;0.001)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables">sex</td>
<td class="gt_row gt_left" headers=" ">mujer</td>
<td class="gt_row gt_right" headers="sin enfermedad">71 (44.4)</td>
<td class="gt_row gt_right" headers="enfermedad">25 (18.2)</td>
<td class="gt_row gt_left" headers="OR Crudo (IC 95%)">-</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo completo">-</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo final (IC 95%)">-</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variables"></td>
<td class="gt_row gt_left" headers=" ">hombre</td>
<td class="gt_row gt_right" headers="sin enfermedad">89 (55.6)</td>
<td class="gt_row gt_right" headers="enfermedad">112 (81.8)</td>
<td class="gt_row gt_left" headers="OR Crudo (IC 95%)">3.57 (2.12-6.18, p&lt;0.001)</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo completo">5.40 (2.78-10.97, p&lt;0.001)</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo final (IC 95%)">5.52 (2.88-11.07, p&lt;0.001)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables">chest_pain</td>
<td class="gt_row gt_left" headers=" ">angina típica</td>
<td class="gt_row gt_right" headers="sin enfermedad">16 (10.0)</td>
<td class="gt_row gt_right" headers="enfermedad">7 (5.1)</td>
<td class="gt_row gt_left" headers="OR Crudo (IC 95%)">-</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo completo">-</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo final (IC 95%)">-</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variables"></td>
<td class="gt_row gt_left" headers=" ">angina atípica</td>
<td class="gt_row gt_right" headers="sin enfermedad">40 (25.0)</td>
<td class="gt_row gt_right" headers="enfermedad">9 (6.6)</td>
<td class="gt_row gt_left" headers="OR Crudo (IC 95%)">0.51 (0.16-1.66, p=0.255)</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo completo">0.89 (0.25-3.19, p=0.851)</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo final (IC 95%)">0.82 (0.24-2.82, p=0.743)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables"></td>
<td class="gt_row gt_left" headers=" ">dolor no anginoso</td>
<td class="gt_row gt_right" headers="sin enfermedad">65 (40.6)</td>
<td class="gt_row gt_right" headers="enfermedad">18 (13.1)</td>
<td class="gt_row gt_left" headers="OR Crudo (IC 95%)">0.63 (0.23-1.86, p=0.384)</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo completo">0.88 (0.29-2.81, p=0.828)</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo final (IC 95%)">0.93 (0.32-2.90, p=0.903)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variables"></td>
<td class="gt_row gt_left" headers=" ">asintomático</td>
<td class="gt_row gt_right" headers="sin enfermedad">39 (24.4)</td>
<td class="gt_row gt_right" headers="enfermedad">103 (75.2)</td>
<td class="gt_row gt_left" headers="OR Crudo (IC 95%)">6.04 (2.39-16.76, p&lt;0.001)</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo completo">7.13 (2.51-22.03, p&lt;0.001)</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo final (IC 95%)">9.48 (3.47-28.53, p&lt;0.001)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables">max_heartrate</td>
<td class="gt_row gt_left" headers=" ">Mean (SD)</td>
<td class="gt_row gt_right" headers="sin enfermedad">158.6 (19.0)</td>
<td class="gt_row gt_right" headers="enfermedad">139.1 (22.7)</td>
<td class="gt_row gt_left" headers="OR Crudo (IC 95%)">0.96 (0.94-0.97, p&lt;0.001)</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo completo">0.97 (0.95-0.99, p&lt;0.001)</td>
<td class="gt_row gt_left" headers="OR Ajustado - modelo final (IC 95%)">-</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Algunas observaciones sobre este código:</p>
<ul>
<li><code>summary_factorlist(dependent, independent, fit_id = TRUE)</code> se usa para calcular las estadísticas descriptivas por grupo de la variable dependiente.</li>
<li><code>finalfit_merge()</code> se usa para fusionar los resultados.</li>
<li><code>dplyr::select(-fit_id, -index)</code> se usa para eliminar columnas innecesarias.</li>
<li><code>dplyr::rename(Variables = label, " " = levels)</code> se usa para renombrar algunas columnas.</li>
</ul>
<p>Y finalmente, algunas observaciones sobre la tabla resultante:</p>
<ul>
<li>La primera columna da el nombre de las variables.</li>
<li>La segunda columna especifica:
<ul>
<li>Para variables cualitativas: los niveles.</li>
<li>Para variables cuantitativas: que es la media y la desviación estándar (DE) lo que se calculará en las dos columnas siguientes.</li>
</ul></li>
<li>La tercera y cuarta columnas dan las estadísticas descriptivas para cada nivel de la variable dependiente:
<ul>
<li>Para variables cualitativas: el número de casos y, entre paréntesis, las frecuencias por columna.</li>
<li>Para variables cuantitativas: la media y, entre paréntesis, la desviación estándar.</li>
</ul></li>
<li>Las últimas tres columnas dan el OR y, entre paréntesis, el IC del 95% del OR y el valor <span class="math inline">\(p\)</span> (para el modelo univariable y los dos modelos multivariables, respectivamente).</li>
</ul>
<p>Para tu comodidad, aquí tienes el código completo para que puedas copiarlo y pegarlo fácilmente en caso de que quieras reproducir el proceso:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cargar paquetes</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(finalfit)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co"># establecer variables</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>dependent <span class="ot">&lt;-</span> <span class="st">"heart_disease"</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>independent <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"chest_pain"</span>, <span class="st">"max_heartrate"</span>)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>independent_final <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"chest_pain"</span>)</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar estadísticas descriptivas</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>summary <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary_factorlist</span>(dependent, independent, <span class="at">fit_id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar resultados de regresiones logísticas univariables</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>glmuni <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmuni</span>(dependent, independent) <span class="sc">|&gt;</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit2df</span>(</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">explanatory_name =</span> <span class="st">"Variables"</span>,</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_name =</span> <span class="st">"OR Crudo"</span>,</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_suffix =</span> <span class="st">" (IC 95%)"</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar resultados del modelo completo</span></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>glmmulti_full <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmulti</span>(dependent, independent) <span class="sc">|&gt;</span></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit2df</span>(</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">explanatory_name =</span> <span class="st">"Variables"</span>,</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_name =</span> <span class="st">"OR Ajustado - modelo completo"</span>,</span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar resultados del modelo final</span></span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>glmmulti_final <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span></span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmulti</span>(dependent, independent_final) <span class="sc">|&gt;</span></span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit2df</span>(</span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">explanatory_name =</span> <span class="st">"Variables"</span>,</span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_name =</span> <span class="st">"OR Ajustado - modelo final"</span>,</span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_suffix =</span> <span class="st">" (IC 95%)"</span></span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar resultados fusionados</span></span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> summary <span class="sc">|&gt;</span></span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalfit_merge</span>(glmuni) <span class="sc">|&gt;</span></span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalfit_merge</span>(glmmulti_full) <span class="sc">|&gt;</span></span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalfit_merge</span>(glmmulti_final)</span>
<span id="cb91-46"><a href="#cb91-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-47"><a href="#cb91-47" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimir todos los resultados</span></span>
<span id="cb91-48"><a href="#cb91-48" aria-hidden="true" tabindex="-1"></a>output <span class="sc">|&gt;</span></span>
<span id="cb91-49"><a href="#cb91-49" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>fit_id, <span class="sc">-</span>index) <span class="sc">|&gt;</span></span>
<span id="cb91-50"><a href="#cb91-50" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb91-51"><a href="#cb91-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variables =</span> label,</span>
<span id="cb91-52"><a href="#cb91-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">" "</span> <span class="ot">=</span> levels</span>
<span id="cb91-53"><a href="#cb91-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb91-54"><a href="#cb91-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Por último, pero no menos importante, la función <code>or_plot()</code>, también disponible en el paquete <code>{finalfit}</code>, es útil para visualizar todos los odds ratio y sus intervalos de confianza del 95%:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">|&gt;</span> <span class="fu">or_plot</span>(dependent, independent,</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">table_text_size =</span> <span class="fl">3.5</span> <span class="co"># reducir tamaño del texto</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TEMA-4_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>A continuación se explica cómo leer este gráfico:</p>
<ul>
<li>Los cuadrados representan el OR, y las líneas sus IC del 95%.</li>
<li>Cuando el IC del 95% cruza la línea vertical discontinua, significa que el OR no es significativamente diferente de 1 (a un nivel de significancia del 5%). En estos casos, no podemos rechazar la hipótesis de no asociación con la variable dependiente.</li>
<li>Cuando el IC del 95% no cruza la línea vertical discontinua, significa que el OR es significativamente diferente de 1. En estos casos:
<ul>
<li>Si el cuadrado se encuentra a la derecha de la línea vertical discontinua, existe una relación positiva entre el resultado y la variable independiente (conocido como <strong>factor de riesgo</strong>).</li>
<li>Si el cuadrado se encuentra a la izquierda de la línea vertical discontinua, existe una relación negativa entre el resultado y la variable independiente (conocido como <strong>factor protector</strong>).</li>
</ul></li>
</ul>
<p>El gráfico confirma lo que se obtuvo anteriormente:</p>
<ul>
<li>La edad es un factor de riesgo para la enfermedad cardíaca.</li>
<li>La frecuencia cardíaca máxima alcanzada es un factor protector para la enfermedad cardíaca.</li>
<li>Ser hombre y sufrir de dolor torácico asintomático son ambos factores de riesgo de enfermedad cardíaca.</li>
</ul>
<p>Ten cuidado de que a veces el cuadrado es demasiado grande para ver las líneas del IC del 95%. Este es el caso de las variables <code>max_heartrate</code> y <code>age</code>. En estos casos, es mejor verificar la significancia del OR gracias a sus IC del 95% o los valores <span class="math inline">\(p\)</span> impresos entre paréntesis.</p>
<p>Claro, aquí tienes la traducción de las secciones finales.</p>
</section>
<section id="condiciones-de-aplicación" class="level3" data-number="4.6.6">
<h3 data-number="4.6.6" class="anchored" data-anchor-id="condiciones-de-aplicación"><span class="header-section-number">4.6.6</span> Condiciones de aplicación</h3>
<p>Para que los resultados sean válidos e interpretables, una regresión logística binaria requiere:</p>
<ol type="1">
<li>Que la <strong>variable dependiente sea binaria</strong>.</li>
<li><strong>Independencia de las observaciones</strong>: que no haya mediciones repetidas o datos pareados; de lo contrario, se deben usar modelos lineales generalizados de efectos mixtos (GLMM).</li>
<li><strong>Linealidad de las variables independientes continuas y el resultado en log-odds</strong>: tomemos como ejemplo la edad y la enfermedad cardíaca. Si la enfermedad cardíaca es más o menos frecuente a medida que aumenta la edad, el modelo funcionará bien. Sin embargo, si los niños y los ancianos tienen un alto riesgo de padecer una enfermedad cardíaca, pero los de mediana edad no, entonces la relación no es lineal, o no es monotónica, lo que significa que la respuesta no va solo en una dirección.</li>
<li>Un <strong>tamaño de muestra suficientemente grande</strong> (para que los intervalos de confianza y las pruebas de hipótesis sean válidos).</li>
<li><strong>No multicolinealidad</strong>: las variables independientes no deben estar altamente correlacionadas entre sí; de lo contrario, los coeficientes y los OR pueden volverse inestables.</li>
</ol>
<p>A continuación se explica cómo verificar cada una de ellas:</p>
<ol type="1">
<li>Esto es obvio; comprueba si la variable dependiente tiene efectivamente solo dos niveles.</li>
<li>Esto a menudo no se prueba formalmente, sino que se verifica a través del diseño del experimento.</li>
<li>Las variables independientes cuantitativas deben tener una relación lineal entre sus log-odds y sus valores observados. Una comprobación visual es suficiente, mira a continuación con la edad, la frecuencia cardíaca máxima alcanzada y el modelo <code>m2</code> como ejemplo:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿Linealidad con los log-odds?</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(age, max_heartrate) <span class="sc">|&gt;</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_odds =</span> <span class="fu">predict</span>(m2)) <span class="sc">|&gt;</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>log_odds) <span class="sc">|&gt;</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(log_odds, value)) <span class="sc">+</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TEMA-4_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<ol start="4" type="1">
<li>En la práctica, se recomienda tener al menos 10 veces más eventos que parámetros en el modelo.</li>
<li>El <strong>factor de inflación de la varianza (VIF)</strong> es una medida bien conocida de multicolinealidad. Debería estar por debajo de 10 o 5, dependiendo del campo de investigación. El VIF se puede calcular con la función <code>vif()</code>, disponible en el paquete <code>{car}</code>:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cargar paquete</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calcular VIF para el modelo m3</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(m2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  GVIF Df GVIF^(1/(2*Df))
age           1.205246  1        1.097837
sex           1.155071  1        1.074742
chest_pain    1.113010  3        1.018005
max_heartrate 1.143125  1        1.069170</code></pre>
</div>
</div>


</section>
</section>
<section id="bibliography" class="level1 unnumbered">
<h1 class="unnumbered">Referencias</h1>
<div id="refs" class="references csl-bib-body" role="list">
<div id="ref-Agresti07" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Agresti A. An introduction to categorical data analysis. 2nd ed. Hoboken, NJ: Wiley; 2007. </div>
</div>
<div id="ref-Vittinghoff12" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Vittinghoff E, Glidden DV, Shiboski SC, McCulloch CE. Regression methods in biostatistics: Linear, logistic, survival, and repeated measures models. 2nd ed. New York: Springer; 2012. </div>
</div>
<div id="ref-Menard02" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Menard S. Applied logistic regression analysis. 2nd ed. Thousand Oaks, CA: Sage; 2002. </div>
</div>
<div id="ref-Hosmer13" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Hosmer DW, Lemeshow S, Sturdivant RX. Applied logistic regression. 3rd ed. Hoboken, NJ: Wiley; 2013. </div>
</div>
<div id="ref-Peng02" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Peng CYJ, Lee KL, Ingersoll GM. <a href="https://doi.org/10.1080/00220670209598786">An introduction to logistic regression analysis and reporting</a>. The Journal of Educational Research. 2002;96(1):3–14. </div>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./TEMA-3.html" class="pagination-link" aria-label="TEMA 3: REGRESIÓN LINEAL MÚLTIPLE">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">TEMA 3: REGRESIÓN LINEAL MÚLTIPLE</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./TEMA-5.html" class="pagination-link" aria-label="TEMA 5: ANÁLISIS DE SUPERVIVENCIA">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">TEMA 5: ANÁLISIS DE SUPERVIVENCIA</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>