<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; TEMA 1: PRUEBAS DIAGNÓSTICAS Y CURVAS ROC – Análisis Estadístico con Ordenador de Datos Médicos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./TEMA-2.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.34.0/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="site_libs/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script>
<link href="site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./TEMA-1.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">TEMA 1: PRUEBAS DIAGNÓSTICAS Y CURVAS ROC</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Análisis Estadístico con Ordenador de Datos Médicos</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bienvenido!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TEMA-1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">TEMA 1: PRUEBAS DIAGNÓSTICAS Y CURVAS ROC</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TEMA-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">TEMA 2: ANÁLISIS DE LA VARIANZA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TEMA-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">TEMA 3: REGRESIÓN LINEAL MÚLTIPLE</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TEMA-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">TEMA 4: REGRESIÓN LOGISTICA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TEMA-5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">TEMA 5: ANÁLISIS DE SUPERVIVENCIA</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción"><span class="header-section-number">1.1</span> Introducción</a></li>
  <li><a href="#test-diagnósticos-en-tablas-de-contingencia-2x2" id="toc-test-diagnósticos-en-tablas-de-contingencia-2x2" class="nav-link" data-scroll-target="#test-diagnósticos-en-tablas-de-contingencia-2x2"><span class="header-section-number">1.2</span> Test Diagnósticos en Tablas de contingencia 2x2</a>
  <ul class="collapse">
  <li><a href="#medidas-de-precisión-diagnóstica" id="toc-medidas-de-precisión-diagnóstica" class="nav-link" data-scroll-target="#medidas-de-precisión-diagnóstica"><span class="header-section-number">1.2.1</span> Medidas de precisión diagnóstica</a></li>
  <li><a href="#la-influencia-de-la-prevalencia-de-la-enfermedad-en-los-valores-predictivos" id="toc-la-influencia-de-la-prevalencia-de-la-enfermedad-en-los-valores-predictivos" class="nav-link" data-scroll-target="#la-influencia-de-la-prevalencia-de-la-enfermedad-en-los-valores-predictivos"><span class="header-section-number">1.2.2</span> La influencia de la prevalencia de la enfermedad en los valores predictivos</a></li>
  <li><a href="#gráfico-de-mosaico-para-una-tabla-2x2" id="toc-gráfico-de-mosaico-para-una-tabla-2x2" class="nav-link" data-scroll-target="#gráfico-de-mosaico-para-una-tabla-2x2"><span class="header-section-number">1.2.3</span> Gráfico de mosaico para una tabla 2x2</a></li>
  <li><a href="#teoremas-de-probabilidad-total-bayes-y-valores-predictivos-o-probabilidad-a-posteriori" id="toc-teoremas-de-probabilidad-total-bayes-y-valores-predictivos-o-probabilidad-a-posteriori" class="nav-link" data-scroll-target="#teoremas-de-probabilidad-total-bayes-y-valores-predictivos-o-probabilidad-a-posteriori"><span class="header-section-number">1.2.4</span> Teoremas de Probabilidad Total, Bayes y Valores predictivos o Probabilidad a Posteriori</a></li>
  <li><a href="#las-razones-de-verosimilitud-rv" id="toc-las-razones-de-verosimilitud-rv" class="nav-link" data-scroll-target="#las-razones-de-verosimilitud-rv"><span class="header-section-number">1.2.5</span> Las Razones de Verosimilitud (RV)</a></li>
  <li><a href="#aplicación-de-las-rv-revisando-la-probabilidad-de-enfermedad" id="toc-aplicación-de-las-rv-revisando-la-probabilidad-de-enfermedad" class="nav-link" data-scroll-target="#aplicación-de-las-rv-revisando-la-probabilidad-de-enfermedad"><span class="header-section-number">1.2.6</span> Aplicación de las RV (revisando la probabilidad de enfermedad)</a></li>
  <li><a href="#probabilidad-post-prueba-y-el-nomograma-de-fagan" id="toc-probabilidad-post-prueba-y-el-nomograma-de-fagan" class="nav-link" data-scroll-target="#probabilidad-post-prueba-y-el-nomograma-de-fagan"><span class="header-section-number">1.2.7</span> Probabilidad post-prueba y el Nomograma de Fagan</a></li>
  </ul></li>
  <li><a href="#receiver-operating-characteristic-roc-curve" id="toc-receiver-operating-characteristic-roc-curve" class="nav-link" data-scroll-target="#receiver-operating-characteristic-roc-curve"><span class="header-section-number">1.3</span> Receiver Operating Characteristic (ROC) curve</a>
  <ul class="collapse">
  <li><a href="#cómo-se-construye" id="toc-cómo-se-construye" class="nav-link" data-scroll-target="#cómo-se-construye"><span class="header-section-number">1.3.1</span> ¿Cómo se construye?</a></li>
  <li><a href="#interpretación-del-auc" id="toc-interpretación-del-auc" class="nav-link" data-scroll-target="#interpretación-del-auc"><span class="header-section-number">1.3.2</span> Interpretación del AUC</a></li>
  <li><a href="#encontrar-un-punto-de-corte-apropiado" id="toc-encontrar-un-punto-de-corte-apropiado" class="nav-link" data-scroll-target="#encontrar-un-punto-de-corte-apropiado"><span class="header-section-number">1.3.3</span> Encontrar un Punto de Corte Apropiado</a></li>
  </ul></li>
  <li><a href="#comparación-de-dos-pruebas-diagnósticas" id="toc-comparación-de-dos-pruebas-diagnósticas" class="nav-link" data-scroll-target="#comparación-de-dos-pruebas-diagnósticas"><span class="header-section-number">1.4</span> Comparación de Dos Pruebas Diagnósticas</a>
  <ul class="collapse">
  <li><a href="#base-matemática-de-la-prueba-de-delong" id="toc-base-matemática-de-la-prueba-de-delong" class="nav-link" data-scroll-target="#base-matemática-de-la-prueba-de-delong"><span class="header-section-number">1.4.1</span> Base matemática de la prueba de DeLong</a></li>
  <li><a href="#realizando-la-prueba-de-de-long" id="toc-realizando-la-prueba-de-de-long" class="nav-link" data-scroll-target="#realizando-la-prueba-de-de-long"><span class="header-section-number">1.4.2</span> Realizando la prueba de De Long</a></li>
  <li><a href="#interpretando-los-resultados" id="toc-interpretando-los-resultados" class="nav-link" data-scroll-target="#interpretando-los-resultados"><span class="header-section-number">1.4.3</span> Interpretando los resultados</a></li>
  <li><a href="#ejemplo-comparación-de-dos-cuestionarios-de-cribado-de-epoc-usando-la-prueba-de-delong" id="toc-ejemplo-comparación-de-dos-cuestionarios-de-cribado-de-epoc-usando-la-prueba-de-delong" class="nav-link" data-scroll-target="#ejemplo-comparación-de-dos-cuestionarios-de-cribado-de-epoc-usando-la-prueba-de-delong"><span class="header-section-number">1.4.4</span> Ejemplo: Comparación de dos cuestionarios de cribado de EPOC usando la prueba de DeLong</a></li>
  </ul></li>
  <li><a href="#ejercicios-resueltos" id="toc-ejercicios-resueltos" class="nav-link" data-scroll-target="#ejercicios-resueltos"><span class="header-section-number">1.5</span> Ejercicios Resueltos</a></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography">Referencias</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">TEMA 1: PRUEBAS DIAGNÓSTICAS Y CURVAS ROC</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Este tema usa material traducido del siguiente libro: <a href="https://practical-stats-med-r.netlify.app/" class="uri">https://practical-stats-med-r.netlify.app/</a></p>
<p>Cuando hayamos terminado este Capítulo, deberíamos ser capaces de:</p>
<pre><code>-   Calcular una variedad de medidas de precisión de las pruebas diagnósticas
-   Estimar la probabilidad post-prueba utilizando el teorema de Bayes
-   Comprender el Nomograma de Fagan
-   Construir e interpretar una curva ROC
-   Interpretar los resultados y redactarlos como en una revista científica de revisión por pares</code></pre>
<section id="introducción" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="introducción"><span class="header-section-number">1.1</span> Introducción</h2>
<p>Las pruebas diagnósticas son necesarias para estimar la precisión de test y pruebas diagnósticas en la clínica médica.</p>
<p>Por ejemplo, gracias a métodos estadísticos propios del ámbito de la bioestadística podemos estimar la precisión diagnóstica de la mamografía digital (prueba índice) en la detección del cáncer de mama, utilizando la histopatología como “estándar de oro”, en mujeres mayores de 40 años. Así mismo podemos estimar la probabilidad post-prueba del cáncer de mama cuando la mamografía digital es positiva o negativa dado el conocimiento previo de una probabilidad de cáncer pre-prueba.</p>
<p>A lo largo del tema vamos a necesitar cargar los siguientes paquetes estadísticos: ggmosaic, epiR, pubh, TeachingDemos, scales, here y tidyverse. Si no los tenemos instalados, debemos instalarlos primero. Aquí hay un ejemplo de cómo instalar y cargar estos paquetes:</p>
</section>
<section id="test-diagnósticos-en-tablas-de-contingencia-2x2" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="test-diagnósticos-en-tablas-de-contingencia-2x2"><span class="header-section-number">1.2</span> Test Diagnósticos en Tablas de contingencia 2x2</h2>
<p>Generalmente, el estado de la enfermedad de un individuo es una variable dicotómica; el individuo tiene la enfermedad (<span class="math inline">\(Resultado+\)</span>) o no tiene la enfermedad (<span class="math inline">\(Resultado-\)</span>) según lo definido por el estándar de referencia (o “estándar de oro”). La prueba diagnóstica bajo evaluación (también denominada prueba índice) puede medirse con una variable dicotómica (por ejemplo, presencia o ausencia de anomalías mamarias mediante una mamografía) o una variable continua (por ejemplo, nivel de glucosa en ayunas para el diagnóstico de diabetes), que puede transformarse en una variable dicotómica eligiendo un valor de corte (umbral) óptimo que distinga los resultados de prueba positivos (<span class="math inline">\(Prueba+\)</span>) de los negativos (<span class="math inline">\(Prueba-\)</span>)<span class="citation" data-cites="anaesthetist practicalstats">[<a href="#ref-anaesthetist" role="doc-biblioref">1</a>,<a href="#ref-practicalstats" role="doc-biblioref">2</a>]</span></p>
<p>Si la prueba índice da un resultado dicotómico para cada participante en un estudio, los datos pueden tabularse en una tabla de 2 x 2 del resultado de la prueba (<span class="math inline">\(Prueba+\)</span>, <span class="math inline">\(Prueba-\)</span>) frente al estado de la enfermedad “verdadero” (<span class="math inline">\(Resultado+\)</span>, <span class="math inline">\(Resultado-\)</span>). Por ejemplo, el resultado de la mamografía digital para diagnosticar cáncer de mama comparado con la biopsia/cirugía de “estándar de oro” e histopatología en 1220 mujeres con sospecha de cáncer de mama son los siguientes:</p>
<table class="caption-top table">
<caption>Una tabla 2 × 2 que informa la clasificación cruzada de individuos por el resultado de la prueba índice y de referencia.</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;">Resultado según el estándar de referencia</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(Resultado+\)</span> (Enfermedad presente)</td>
<td style="text-align: center;"><span class="math inline">\(Resultado-\)</span> (Enfermedad ausente)</td>
<td style="text-align: center;">Totales</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Resultado de la prueba índice</strong></td>
<td style="text-align: center;"><span class="math inline">\(Prueba+\)</span></td>
<td style="text-align: center;"><strong>VP</strong>=890</td>
<td style="text-align: center;"><strong>FP</strong>=110</td>
<td style="text-align: center;">VP+FP=1000</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(Prueba-\)</span></td>
<td style="text-align: center;"><strong>FN</strong>=20</td>
<td style="text-align: center;"><strong>VN</strong>=200</td>
<td style="text-align: center;">VN+FN=220</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;">Totales</td>
<td style="text-align: center;">VP+FN=910</td>
<td style="text-align: center;">VN+FP=310</td>
<td style="text-align: center;"><strong>N</strong>=1220 (VP+VN+FP+FN)</td>
</tr>
</tbody>
</table>
<p>donde</p>
<p><strong>VP</strong>: verdadero positivo; prueba positiva y enfermedad presente (Prueba+ Resultado+)</p>
<p><strong>FP</strong> = falso positivo; prueba positiva y enfermedad ausente (Prueba+ Resultado-)</p>
<p><strong>FN</strong> = falso negativo; prueba negativa y enfermedad presente (Prueba- Resultado+)</p>
<p><strong>VN</strong> = verdadero negativo; prueba negativa y enfermedad ausente (Prueba- Resultado-)</p>
<section id="medidas-de-precisión-diagnóstica" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="medidas-de-precisión-diagnóstica"><span class="header-section-number">1.2.1</span> Medidas de precisión diagnóstica</h3>
<p>La <strong>Sensibilidad (Se)</strong> de una prueba diagnóstica se refiere a la capacidad de la prueba para identificar correctamente a aquellos individuos con la enfermedad. Se define como la proporción de resultados de prueba verdaderos positivos entre los individuos que tienen la enfermedad <span class="citation" data-cites="altman1994sensitivity">[<a href="#ref-altman1994sensitivity" role="doc-biblioref">3</a>]</span>.</p>
<p>Se = <span class="math inline">\(\frac{VP}{VP+FN}=\frac{890}{910}=0.978\)</span> o <span class="math inline">\(97.8%\)</span></p>
<p>La <strong>Especificidad (Sp)</strong> de una prueba diagnóstica se refiere a la capacidad de la prueba para identificar correctamente a aquellos pacientes sin la enfermedad. Se define como la proporción de resultados de prueba verdaderos negativos entre los individuos que no tienen la enfermedad.</p>
<p>Sp = <span class="math inline">\(\frac{VN}{VN+FP}=\frac{200}{310}=0.645\)</span> o <span class="math inline">\(64.5%\)</span></p>
<p>El <strong>Valor predictivo positivo (VPP)</strong> es la probabilidad de que los individuos con un resultado positivo en la prueba diagnóstica realmente tengan la enfermedad. Se define como la proporción de resultados de prueba verdaderos positivos entre los individuos que tienen una prueba positiva.</p>
<p>VPP = <span class="math inline">\(\frac{VP}{VP+FP}=\frac{890}{1000}=0.890\)</span> o <span class="math inline">\(89.0%\)</span></p>
<p>El <strong>Valor predictivo negativo (VPN)</strong> es la probabilidad de que los individuos con un resultado negativo en la prueba diagnóstica estén realmente libres de la enfermedad. Se define como la proporción de resultados de prueba verdaderos negativos entre los individuos que tienen una prueba negativa.</p>
<p>VPN = <span class="math inline">\(\frac{VN}{VN+FN}=\frac{200}{220}=0.909\)</span> o <span class="math inline">\(90.9%\)</span></p>
</section>
<section id="la-influencia-de-la-prevalencia-de-la-enfermedad-en-los-valores-predictivos" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="la-influencia-de-la-prevalencia-de-la-enfermedad-en-los-valores-predictivos"><span class="header-section-number">1.2.2</span> La influencia de la prevalencia de la enfermedad en los valores predictivos</h3>
<p>Los valores predictivos positivos y negativos están influenciados por la <strong>prevalencia</strong> de la enfermedad en la población que se está examinando. El uso de la misma prueba en una población con una mayor prevalencia (por ejemplo, mujeres mayores de 55 años) aumenta el valor predictivo positivo. Por el contrario, una mayor prevalencia da como resultado una disminución del valor predictivo negativo. Por lo tanto, al considerar los valores predictivos de las pruebas diagnósticas o de cribado, debemos tener en cuenta la influencia de la prevalencia de la enfermedad <span class="citation" data-cites="altman1994predictive">[<a href="#ref-altman1994predictive" role="doc-biblioref">4</a>]</span>.</p>
<p>Y otras medidas diagnósticas útiles son las siguientes:</p>
<p><strong>Más medidas de precisión diagnóstica</strong></p>
<p>La <strong>Prevalencia aparente</strong> es la proporción de individuos con un resultado positivo en la prueba.</p>
<p>Prevalencia aparente = <span class="math inline">\(\frac{VP + FP}{N}=\frac{1000}{1220}=0.820\)</span> o <span class="math inline">\(82.0%\)</span></p>
<p>La <strong>Prevalencia verdadera</strong> es la proporción de individuos que están realmente enfermos.</p>
<p>Prevalencia verdadera = <span class="math inline">\(\frac{VP + FN}{N}=\frac{910}{1220}=0.746\)</span> o <span class="math inline">\(74.6%\)</span></p>
<p>La <strong>Razón de verosimilitud para un resultado de prueba positivo (RV+)</strong> es la verosimilitud (probabilidad) de que un individuo que tiene la enfermedad dé positivo dividida por la verosimilitud (probabilidad) de que un individuo que no tiene la enfermedad dé positivo. Se calcula como la sensibilidad dividida por 1 menos el valor de la especificidad <span class="citation" data-cites="simel1991">[<a href="#ref-deeks2004" role="doc-biblioref">6</a>]</span>.</p>
<p>RV+ = <span class="math inline">\(\frac{Se}{1-Sp}=\frac{0.978}{1-0.645}=\frac{0.978}{0.355}= 2.755\)</span></p>
<p>La <strong>Razón de verosimilitud para un resultado de prueba negativo (RV-)</strong> es la probabilidad de que un individuo que tiene la enfermedad dé negativo dividida por la probabilidad de que un individuo que no tiene la enfermedad dé negativo. Se calcula como 1 menos la sensibilidad dividida por el valor de la especificidad.</p>
<p>RV- = <span class="math inline">\(\frac{1-Se}{Sp}=\frac{1-0.978}{0.645}=\frac{0.022}{0.645}= 0.034\)</span></p>
<p>La <strong>Precisión diagnóstica</strong> (eficacia), expresada como una proporción de sujetos clasificados correctamente (VP+VN) entre todos los sujetos (N). La precisión diagnóstica se ve afectada por la prevalencia de la enfermedad.</p>
<p>Precisión = <span class="math inline">\(\frac{VP + VN}{N}=\frac{890 + 200}{1220}=\frac{1090}{1220}= 0.893\)</span> o <span class="math inline">\(89.3%\)</span>%</p>
<p><strong>En R:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tb1 <span class="ot">&lt;-</span> <span class="fu">as.table</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">890</span>, <span class="dv">110</span>), <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">200</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(tb1) <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test =</span> <span class="fu">c</span>(<span class="st">"Test +"</span>, <span class="st">"Test -"</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Outcome =</span> <span class="fu">c</span>(<span class="st">"Outcome +"</span>, <span class="st">"Outcome -"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>tb1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Outcome
Test     Outcome + Outcome -
  Test +       890       110
  Test -        20       200</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.tests</span>(tb1, <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Outcome +    Outcome -      Total
Test +          890          110       1000
Test -           20          200        220
Total           910          310       1220

Point estimates and 95% CIs:
--------------------------------------------------------------
Apparent prevalence *                  0.820 (0.797, 0.841)
True prevalence *                      0.746 (0.720, 0.770)
Sensitivity *                          0.978 (0.966, 0.987)
Specificity *                          0.645 (0.589, 0.698)
Positive predictive value *            0.890 (0.869, 0.909)
Negative predictive value *            0.909 (0.863, 0.944)
Positive likelihood ratio              2.756 (2.371, 3.204)
Negative likelihood ratio              0.034 (0.022, 0.053)
False T+ proportion for true D- *      0.355 (0.302, 0.411)
False T- proportion for true D+ *      0.022 (0.013, 0.034)
False T+ proportion for T+ *           0.110 (0.091, 0.131)
False T- proportion for T- *           0.091 (0.056, 0.137)
Correctly classified proportion *      0.893 (0.875, 0.910)
--------------------------------------------------------------
* Exact CIs</code></pre>
</div>
</div>
<p>A partir de esta tabla de contingencia, podemos crear un gráfico de mosaico básico.</p>
</section>
<section id="gráfico-de-mosaico-para-una-tabla-2x2" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="gráfico-de-mosaico-para-una-tabla-2x2"><span class="header-section-number">1.2.3</span> Gráfico de mosaico para una tabla 2x2</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="fu">t</span>(tb1), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"goldenrod1"</span>, <span class="st">"firebrick"</span>), </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex.axis =</span> <span class="fl">0.9</span>, <span class="at">main=</span><span class="cn">NULL</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TEMA-1_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.tests</span>(tb1, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Outcome +    Outcome -      Total
Test +          890          110       1000
Test -           20          200        220
Total           910          310       1220

Point estimates and 95% CIs:
--------------------------------------------------------------
Apparent prevalence *                  0.820 (0.797, 0.841)
True prevalence *                      0.746 (0.720, 0.770)
Sensitivity *                          0.978 (0.966, 0.987)
Specificity *                          0.645 (0.589, 0.698)
Positive predictive value *            0.890 (0.869, 0.909)
Negative predictive value *            0.909 (0.863, 0.944)
Positive likelihood ratio              2.756 (2.371, 3.204)
Negative likelihood ratio              0.034 (0.022, 0.053)
False T+ proportion for true D- *      0.355 (0.302, 0.411)
False T- proportion for true D+ *      0.022 (0.013, 0.034)
False T+ proportion for T+ *           0.110 (0.091, 0.131)
False T- proportion for T- *           0.091 (0.056, 0.137)
Correctly classified proportion *      0.893 (0.875, 0.910)
--------------------------------------------------------------
* Exact CIs</code></pre>
</div>
</div>
</section>
<section id="teoremas-de-probabilidad-total-bayes-y-valores-predictivos-o-probabilidad-a-posteriori" class="level3" data-number="1.2.4">
<h3 data-number="1.2.4" class="anchored" data-anchor-id="teoremas-de-probabilidad-total-bayes-y-valores-predictivos-o-probabilidad-a-posteriori"><span class="header-section-number">1.2.4</span> Teoremas de Probabilidad Total, Bayes y Valores predictivos o Probabilidad a Posteriori</h3>
<p>Cuando se trata de un paciente individual, las medidas importantes no son la sensibilidad o la especificidad, sino los valores predictivos. Estos nos dicen la probabilidad de que un paciente con un resultado positivo (o negativo) en la prueba realmente tenga (o no tenga) la enfermedad. La clave para responder esta pregunta está en el teorema de Bayes. Primero vamos a definir algunos términos y luego proporcionamos una breve revisión del teorema de Bayes.</p>
<p><strong>Probabilidad previa</strong> (sinónimos: probabilidad pre-prueba, prevalencia) es la probabilidad de que el paciente tenga la enfermedad antes de una prueba diagnóstica particular. Combina todo el conocimiento sobre el paciente, incluida la historia del paciente, los hallazgos físicos, los resultados de pruebas diagnósticas previas y la prevalencia de la enfermedad en la población.</p>
<p><strong>Probabilidad a posteriori</strong> (probabilidad post-prueba, valor predictivo) es la probabilidad de enfermedad después de una prueba diagnóstica particular, que tiene en cuenta tanto la probabilidad previa como los resultados de la prueba.</p>
<p><strong>Teorema de Bayes</strong> Si A1, A2, …, y An son n eventos mutuamente excluyentes y exhaustivos, de modo que <span class="math display">\[P(A1 \cup A2 \cup \dots \cup A_{n}) = P(A1)+P(A2)+\dots+P(A_{n}) = 1\]</span> Entonces el teorema de Bayes establece <span class="math display">\[P(A_{i} | B) = \frac{P(B | A_{i})P(A_{i})}{P(B | A1)P(A1) + \dots + P(B | A_{n})P(A_{n})}\]</span> para cada i, <span class="math inline">\(1 \le i \le n\)</span>.</p>
<p>En un entorno clínico, a menudo hay n = 2 eventos, como “enfermo” y “no enfermo”. La utilidad del teorema de Bayes radica en su capacidad para invertir las condiciones. Por ejemplo, calcular P(D+ <span class="math inline">\(|\)</span> T+) a partir de P(T+ <span class="math inline">\(|\)</span> D+) (la condición se invierte), aquí T+ = B y D+ = A1 en el teorema de Bayes.</p>
<p>En otras palabras, la probabilidad de que un paciente con un resultado positivo en la prueba esté realmente enfermo se puede calcular a partir de la probabilidad de que un paciente con la enfermedad tenga un resultado positivo en la prueba. Esto último es la sensibilidad de la prueba diagnóstica. Ahora la conexión entre nuestra pregunta sobre el estado de la enfermedad del paciente y las características de la prueba queda clara.</p>
<p>La pregunta se puede expresar matemáticamente:</p>
<p><span class="math inline">\(P (D+ | T+) =\)</span> Probabilidad de que un paciente con un resultado positivo en la prueba realmente tenga la enfermedad. Esto se denomina el <strong>valor predictivo de una prueba positiva</strong> o <strong>valor predictivo positivo (VPP)</strong> y <span class="math inline">\(P (D- | T-) =\)</span> Probabilidad de que un paciente con un resultado negativo en la prueba realmente no tenga la enfermedad. Esto se denomina el <strong>valor predictivo de una prueba negativa</strong> o <strong>valor predictivo negativo (VPN)</strong></p>
<p>Según el teorema de Bayes,</p>
<p><span class="math display">\[PPV = P(D+ | T+) = \frac{P(T+ | D+)P(D+)}{P(T+ | D+)P(D+) + P(T+ | D-)P(D-)}\]</span> y <span class="math display">\[NPV = P(D- | T-) = \frac{P(T- | D-)P(D-)}{P(T- | D-)P(D-) + P(T- | D+)P(D+)}\]</span></p>
<p>donde</p>
<p><span class="math inline">\(P(D+)=\)</span> Probabilidad de que el paciente tenga la enfermedad antes de la prueba – <strong>probabilidad previa</strong>, (prevalencia, probabilidad pre-prueba) <span class="math inline">\(P (D-) = 1 - P (D+),\)</span> <span class="math inline">\(P (T+ | D+) =\)</span> Probabilidad condicional de verdadero positivo, <strong>sensibilidad</strong>, <span class="math inline">\(P (T- | D-) =\)</span> Probabilidad condicional de verdadero negativo, <strong>especificidad</strong>, <span class="math inline">\(P (T+ | D-) =\)</span> Probabilidad condicional de falso positivo = 1 - especificidad, <span class="math inline">\(P (T- | D+) =\)</span> Probabilidad condicional de falso negativo = 1 – sensibilidad.</p>
<p>Todos los términos en las ecuaciones (1) y (2) son necesarios. Excepto por la prevalencia, todos los demás términos están asociados con la prueba diagnóstica en sí. Los médicos juzgan la prevalencia probable (probabilidad pre-prueba) de la enfermedad en cuestión (para un grupo de pacientes con características similares al paciente particular que tienen delante) y aplican la sensibilidad y especificidad conocidas de la prueba diagnóstica (de estudios de investigación) para obtener la probabilidad post-prueba del paciente particular de tener la enfermedad en cuestión.</p>
<p>Los intervalos de confianza para la sensibilidad, la especificidad y los valores predictivos se pueden calcular mediante los métodos habituales para proporciones binomiales. A menudo, los métodos basados en la aproximación normal a la distribución binomial (por ejemplo, IC del 95%: p <span class="math inline">\(\pm\)</span> 1.96 <span class="math inline">\(\sqrt{(pq/N)}\)</span>) serán inexactos debido a su simetría, y los métodos exactos u otras aproximaciones serán mejores, como por ejemplo <code>binom.test</code> y <code>fisher.test</code> en R.</p>
<p><strong>LEER:</strong> Altman &amp; Bland. Pruebas diagnósticas 2: valores predictivos <span class="citation" data-cites="altman1994predictive">[<a href="#ref-altman1994predictive" role="doc-biblioref">4</a>]</span></p>
</section>
<section id="las-razones-de-verosimilitud-rv" class="level3" data-number="1.2.5">
<h3 data-number="1.2.5" class="anchored" data-anchor-id="las-razones-de-verosimilitud-rv"><span class="header-section-number">1.2.5</span> Las Razones de Verosimilitud (RV)</h3>
<p>La razón de verosimilitud (RV), junto con la sensibilidad y la especificidad, puede considerarse una propiedad de la propia prueba que no cambia con la prevalencia de la enfermedad.</p>
<p>En nuestro ejemplo, RV+ = 2.756, lo que significa que un resultado positivo en la mamografía digital es aproximadamente 2.8 veces más probable de ser un verdadero positivo que un falso positivo.</p>
<p>De manera similar, RV- = 0.034, lo que significa que un resultado negativo en la mamografía digital es aproximadamente 0.034 veces más probable de ser un falso negativo que un verdadero negativo. Esto también puede interpretarse como: una mujer sin cáncer de mama tiene aproximadamente 29.4 (= 1/0.034) veces más probabilidades de tener un resultado negativo en la mamografía digital que una mujer con cáncer de mama.</p>
<p>En la práctica clínica, una RV+ más alta es deseable para las pruebas utilizadas para “confirmar” una enfermedad, mientras que una RV- más baja es preferible para las pruebas utilizadas para “descartar” la posibilidad de que el individuo tenga la enfermedad.</p>
</section>
<section id="aplicación-de-las-rv-revisando-la-probabilidad-de-enfermedad" class="level3" data-number="1.2.6">
<h3 data-number="1.2.6" class="anchored" data-anchor-id="aplicación-de-las-rv-revisando-la-probabilidad-de-enfermedad"><span class="header-section-number">1.2.6</span> Aplicación de las RV (revisando la probabilidad de enfermedad)</h3>
<p>Primero necesitamos recordar la definición de <em>odds</em>.</p>
<p><em>Odds</em> es una razón de probabilidades. Para ser coherentes con la primera sección, sea D+ el evento de que un paciente tiene una enfermedad particular y T el resultado de la prueba (puede ser T+ o T-). La probabilidad de que el paciente tenga la enfermedad es P(D+) y de no tener la enfermedad es P(D-). Entonces, el <em>odds</em> a favor de la enfermedad es la razón de la probabilidad de tener la enfermedad a la probabilidad de no tener la enfermedad</p>
<p><span class="math inline">\(Odds\)</span> a favor de la enfermedad = <span class="math inline">\(P(D+) / P(D-)\)</span>.</p>
<p>A diferencia de la probabilidad, el <em>odds</em> no necesita estar entre 0 y 1. Puede ser cualquier número no negativo.</p>
<p>La razón de verosimilitud es una razón de probabilidades condicionales de tener los resultados de la prueba (condicionadas a los escenarios de tener la enfermedad y no tener la enfermedad), una forma alternativa de evaluar el rendimiento de una prueba diagnóstica.</p>
<p>Si P(D+) es la probabilidad previa, entonces el <em>odds</em> definido anteriormente es el <em>odds</em> previo. De manera similar, la razón de probabilidades posteriores se denomina <em>odds</em> posterior. A partir de este punto, omitiremos la frase “a favor de la enfermedad”. A menos que se indique lo contrario, el <em>odds</em> se refiere al <em>odds</em> a favor de la enfermedad.</p>
<p><span class="math inline">\(\text{odds posterior = odds previo} \times \text{razón de verosimilitud}\)</span>.</p>
<p>La razón por la que agregamos deliberadamente el concepto de razón de verosimilitud es para relacionar directamente la sensibilidad y la especificidad con el <em>odds</em> posterior, a partir del cual se puede calcular la probabilidad posterior. La razón de verosimilitud modifica el <em>odds</em> previo en <em>odds</em> posterior. La cantidad en que cambiarán los <em>odds</em> depende de la precisión (sensibilidad y especificidad) de la prueba.</p>
<p>Si T es positivo, entonces,</p>
<p><span class="math inline">\(RV+ = \frac{P(T+ | D+)}{P(T+ | D-)} = \frac{Sensibilidad}{1 - Especificidad}\)</span>.</p>
<p>Esto evalúa cuánto más probable es que ocurra un resultado positivo en una persona con la enfermedad que en una persona sin la enfermedad.</p>
<p>Si T es negativo, entonces,</p>
<p><span class="math inline">\(RV- = \frac{P(T- | D+)}{P(T- | D-)} = \frac{1 - Sensibilidad}{Especificidad}\)</span>.</p>
<p>Evalúa cuánto más probable es que ocurra un resultado negativo en una persona sin la enfermedad que en una persona con la enfermedad.</p>
<p>Una vez que conocemos el <em>odds</em> previo, la calidad de la prueba y el resultado de la prueba, el <em>odds</em> posterior se puede obtener de la ecuación anterior, y por lo tanto se puede estimar la probabilidad posterior.</p>
<p>Las razones de verosimilitud positivas (RV+) corresponden a las pendientes de la curva ROC (se discutirá a continuación). La pendiente de la curva ROC representa el cambio en la sensibilidad por un cambio infinitesimal en el porcentaje de falsos positivos.</p>
</section>
<section id="probabilidad-post-prueba-y-el-nomograma-de-fagan" class="level3" data-number="1.2.7">
<h3 data-number="1.2.7" class="anchored" data-anchor-id="probabilidad-post-prueba-y-el-nomograma-de-fagan"><span class="header-section-number">1.2.7</span> Probabilidad post-prueba y el Nomograma de Fagan</h3>
<p>El Nomograma de Fagan es una herramienta gráfica que utiliza las razones de verosimilitud para estimar la probabilidad post-prueba de una enfermedad dada una probabilidad pre-prueba y el resultado de una prueba diagnóstica. Fue desarrollado por el Dr.&nbsp;Terry Fagan en la década de 1970 y es ampliamente utilizado en medicina clínica para ayudar a los médicos a interpretar los resultados de las pruebas diagnósticas. Para calcular la probabilidad post-prueba sin utilizar el teorema de Bayes directamente, podemos usar el Nomograma de Fagan. El nomograma de Fagan nos permite convertir las probabilidades pre-prueba en probabilidades post-prueba sin necesidad de usar <em>odds</em>.</p>
<p>El <em>odds</em> pre-prueba se computa a partir de la probabilidad pre-prueba (prevalencia) utilizando la fórmula: <span class="math inline">\(odds \ pre \text{-} prueba = \frac{probabilidad \ pre \text{-} prueba}{1 - probabilidad \ pre \text{-} prueba}\)</span></p>
<p>El <em>odds</em> pre-prueba de un diagnóstico particular, multiplicado por la razón de verosimilitud de la prueba diagnóstica, determina el <em>odds</em> post-prueba.</p>
<p>Por lo tanto, <span class="math inline">\(odds \ post \text{-} prueba = RV \times odds \ pre \text{-} prueba\)</span></p>
<p>El <em>odds</em> post-prueba proporcionan una estimación actualizada del <em>odds</em> de que el paciente tenga la condición o enfermedad después de tener en cuenta el resultado de la prueba diagnóstica. Si el resultado de la prueba es positivo, usamos la RV+ para este cálculo. Si el resultado de la prueba es negativo, usamos la RV- en su lugar. En ambos escenarios, el <em>odds</em> se refiere al <em>odds</em> a favor de que la enfermedad <strong>esté presente</strong>.</p>
<p>La probabilidad post-prueba se puede derivar del <em>odds</em> post-prueba utilizando la fórmula: <span class="math inline">\(probabilidad \ post \text{-} prueba = \frac{odds \ post \text{-} prueba}{odds \ post \text{-} prueba + 1}\)</span></p>
<p>La RV se utiliza comúnmente en la toma de decisiones basada en el Teorema de Bayes. La RV+ nos dice cuánto aumentan los <em>odds</em> de que la condición o enfermedad esté presente dado un resultado positivo en la prueba.</p>
<ul>
<li><p>RV+ mayor que 1: Aumenta los <em>odds</em> post-prueba.</p></li>
<li><p>RV+ de 1: No hay cambio en los <em>odds</em> post-prueba (los <em>odds</em> post-prueba son iguales a los <em>odds</em> pre-prueba).</p></li>
</ul>
<p>El nomograma suele consistir en tres escalas paralelas que representan la probabilidad pre-prueba, la razón de verosimilitud y la probabilidad post-prueba. Podemos estimar visualmente la probabilidad post-prueba de un resultado de diagnóstico positivo trazando una línea desde la probabilidad pre-prueba conocida, a través de la RV+ y leyendo la probabilidad post-prueba.</p>
<p>Supongamos que la prevalencia (probabilidad pre-prueba) de cáncer de mama en una población específica de mujeres mayores de 40 años es del 74.6%. ¿Cuál es la probabilidad post-prueba de cáncer de mama para esta población cuando la mamografía digital es <strong>positiva</strong>?</p>
<p><strong>En R:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fagan.plot</span>(<span class="at">probs.pre.test =</span> <span class="fl">0.746</span>, <span class="at">LR =</span> <span class="fl">2.756</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-nomogram1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nomogram1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="TEMA-1_files/figure-html/fig-nomogram1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nomogram1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1: El impacto de un resultado positivo de mamografía digital con una RV+ de 2.76 en la probabilidad post-prueba de una paciente para cáncer de mama, partiendo de una probabilidad pre-prueba inicial del 78% en el Nomograma de Fagan.
</figcaption>
</figure>
</div>
</div>
</div>
<p>La RV- nos dice cuánto disminuyen los <em>odds</em> de que la condición o enfermedad esté presente dado un resultado negativo en la prueba.</p>
<ul>
<li><p>RV- menor que 1: Disminuye los <em>odds</em> post-prueba.</p></li>
<li><p>RV- de 1: No hay cambio en la probabilidad (los <em>odds</em> post-prueba son iguales a los <em>odds</em> pre-prueba).</p></li>
</ul>
<p>¿Cuál es la probabilidad post-prueba de cáncer de mama para la misma población cuando la mamografía digital es <strong>negativa</strong>?</p>
<p><span class="math inline">\(odds \ post \text{-} prueba = RV\text{-} \times odds \ pre \text{-} prueba = 0.034 \times 3.55 = 0.1207\)</span><br>
La odds post prueba es 0.1207. Para convertir esto en probabilidad post-prueba, usamos la fórmula que se deriva facilmente de la definición de <em>odds</em>: <span class="math inline">\(odds = \frac{probabilidad}{1 - probabilidad}\)</span>, entonces <span class="math inline">\(probabilidad = \frac{odds}{odds + 1}\)</span></p>
<p><span class="math inline">\(probabilidad \ post \text{-} prueba = \frac{odds \ post \text{-} prueba}{odds \ post \text{-} prueba + 1} = \frac{0.1207}{0.1207 + 1} = \frac{0.1207}{1.1207} = 0.1077 \ o \ 10.77%\)</span></p>
<p><strong>En R:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fagan.plot</span>(<span class="at">probs.pre.test =</span> <span class="fl">0.746</span>, <span class="at">LR =</span> <span class="fl">0.034</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-nomogram2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nomogram2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="TEMA-1_files/figure-html/fig-nomogram2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nomogram2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.2: El impacto de un resultado negativo de mamografía digital con una RV- de 0.034 en la probabilidad post-prueba de una paciente para cáncer de mama, partiendo de una probabilidad pre-prueba inicial del 74.6% en el Nomograma de Fagan.
</figcaption>
</figure>
</div>
</div>
</div>
<p>También podemos usar las funciones <code>epi.nomogram()</code> y <code>nomogrammer()</code> que nos permiten calcular la probabilidad post-prueba y trazar nomogramas de Fagan con <code>{ggplot2}</code>, respectivamente:</p>
<div class="cell" data-warnening="false">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.nomogram</span>(<span class="at">se =</span> <span class="cn">NA</span>, </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">sp =</span> <span class="cn">NA</span>, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">lr =</span> <span class="fu">c</span>(<span class="fl">2.756</span>, <span class="fl">0.034</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">pre.pos =</span> <span class="fl">0.746</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Given a positive test result, the post-test probability of being outcome positive is 0.89 
Given a negative test result, the post-test probability of being outcome positive is 0.09 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nomogrammer es una función de R que crea un nomograma de Fagan</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"nomogrammer.r"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nomogrammer</span>(<span class="at">Prevalence =</span> <span class="fl">0.746</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">Plr =</span> <span class="fl">2.756</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">Nlr =</span> <span class="fl">0.034</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">Detail =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">NullLine =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-slope" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-slope-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="TEMA-1_files/figure-html/fig-slope-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-slope-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.3: El impacto de un resultado positivo (línea azul) y negativo (línea roja) de mamografía digital con una RV+ de 2.756 y una RV- de 0.034 en la probabilidad post-prueba de una paciente para cáncer de mama, respectivamente, partiendo de una probabilidad pre-prueba inicial del 74.6% en el Nomograma de Fagan. La línea gris discontinua que va desde la probabilidad previa a través de RV = 1 ilustra la probabilidad posterior si se mantuviera sin cambios.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="receiver-operating-characteristic-roc-curve" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="receiver-operating-characteristic-roc-curve"><span class="header-section-number">1.3</span> Receiver Operating Characteristic (ROC) curve</h2>
<p>Cuando el resultado de una prueba diagnóstica se mide en una <strong>escala continua</strong>, la sensibilidad y la especificidad varían con diferentes puntos de corte (umbrales). Por lo tanto, debe seleccionarse un punto de corte <strong>conveniente</strong> para calcular las medidas de precisión diagnóstica de la prueba. El análisis de la curva de la <strong>característica operativa del receptor</strong> (ROC) puede utilizarse para ayudar en esta decisión <span class="citation" data-cites="practicalstats">[<a href="#ref-practicalstats" role="doc-biblioref">2</a>]</span>.</p>
<p>Puede encontrar los siguientes sitios web útiles al estudiar las curvas ROC:</p>
<p>-<a href="http://www.anaesthetist.com/mnm/stats/roc/Findex.htm" class="uri">http://www.anaesthetist.com/mnm/stats/roc/Findex.htm</a><br>
-<a href="http://gim.unmc.edu/dxtests/Default.htm" class="uri">http://gim.unmc.edu/dxtests/Default.htm</a></p>
<p>Es deseable que una prueba diagnóstica tenga <strong>alta sensibilidad</strong> y también <strong>alta especificidad</strong>. En otras palabras, nos gustaría que el resultado de la prueba se acercara lo más posible a lo ideal: un resultado positivo significa “enfermo” y un resultado negativo significa “no enfermo”. Desafortunadamente, existe una <strong>compensación entre sensibilidad y especificidad</strong>: a medida que la sensibilidad aumenta, la especificidad disminuye, y viceversa. La relación entre sensibilidad y especificidad en una prueba diagnóstica es análoga a la relación entre el error tipo I y el error tipo II en las pruebas de hipótesis.</p>
<p>Una <strong>curva ROC</strong> es una representación gráfica que muestra la capacidad diagnóstica de una prueba, o sistema de clasificación binaria, al variar su umbral de discriminación. La curva traza la <strong>Tasa de Verdaderos Positivos (TVP)</strong> frente a la <strong>Tasa de Falsos Positivos (TFP)</strong> en distintos umbrales. La TVP también se conoce como <strong>sensibilidad</strong>, y la TFP se calcula como 1 - <strong>especificidad</strong>.</p>
<ul>
<li><p><strong>Sensibilidad (TVP)</strong>: La proporción de casos positivos reales que son correctamente identificados.</p>
<p><span class="math display">\[Sensibilidad = \frac{Verdaderos\;Positivos}{Verdaderos\;Positivos + Falsos\;Negativos}\]</span></p></li>
<li><p><strong>Especificidad</strong>: La proporción de casos negativos reales que son correctamente identificados.</p>
<p><span class="math display">\[Especificidad = \frac{Verdaderos\;Negativos}{Verdaderos\;Negativos + Falsos\;Positivos}\]</span></p></li>
<li><p><strong>Tasa de Falsos Positivos (TFP)</strong>: La proporción de casos negativos reales que son incorrectamente identificados como positivos.</p>
<p><span class="math display">\[TFP = 1 - Especificidad = \frac{Falsos\;Positivos}{Verdaderos\;Negativos + Falsos\;Positivos}\]</span></p></li>
</ul>
<section id="cómo-se-construye" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="cómo-se-construye"><span class="header-section-number">1.3.1</span> ¿Cómo se construye?</h3>
<ol type="1">
<li>Una prueba diagnóstica continua proporciona una puntuación numérica. Para cada valor de puntuación posible, se establece un <strong>umbral</strong>.</li>
<li>Los puntos de datos con puntuaciones por encima del umbral se clasifican como “positivos”, y aquellos por debajo se clasifican como “negativos”.</li>
<li>Para cada umbral, se calculan la <strong>sensibilidad</strong> y la <strong>especificidad</strong> (y por lo tanto, la TFP).</li>
<li>Estos pares (TFP, Sensibilidad) se grafican. Una curva continua se forma al conectar estos puntos.</li>
</ol>
<p>Una prueba perfecta tendría un punto en la esquina superior izquierda del gráfico, con una sensibilidad de 1 y una TFP de 0. Esto significa que tiene una tasa de verdaderos positivos del 100% y una tasa de falsos positivos del 0%. Una prueba inútil seguiría la línea diagonal de (0,0) a (1,1), lo que significa que su capacidad para distinguir entre casos positivos y negativos no es mejor que el azar.</p>
</section>
<section id="interpretación-del-auc" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="interpretación-del-auc"><span class="header-section-number">1.3.2</span> Interpretación del AUC</h3>
<p>El <strong>AUC</strong> (<em>Area Under the Curve</em> o Área Bajo la Curva) es un valor escalar único que representa el rendimiento diagnóstico general de una prueba. Es el área debajo de la curva ROC, con un rango de 0 a 1. Un valor de AUC más alto indica una prueba con mejor rendimiento.</p>
<ul>
<li><strong>AUC = 1.0</strong>: Prueba perfecta. Distingue perfectamente entre casos positivos y negativos.</li>
<li><strong>AUC <span class="math inline">\(\ge\)</span> 0.9</strong>: Prueba <strong>excelente</strong>. Muy precisa en sus predicciones.</li>
<li><strong>0.8 <span class="math inline">\(\le\)</span> AUC &lt; 0.9</strong>: Prueba <strong>buena</strong>. Generalmente considerada una herramienta diagnóstica útil y confiable.</li>
<li><strong>0.7 <span class="math inline">\(\le\)</span> AUC &lt; 0.8</strong>: Prueba <strong>aceptable/regular</strong>. Tiene algún valor diagnóstico, pero con una mayor probabilidad de errores de clasificación.</li>
<li><strong>0.6 <span class="math inline">\(\le\)</span> AUC &lt; 0.7</strong>: Prueba <strong>deficiente</strong>. Valor diagnóstico limitado.</li>
<li><strong>AUC = 0.5</strong>: Prueba <strong>inútil</strong>. Las predicciones no son mejores que el azar (como lanzar una moneda).</li>
</ul>
<p>El <strong>área bajo la curva ROC</strong> mide la <strong>discriminación</strong>, es decir, la capacidad de la prueba para clasificar correctamente a aquellos con y sin la enfermedad. Supongamos que conocemos el estado de cada paciente con respecto a la enfermedad. El área bajo una curva ROC es la <strong>proporción de pares de pacientes seleccionados aleatoriamente (uno enfermo, uno no enfermo) que son correctamente clasificados (ordenados) por la prueba</strong>. El área bajo la curva ROC es una medida global de la <strong>precisión de la prueba</strong>. Alternativamente, el área bajo la curva ROC puede interpretarse como la <strong>sensibilidad promedio en todas las posibles especificidades</strong>.</p>
<p>Las curvas ROC se utilizan en muchas otras situaciones además de las pruebas de diagnóstico clínico; una de ellas es la evaluación de la adecuación de un modelo de regresión logística, por ejemplo. Existen muchas herramientas de software para el análisis ROC, utilizando lenguajes de una variedad de áreas de contenido. Los métodos habituales para las pruebas de diagnóstico clínico se basan en el artículo clásico: <em>Hanley JA, McNeil BJ. The meaning and use of the area under the receiver operating characteristic (ROC) curve. Radiology 1982; 143: 29-36</em> <span class="citation" data-cites="hanley1982">[<a href="#ref-hanley1982" role="doc-biblioref">7</a>]</span>.</p>
</section>
<section id="encontrar-un-punto-de-corte-apropiado" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="encontrar-un-punto-de-corte-apropiado"><span class="header-section-number">1.3.3</span> Encontrar un Punto de Corte Apropiado</h3>
<p>El punto más cercano a la esquina superior izquierda de la curva ROC a veces se elige como punto de corte porque <strong>optimiza la sensibilidad y la especificidad</strong>. Sin embargo, la tarea de encontrar un punto de corte apropiado a veces es más complicada y requiere <strong>juicio clínico</strong>. Deben tenerse en cuenta factores como el costo y el beneficio. Por ejemplo, cuando el costo de un resultado falso positivo es alto (como una cirugía innecesaria), queremos que la prueba sea más <strong>específica</strong> (alta especificidad); cuando la situación se invierte, queremos que la prueba sea más <strong>sensible</strong> (alta sensibilidad).</p>
<p>El <strong>índice de Youden</strong> es una métrica comúnmente utilizada para encontrar el punto de corte óptimo en una curva ROC. Se define como: <span class="math display">\[J = Sensibilidad + Especificidad - 1\]</span> El índice de Youden varía entre 0 y 1, donde 1 indica una prueba perfecta (sensibilidad y especificidad ambas iguales a 1), y 0 indica una prueba que no tiene valor diagnóstico (sensibilidad y especificidad ambas iguales a 0.5). El punto de corte que maximiza el índice de Youden es a menudo considerado como el punto óptimo, ya que equilibra la sensibilidad y la especificidad.</p>
<p>El paquete <strong>pROC</strong> en R proporciona una función conveniente <code>coords()</code> para encontrar el punto de corte óptimo basado en varios criterios, incluido el índice de Youden. En R puedes usar el siguiente código para encontrar el punto de corte óptimo:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># para reproducibilidad</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Simulación de datos</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Estado real de los sujetos (0 = control, 1 = caso)</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>true_status <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Puntuaciones para la prueba diagnóstica</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Los casos (true_status = 1) tienen puntuaciones más altas en promedio</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="fu">ifelse</span>(true_status <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Creación y cálculo de la curva ROC</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 'roc' crea el objeto de la curva ROC</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(true_status, scores)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Visualización y análisis</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar la curva ROC con un título más descriptivo</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj,</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Curva ROC para la prueba diagnóstica"</span>,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Tasa de Falsos Positivos (1 - Especificidad)"</span>,</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Tasa de Verdaderos Positivos (Sensibilidad)"</span>,</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"blue"</span>, <span class="co"># Color de la línea</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>) <span class="co"># Grosor de la línea</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular y mostrar el valor del Área Bajo la Curva (AUC)</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>auc_value <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_obj)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_value, <span class="dv">2</span>)),</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">"n"</span>, <span class="co"># Sin caja alrededor de la leyenda</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Encontrar y graficar el punto de corte óptimo</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Encontrar las coordenadas del punto de corte óptimo usando el índice de Youden</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>optimal_coords <span class="ot">&lt;-</span> <span class="fu">coords</span>(roc_obj, <span class="st">"best"</span>, <span class="at">ret =</span> <span class="fu">c</span>(<span class="st">"specificity"</span>, <span class="st">"sensitivity"</span>, <span class="st">"threshold"</span>), <span class="at">best.method =</span> <span class="st">"youden"</span>)</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>optimal_specificity <span class="ot">&lt;-</span> optimal_coords[<span class="st">"specificity"</span>]</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>optimal_sensitivity <span class="ot">&lt;-</span> optimal_coords[<span class="st">"sensitivity"</span>]</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>optimal_threshold <span class="ot">&lt;-</span> optimal_coords[<span class="st">"threshold"</span>]</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar el punto óptimo en la curva</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> optimal_specificity, <span class="at">y =</span> optimal_sensitivity, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Añadir una etiqueta al punto óptimo</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> optimal_specificity <span class="sc">+</span> <span class="fl">0.1</span>, <span class="at">y =</span> optimal_sensitivity,</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"Umbral óptimo:"</span>, <span class="fu">round</span>(optimal_threshold, <span class="dv">2</span>)),</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">4</span>, <span class="co"># Posición del texto (a la derecha)</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"red"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TEMA-1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los valores del punto de corte óptimo</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Valores del punto de corte óptimo (índice de Youden):"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Valores del punto de corte óptimo (índice de Youden):"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(optimal_coords)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  specificity sensitivity threshold
1   0.6226415   0.7234043 0.2738415</code></pre>
</div>
</div>
</section>
</section>
<section id="comparación-de-dos-pruebas-diagnósticas" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="comparación-de-dos-pruebas-diagnósticas"><span class="header-section-number">1.4</span> Comparación de Dos Pruebas Diagnósticas</h2>
<p>La <strong>prueba de DeLong</strong> es una prueba no paramétrica ampliamente utilizada para comparar el <strong>Área Bajo la Curva (AUC)</strong> de dos o más curvas ROC (Receiver Operating Characteristic) correlacionadas. Es particularmente valiosa cuando tienes, por ejemplo, múltiples pruebas de diagnóstico aplicadas al mismo conjunto de pacientes y quieres ver si el rendimiento de una prueba (medido por el AUC) es significativamente mejor que el de otra. El paquete <strong>pROC</strong> proporciona una implementación conveniente de la prueba de DeLong <span class="citation" data-cites="delong1988">[<a href="#ref-delong1988" role="doc-biblioref">8</a>]</span>.</p>
<section id="base-matemática-de-la-prueba-de-delong" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="base-matemática-de-la-prueba-de-delong"><span class="header-section-number">1.4.1</span> Base matemática de la prueba de DeLong</h3>
<p>La prueba de De Long se basa en la <strong>teoría de las U-estadísticas</strong>. Esencialmente, calcula la covarianza entre los AUC empíricos de dos (o más) curvas ROC. Esta covarianza es crucial porque al comparar curvas ROC correlacionadas (por ejemplo, de los mismos sujetos), se viola el supuesto de independencia requerido por pruebas más simples.<a href="https://www.jstor.org/stable/2531595" class="uri">https://www.jstor.org/stable/2531595</a></p>
<p>Aquí tienes un resumen simplificado de las ideas matemáticas clave:</p>
<ol type="1">
<li><strong>AUC como U-estadística:</strong> El AUC puede expresarse como una U-estadística. Para una sola curva ROC generada a partir de un conjunto de <span class="math inline">\(n\)</span> sujetos enfermos (casos) y <span class="math inline">\(m\)</span> sujetos no enfermos (controles), el AUC es una medida de la probabilidad de que un sujeto enfermo elegido al azar tenga una puntuación de prueba más alta que un sujeto no enfermo elegido al azar.</li>
</ol>
<p>Sean <span class="math inline">\(X_i\)</span> las puntuaciones de la prueba para sujetos no enfermos (<span class="math inline">\(i=1, \dots, n\)</span>) y <span class="math inline">\(Y_j\)</span> las puntuaciones de la prueba para sujetos enfermos (<span class="math inline">\(j=1, \dots, m\)</span>).</p>
<p>El AUC empírico, a menudo calculado usando la regla trapezoidal, puede expresarse formalmente en términos de pares de observaciones:</p>
<p><span class="math display">\[\text{AUC} = \frac{1}{nm} \sum_{i=1}^{n} \sum_{j=1}^{m} \mathbb{I}(Y_j &gt; X_i) + \frac{1}{2nm} \sum_{i=1}^{n} \sum_{j=1}^{m} \mathbb{I}(Y_j = X_i)
\]</span> donde <span class="math inline">\(\mathbb{I}(\cdot)\)</span> es la función indicadora (1 si la condición es verdadera, 0 en caso contrario), <span class="math inline">\(n\)</span> es el número de sujetos no enfermos, <span class="math inline">\(m\)</span> es el número de sujetos enfermos, <span class="math inline">\(X_i\)</span> son las puntuaciones para los sujetos no enfermos, y <span class="math inline">\(Y_j\)</span> son las puntuaciones para los sujetos enfermos. Esta fórmula refleja la idea de que por cada par de sujeto enfermo y no enfermo, contamos si la puntuación del sujeto enfermo es mayor (contribuyendo 1), igual (contribuyendo 0.5) o menor (contribuyendo 0).</p>
<p>Es decir, el AUC es la proporción de veces que una puntuación de un sujeto enfermo es mayor que la de un sujeto no enfermo, más la mitad de las veces que son iguales. Es importante destacar que es una U-estadística porque se basa en todas las combinaciones posibles de pares (sujeto enfermo, sujeto no enfermo).</p>
<p>Específicamente, la suma doble recorre todos los pares posibles, y cada par contribuye a la estadística según si el sujeto enfermo tiene una puntuación mayor, igual o menor que el sujeto no enfermo. Es decir, es una estadística basada en rangos. Esencialmente, es una medida de ordenamiento entre dos grupos. Es por eso que el AUC es insensible a las transformaciones monotónicas de las puntuaciones de la prueba.</p>
<p>Es importante destacar que es una U-estadística porque se basa en todas las combinaciones posibles de pares (sujeto enfermo, sujeto no enfermo). Específicamente, la suma doble recorre todos los pares posibles, y cada par contribuye a la estadística según si el sujeto enfermo tiene una puntuación mayor, igual o menor que el sujeto no enfermo. Es decir, es una estadística basada en rangos. Esencialmente, es una medida de ordenamiento entre dos grupos. Es por eso que el AUC es insensible a las transformaciones monotónicas de las puntuaciones de la prueba.</p>
<ol start="2" type="1">
<li><strong>Varianza y covarianza de los AUC:</strong> El método de DeLong proporciona una forma de estimar la varianza de un solo AUC y, lo que es más importante, la <strong>covarianza entre dos AUC correlacionados</strong>. Aquí es donde entra en juego la teoría de las U-estadísticas. La varianza de una U-estadística se puede estimar de manera eficiente, y esta estimación se puede extender a la covarianza entre dos U-estadísticas que comparten datos comunes.</li>
</ol>
<p>El núcleo de la prueba de DeLong implica calcular los componentes estructurales de las U-estadísticas, que son esencialmente medidas de cómo cada observación individual contribuye al AUC general. Estos componentes se utilizan luego para construir la matriz de varianza-covarianza de los AUC.</p>
<p>Para dos curvas ROC, por ejemplo, ROC1 y ROC2, con AUCs <span class="math inline">\(AUC_1\)</span> y <span class="math inline">\(AUC_2\)</span>, la prueba de De Long tiene como objetivo calcular la varianza de su diferencia:</p>
<p><span class="math display">\[\text{Var}(AUC_1 - AUC_2) = \text{Var}(AUC_1) + \text{Var}(AUC_2) - 2 \cdot \text{Cov}(AUC_1, AUC_2)\]</span></p>
<p>El artículo de DeLong proporciona las fórmulas específicas para estimar <span class="math inline">\(\text{Var}(AUC_1)\)</span>, <span class="math inline">\(\text{Var}(AUC_2)\)</span> y <span class="math inline">\(\text{Cov}(AUC_1, AUC_2)\)</span> basadas en los rangos de las observaciones. Esto implica definir valores de “colocación” específicos para cada observación que reflejan su contribución al AUC.</p>
<ol start="3" type="1">
<li><strong>Estadístico Z y valor p:</strong> Una vez que se estima <span class="math inline">\(\text{Var}(AUC_1 - AUC_2)\)</span>, se calcula un estadístico Z:</li>
</ol>
<p><span class="math display">\[
Z = \frac{AUC_1 - AUC_2}{\sqrt{\text{Var}(AUC_1 - AUC_2)}}
\]</span></p>
<p>Bajo la hipótesis nula de que no hay diferencia entre los AUC verdaderos (<span class="math inline">\(AUC_1 = AUC_2\)</span>), el estadístico Z sigue aproximadamente una distribución normal estándar. Este estadístico Z se usa luego para calcular un valor p, que indica la probabilidad de observar una diferencia tan extrema, o más extrema, como la observada, asumiendo que la hipótesis nula es verdadera. En el contexto de la prueba de De Long, las hipótesis se establecen de la siguiente manera:</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: no hay diferencia entre dos AUC (<span class="math inline">\(AUC_{A} = AUC_{B}\)</span>)</li>
<li><span class="math inline">\(H_1\)</span>: hay diferencia entre dos AUC (<span class="math inline">\(AUC_{A} \neq AUC_{B}\)</span>)</li>
</ul>
<p>En R, la función <code>roc.test()</code> del paquete <code>pROC</code> implementa la prueba de DeLong de manera eficiente, manejando todos los cálculos de varianza y covarianza internamente. Simplemente proporcionas dos objetos ROC (creados con la función <code>roc()</code>) y especificas el método como “Delong”.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># para reproducibilidad</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estado real (0 = control, 1 = caso)</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>true_status <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">200</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Puntuaciones para dos pruebas de diagnóstico (Modelo A y Modelo B)</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># El Modelo A es ligeramente mejor que el Modelo B</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>scores_A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="at">mean =</span> <span class="fu">ifelse</span>(true_status <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>scores_B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="at">mean =</span> <span class="fu">ifelse</span>(true_status <span class="sc">==</span> <span class="dv">1</span>, <span class="fl">0.8</span>, <span class="dv">0</span>), <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear objetos ROC</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>roc_A <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> true_status, <span class="at">predictor =</span> scores_A, <span class="at">ci =</span> <span class="cn">TRUE</span>, <span class="at">of =</span> <span class="st">"auc"</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>roc_B <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> true_status, <span class="at">predictor =</span> scores_B, <span class="at">ci =</span> <span class="cn">TRUE</span>, <span class="at">of =</span> <span class="st">"auc"</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Imprimir AUCs y sus intervalos de confianza</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(roc_A)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
roc.default(response = true_status, predictor = scores_A, ci = TRUE,     of = "auc")

Data: scores_A in 103 controls (true_status 0) &lt; 97 cases (true_status 1).
Area under the curve: 0.751
95% CI: 0.6833-0.8187 (DeLong)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(roc_B)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
roc.default(response = true_status, predictor = scores_B, ci = TRUE,     of = "auc")

Data: scores_B in 103 controls (true_status 0) &lt; 97 cases (true_status 1).
Area under the curve: 0.6619
95% CI: 0.5867-0.7371 (DeLong)</code></pre>
</div>
</div>
</section>
<section id="realizando-la-prueba-de-de-long" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="realizando-la-prueba-de-de-long"><span class="header-section-number">1.4.2</span> Realizando la prueba de De Long</h3>
<p>Ahora, usamos la función <code>roc.test()</code> del paquete <code>pROC</code> con <code>method = "delong"</code> y <code>paired = TRUE</code> (ya que nuestros datos son de los mismos sujetos).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("pROC")</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>delong_result <span class="ot">&lt;-</span> <span class="fu">roc.test</span>(roc_A, roc_B, <span class="at">method =</span> <span class="st">"delong"</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Imprimir el resultado de la prueba</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(delong_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DeLong's test for two correlated ROC curves

data:  roc_A and roc_B
Z = 1.7734, p-value = 0.07616
alternative hypothesis: true difference in AUC is not equal to 0
95 percent confidence interval:
 -0.009370521  0.187530866
sample estimates:
AUC of roc1 AUC of roc2 
  0.7509759   0.6618957 </code></pre>
</div>
</div>
</section>
<section id="interpretando-los-resultados" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="interpretando-los-resultados"><span class="header-section-number">1.4.3</span> Interpretando los resultados</h3>
<p>La salida de la función <code>roc.test()</code> proporciona:</p>
<ul>
<li><strong>Estadístico Z:</strong> Este es el estadístico de prueba calculado.</li>
<li><strong>Valor p:</strong> La probabilidad de observar tal diferencia (o más extrema) en los AUC si no hubiera una verdadera diferencia entre los modelos. Un valor p pequeño (típicamente &lt; 0.05) indica una diferencia estadísticamente significativa.</li>
<li><strong>Hipótesis alternativa:</strong> Especifica la hipótesis que se está probando (por ejemplo, “la verdadera diferencia en AUC no es igual a 0”).</li>
<li><strong>Estimaciones de la muestra:</strong> Los valores de AUC para cada curva ROC.</li>
</ul>
<p>En nuestro ejemplo, el valor p de 0.07616 sugiere ninguna diferencia estadísticamente significativa entre el AUC del Modelo A y el Modelo B a un nivel de significanción de 0.05.</p>
<p>A menudo es útil visualizar las curvas ROC junto con la prueba estadística.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_A, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">main =</span> <span class="st">"Comparación de Curvas ROC"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(roc_B, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">"Modelo A (AUC ="</span>, <span class="fu">round</span>(roc_A<span class="sc">$</span>auc, <span class="dv">3</span>), <span class="st">")"</span>),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste</span>(<span class="st">"Modelo B (AUC ="</span>, <span class="fu">round</span>(roc_B<span class="sc">$</span>auc, <span class="dv">3</span>), <span class="st">")"</span>)),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TEMA-1_files/figure-html/plot_roc-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Esta visualización ayuda a comprender intuitivamente el rendimiento de los modelos que se comparan mediante la prueba de De Long.</p>
</section>
<section id="ejemplo-comparación-de-dos-cuestionarios-de-cribado-de-epoc-usando-la-prueba-de-delong" class="level3" data-number="1.4.4">
<h3 data-number="1.4.4" class="anchored" data-anchor-id="ejemplo-comparación-de-dos-cuestionarios-de-cribado-de-epoc-usando-la-prueba-de-delong"><span class="header-section-number">1.4.4</span> Ejemplo: Comparación de dos cuestionarios de cribado de EPOC usando la prueba de DeLong</h3>
<p>Queremos comparar dos cuestionarios de cribado para la <strong>enfermedad pulmonar obstructiva crónica (EPOC)</strong> en fumadores mayores de 45 años en el ámbito de la atención primaria:</p>
<ul>
<li>Cuestionario <em>International Primary Care Airways Group (IPAG)</em> (Puntuación: 0-38)</li>
<li>Cuestionario <em>COPD Population Screener (COPDPS)</em> (Puntuación: 0-10)</li>
</ul>
<p>Cada participante recibió ambos cuestionarios (diseño ‘completamente emparejado’). El diagnóstico de EPOC se basó en el criterio espirométrico (FEV1/FVC &lt; 0.7 tras broncodilatación), el estado clínico (historia médica, síntomas y examen físico) y la exclusión de otras enfermedades.</p>
<p>Necesitamos cargar los siguientes paquetes:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotROC)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epiR)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsci)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Otros paquetes relevantes:</strong> OptimalCutpoints, cutpointr</p>
<p>Importamos los datos <em>copd</em> en R:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"copd.xlsx"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div id="fig-depression" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-depression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="datatables html-widget html-fill-item" id="htmlwidget-0c07017a0556109fcdc6" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0c07017a0556109fcdc6">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937","938","939","940","941","942","943","944","945","946","947","948","949","950","951","952","953","954","955","956","957","958","959","960","961","962","963","964","965","966","967","968","969","970","971","972","973","974","975","976","977","978","979","980","981","982","983","984","985","986","987","988","989","990","991","992","993","994","995","996","997","998","999","1000","1001","1002","1003","1004","1005","1006","1007","1008","1009","1010","1011","1012","1013","1014","1015","1016","1017","1018","1019","1020","1021","1022","1023","1024","1025","1026","1027","1028","1029","1030","1031","1032","1033","1034","1035","1036","1037","1038","1039","1040","1041","1042","1043","1044","1045","1046","1047","1048","1049","1050","1051","1052","1053","1054","1055","1056","1057","1058","1059","1060","1061","1062","1063","1064","1065","1066","1067","1068","1069","1070","1071","1072","1073","1074","1075","1076","1077","1078","1079","1080","1081","1082","1083","1084","1085","1086","1087","1088","1089","1090","1091","1092","1093","1094","1095","1096","1097","1098","1099","1100","1101","1102","1103","1104","1105","1106","1107","1108","1109","1110","1111","1112","1113","1114","1115","1116","1117","1118","1119","1120","1121","1122","1123","1124","1125","1126","1127","1128","1129","1130","1131","1132","1133","1134","1135","1136","1137","1138","1139","1140","1141","1142","1143","1144","1145","1146","1147","1148","1149","1150","1151","1152","1153","1154","1155","1156","1157","1158","1159","1160","1161","1162","1163","1164","1165","1166","1167","1168","1169","1170","1171","1172","1173","1174","1175","1176","1177","1178","1179","1180","1181","1182","1183","1184","1185","1186","1187","1188","1189","1190","1191","1192","1193","1194","1195","1196","1197","1198","1199","1200","1201","1202","1203","1204","1205","1206","1207","1208","1209","1210","1211","1212","1213","1214","1215","1216","1217","1218","1219","1220","1221","1222","1223","1224","1225","1226","1227","1228","1229","1230","1231","1232","1233","1234","1235","1236","1237","1238","1239","1240","1241","1242","1243","1244","1245","1246","1247","1248","1249","1250","1251","1252","1253","1254","1255","1256","1257","1258","1259","1260","1261","1262","1263","1264","1265","1266","1267","1268","1269","1270","1271","1272","1273","1274","1275","1276","1277","1278","1279","1280","1281","1282","1283","1284","1285","1286","1287","1288","1289","1290","1291","1292","1293","1294","1295","1296","1297","1298","1299","1300","1301","1302","1303","1304","1305","1306","1307","1308","1309","1310","1311","1312","1313","1314","1315","1316","1317","1318","1319","1320","1321","1322","1323","1324","1325","1326","1327","1328","1329","1330","1331","1332","1333","1334","1335","1336","1337","1338","1339","1340","1341","1342","1343","1344","1345","1346","1347","1348","1349","1350","1351","1352","1353","1354","1355","1356","1357","1358","1359","1360","1361","1362","1363","1364","1365","1366","1367","1368","1369","1370","1371","1372","1373","1374","1375","1376","1377","1378","1379","1380","1381","1382","1383","1384","1385","1386","1387","1388","1389","1390","1391","1392","1393","1394","1395","1396","1397","1398","1399","1400","1401","1402","1403","1404","1405","1406","1407","1408","1409","1410","1411","1412","1413","1414","1415","1416","1417","1418","1419","1420","1421","1422","1423","1424","1425","1426","1427","1428","1429","1430","1431","1432","1433","1434","1435","1436","1437","1438","1439","1440","1441","1442","1443","1444","1445","1446","1447","1448","1449","1450","1451","1452","1453","1454","1455","1456","1457","1458","1459","1460","1461","1462","1463","1464","1465","1466","1467","1468","1469","1470","1471","1472","1473","1474","1475","1476","1477","1478","1479","1480","1481","1482","1483","1484","1485","1486","1487","1488","1489","1490","1491","1492","1493","1494","1495","1496","1497","1498","1499","1500","1501","1502","1503","1504","1505","1506","1507","1508","1509","1510","1511","1512","1513","1514","1515","1516","1517","1518","1519","1520","1521","1522","1523","1524","1525","1526","1527","1528","1529","1530","1531","1532","1533","1534","1535","1536","1537","1538","1539","1540","1541","1542","1543","1544","1545","1546","1547","1548","1549","1550","1551","1552","1553","1554","1555","1556","1557","1558","1559","1560","1561","1562","1563","1564","1565","1566","1567","1568","1569","1570","1571","1572","1573","1574","1575","1576","1577","1578","1579","1580","1581","1582","1583","1584","1585","1586","1587","1588","1589","1590","1591","1592","1593","1594","1595","1596","1597","1598","1599","1600","1601","1602","1603","1604","1605","1606","1607","1608","1609","1610","1611","1612","1613","1614","1615","1616","1617","1618","1619","1620","1621","1622","1623","1624","1625","1626","1627","1628","1629","1630","1631","1632","1633","1634","1635","1636","1637","1638","1639","1640","1641","1642","1643","1644","1645","1646","1647","1648","1649","1650","1651","1652","1653","1654","1655","1656","1657","1658","1659","1660","1661","1662","1663","1664","1665","1666","1667","1668","1669","1670","1671","1672","1673","1674","1675","1676","1677","1678","1679","1680","1681","1682","1683","1684","1685","1686","1687","1688","1689","1690","1691","1692","1693","1694","1695","1696","1697","1698","1699","1700","1701","1702","1703","1704","1705","1706","1707","1708","1709","1710","1711","1712","1713","1714","1715","1716","1717","1718","1719","1720","1721","1722","1723","1724","1725","1726","1727","1728","1729","1730","1731","1732","1733","1734","1735","1736","1737","1738","1739","1740","1741","1742","1743","1744","1745","1746","1747","1748","1749","1750","1751","1752","1753","1754","1755","1756","1757","1758","1759","1760","1761","1762","1763","1764","1765","1766","1767","1768","1769","1770","1771","1772","1773","1774","1775","1776","1777","1778","1779","1780","1781","1782","1783","1784","1785","1786","1787","1788","1789","1790","1791","1792","1793","1794","1795","1796","1797","1798","1799","1800","1801","1802","1803","1804","1805","1806","1807","1808","1809","1810","1811","1812","1813","1814","1815","1816","1817","1818","1819","1820","1821","1822","1823","1824","1825","1826","1827","1828","1829","1830","1831","1832","1833","1834","1835","1836","1837","1838","1839","1840","1841","1842","1843","1844","1845","1846","1847","1848","1849","1850","1851","1852","1853","1854","1855","1856","1857","1858","1859","1860","1861","1862","1863","1864","1865","1866","1867","1868","1869","1870","1871","1872","1873","1874","1875","1876","1877","1878","1879","1880","1881","1882","1883","1884","1885","1886","1887","1888","1889","1890","1891","1892","1893","1894","1895","1896","1897","1898","1899","1900","1901","1902","1903","1904","1905","1906","1907","1908","1909","1910","1911","1912","1913","1914","1915","1916","1917","1918","1919","1920","1921","1922","1923","1924","1925","1926","1927","1928","1929","1930","1931","1932","1933","1934","1935","1936","1937","1938","1939","1940","1941","1942","1943","1944","1945","1946","1947","1948","1949","1950","1951","1952","1953","1954","1955","1956","1957","1958","1959","1960","1961","1962","1963","1964","1965","1966","1967","1968","1969","1970","1971","1972","1973","1974","1975","1976","1977","1978","1979","1980","1981","1982","1983","1984","1985","1986","1987","1988","1989","1990","1991","1992","1993","1994","1995","1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021","2022","2023","2024","2025","2026","2027","2028","2029","2030","2031","2032","2033","2034","2035","2036","2037","2038","2039","2040","2041","2042","2043","2044","2045","2046","2047","2048","2049","2050","2051","2052","2053","2054","2055","2056","2057","2058","2059","2060","2061","2062","2063","2064","2065","2066","2067","2068","2069","2070","2071","2072","2073","2074","2075","2076","2077","2078","2079","2080","2081","2082","2083","2084","2085","2086","2087","2088","2089","2090","2091","2092","2093","2094","2095","2096","2097","2098","2099","2100","2101","2102","2103","2104","2105","2106","2107","2108","2109","2110","2111","2112","2113","2114","2115","2116","2117","2118","2119","2120","2121","2122","2123","2124","2125","2126","2127","2128","2129","2130","2131","2132","2133","2134","2135","2136","2137","2138","2139","2140","2141","2142","2143","2144","2145","2146","2147","2148","2149","2150","2151","2152","2153","2154","2155","2156","2157","2158","2159","2160","2161","2162","2163","2164","2165","2166","2167","2168","2169","2170","2171","2172","2173","2174","2175","2176","2177","2178","2179","2180","2181","2182","2183","2184","2185","2186","2187","2188","2189","2190","2191","2192","2193","2194","2195","2196","2197","2198","2199","2200","2201","2202","2203","2204","2205","2206","2207","2208","2209","2210","2211","2212","2213","2214","2215","2216","2217","2218","2219","2220","2221","2222","2223","2224","2225","2226","2227","2228","2229","2230","2231","2232","2233","2234","2235","2236","2237","2238","2239","2240","2241","2242","2243","2244","2245","2246","2247","2248","2249","2250","2251","2252","2253","2254","2255","2256","2257","2258","2259","2260","2261","2262","2263","2264","2265","2266","2267","2268","2269","2270","2271","2272","2273","2274","2275","2276","2277","2278","2279","2280","2281","2282","2283","2284","2285","2286","2287","2288","2289","2290","2291","2292","2293","2294","2295","2296","2297","2298","2299","2300","2301","2302","2303","2304","2305","2306","2307","2308","2309","2310","2311","2312","2313","2314","2315","2316","2317","2318","2319","2320","2321","2322","2323","2324","2325","2326","2327","2328","2329","2330","2331","2332","2333","2334","2335","2336","2337","2338","2339","2340","2341","2342","2343","2344","2345","2346","2347","2348","2349","2350","2351","2352","2353","2354","2355","2356","2357","2358","2359","2360","2361","2362","2363","2364","2365","2366","2367","2368","2369","2370","2371","2372","2373","2374","2375","2376","2377","2378","2379","2380","2381","2382","2383","2384","2385","2386","2387","2388","2389","2390","2391","2392","2393","2394","2395","2396","2397","2398","2399","2400","2401","2402","2403","2404","2405","2406","2407","2408","2409","2410","2411","2412","2413","2414","2415","2416","2417","2418","2419","2420","2421","2422","2423","2424","2425","2426","2427","2428","2429","2430","2431","2432","2433","2434","2435","2436","2437","2438","2439","2440","2441","2442","2443","2444","2445","2446","2447","2448","2449","2450","2451","2452","2453","2454","2455","2456","2457","2458","2459","2460","2461","2462","2463","2464","2465","2466","2467","2468","2469","2470","2471","2472","2473","2474","2475","2476","2477","2478","2479","2480","2481","2482","2483","2484","2485","2486","2487","2488","2489","2490","2491","2492","2493","2494","2495","2496","2497","2498","2499","2500","2501","2502","2503","2504","2505","2506","2507","2508","2509","2510","2511","2512","2513","2514","2515","2516","2517","2518","2519","2520","2521","2522","2523","2524","2525","2526","2527","2528","2529","2530","2531","2532","2533","2534","2535","2536","2537","2538","2539","2540","2541","2542","2543","2544","2545","2546","2547","2548","2549","2550","2551","2552","2553","2554","2555","2556","2557","2558","2559","2560","2561","2562","2563","2564","2565","2566","2567","2568","2569","2570","2571","2572","2573","2574","2575","2576","2577","2578","2579","2580","2581","2582","2583","2584","2585","2586","2587"],[11,15,4,7,13,15,13,14,4,21,17,11,10,17,9,18,10,19,4,12,18,14,7,20,20,18,19,18,20,7,14,27,25,21,17,13,18,13,14,10,30,3,13,9,11,11,13,13,25,18,9,20,6,14,15,12,16,11,18,11,26,18,21,14,16,11,31,14,8,24,4,25,21,14,16,20,10,13,3,8,12,10,14,13,5,8,14,13,17,14,7,11,7,18,21,15,8,21,10,14,11,14,5,13,30,15,14,27,18,17,12,17,10,4,16,15,17,5,8,20,18,20,20,21,7,19,19,14,19,11,12,31,21,18,11,30,10,28,11,7,6,6,20,8,14,16,4,26,18,5,18,24,13,10,10,5,10,11,4,14,11,14,13,10,9,31,8,21,19,24,10,6,13,26,27,10,10,25,30,14,14,18,29,20,14,8,7,17,11,11,24,20,7,14,8,12,3,3,15,4,10,13,16,20,19,12,15,13,21,25,21,13,9,7,27,23,12,33,25,14,11,20,8,16,17,10,18,20,13,7,25,16,22,23,33,10,24,8,10,19,21,14,15,11,14,11,21,7,10,20,15,21,8,28,14,10,7,22,10,14,11,6,7,20,11,10,10,10,12,15,11,18,25,15,12,20,9,18,10,11,14,14,11,8,23,5,10,9,7,11,14,13,17,18,14,12,21,14,10,6,18,14,22,8,14,14,21,19,17,4,5,14,10,13,4,19,11,11,10,14,10,10,13,14,16,6,14,14,30,24,13,14,8,6,8,6,20,7,20,12,20,13,27,11,14,20,11,11,16,16,4,16,11,16,3,4,23,18,14,11,12,9,23,16,16,20,14,14,26,24,13,16,14,24,13,15,21,12,21,10,7,11,21,16,13,13,10,14,5,17,20,14,12,17,15,4,6,19,14,20,26,10,10,16,15,14,20,6,6,10,10,21,10,17,14,10,7,14,25,13,3,22,13,21,11,11,11,13,13,16,14,24,21,20,7,22,8,23,7,15,4,27,11,12,18,12,16,13,7,26,17,7,11,14,13,18,10,10,16,26,25,7,15,7,9,13,17,26,8,12,9,20,7,26,20,10,35,9,14,4,19,4,15,18,10,20,13,13,7,19,21,18,18,8,11,26,25,4,21,20,23,15,17,6,16,13,10,16,3,12,12,10,23,13,9,7,24,10,3,13,16,6,21,6,28,12,14,22,24,10,25,19,30,14,26,8,20,25,21,7,13,7,17,14,11,3,8,20,11,8,12,15,12,7,9,11,12,19,13,12,27,21,12,21,13,17,8,13,16,20,20,19,6,21,17,5,14,17,11,11,15,19,20,7,22,13,10,10,14,4,17,14,18,16,18,21,13,7,23,11,12,14,18,5,21,20,21,22,5,19,7,14,10,18,21,7,20,14,10,12,11,12,14,8,17,33,18,9,18,14,10,20,18,10,19,17,18,17,25,15,13,11,18,23,11,23,21,16,10,7,14,9,5,8,14,10,9,23,20,17,16,12,4,20,31,20,26,19,10,17,14,5,19,31,21,20,29,10,11,5,6,16,13,9,13,21,18,13,10,25,20,21,10,21,14,25,25,30,7,13,5,10,20,4,28,11,11,25,12,7,19,12,24,12,21,6,23,3,4,21,9,13,17,7,7,23,19,4,11,7,18,9,12,19,15,31,10,20,13,15,12,17,11,4,13,7,18,17,30,12,11,15,16,3,8,13,16,10,7,11,13,25,10,6,4,15,19,17,3,16,14,13,24,18,6,11,13,13,8,13,21,12,14,16,20,23,26,15,31,18,7,13,5,8,11,19,14,13,13,11,21,15,8,4,4,10,21,15,13,3,10,10,25,11,14,20,18,19,14,17,25,16,17,22,13,20,10,3,14,14,14,8,21,11,8,10,15,7,18,17,10,14,12,7,22,17,11,26,7,18,19,14,33,9,16,10,15,16,24,17,20,21,7,14,21,16,7,6,20,21,12,12,14,13,10,27,18,18,15,20,19,12,15,3,13,20,14,14,20,12,20,9,9,30,6,23,24,18,19,3,11,12,21,18,16,10,21,8,7,8,25,20,13,11,17,8,16,18,8,14,15,14,13,7,10,3,20,10,17,7,11,14,8,16,27,20,10,8,16,21,3,16,20,13,20,25,14,20,23,8,9,19,10,3,20,6,20,3,29,17,21,4,26,7,21,8,18,14,7,16,3,17,8,13,13,8,6,16,12,8,13,15,12,11,12,15,11,25,7,14,9,8,17,8,11,3,29,12,10,6,8,22,11,7,16,25,25,14,31,21,26,11,10,4,10,12,18,15,26,14,12,15,19,12,13,7,25,18,14,7,9,7,6,22,10,6,24,11,11,11,13,15,7,24,15,17,17,4,26,15,12,11,16,25,31,21,27,11,11,14,8,7,18,12,4,15,19,12,21,17,6,13,11,7,6,15,8,16,17,13,12,16,20,10,14,8,13,17,7,24,13,11,24,25,9,10,17,13,24,16,14,23,16,11,11,6,15,14,13,10,7,23,15,18,19,10,20,5,24,19,8,10,15,12,12,8,14,13,8,13,21,6,16,27,15,18,14,11,7,7,25,10,17,7,15,13,12,18,8,10,25,27,12,7,11,13,30,13,12,17,16,14,13,13,3,13,13,15,11,3,12,19,13,17,8,18,16,26,27,6,11,11,13,5,14,29,14,14,11,16,15,10,23,14,12,11,8,14,3,5,10,10,20,15,6,15,25,18,21,13,15,16,15,14,17,7,10,10,18,26,19,3,12,23,14,24,21,8,21,6,11,11,8,12,3,16,12,15,13,11,21,20,20,21,8,17,16,19,14,6,9,14,11,6,14,14,13,16,14,13,11,3,25,21,7,15,23,7,18,21,11,18,14,21,16,13,15,16,6,14,12,9,16,23,6,15,13,11,14,16,18,7,15,18,6,14,20,6,11,11,7,21,14,21,16,19,9,35,20,14,13,13,13,31,19,13,14,29,17,7,20,6,17,8,8,14,11,13,25,15,31,18,15,8,11,18,20,7,10,14,14,19,18,15,24,20,12,7,12,4,20,30,16,11,12,7,10,9,5,10,9,20,28,12,15,11,13,30,9,12,11,13,10,7,14,8,19,8,14,4,21,10,11,23,16,17,14,14,21,21,21,21,3,26,18,6,11,13,16,14,14,21,15,4,11,27,12,12,25,10,17,12,15,10,14,11,21,8,8,21,14,11,15,9,22,24,15,7,6,12,20,16,9,13,6,24,26,24,16,18,21,11,15,19,23,14,4,15,15,13,18,17,8,11,9,25,9,5,11,27,10,11,27,13,11,11,11,24,18,14,10,10,23,21,23,5,20,13,5,13,5,16,13,3,10,13,7,25,31,13,20,16,15,7,18,17,18,18,18,13,14,7,10,17,14,13,30,6,35,25,10,12,25,22,11,6,10,13,8,20,7,8,11,21,10,13,8,4,10,25,11,14,25,11,14,13,21,18,8,11,13,8,20,7,4,14,17,9,6,11,20,27,27,12,11,14,15,16,18,16,10,7,14,12,10,21,11,14,9,26,9,26,13,13,15,11,15,20,11,11,6,23,29,12,8,12,6,21,8,10,10,13,14,15,30,27,13,7,8,17,7,24,14,5,14,14,17,12,16,31,21,19,15,24,16,14,21,8,24,16,21,8,6,16,7,21,21,16,19,6,6,13,11,9,15,18,21,7,31,15,19,11,16,18,14,14,12,18,31,5,18,21,14,24,12,18,13,15,14,19,14,16,12,11,11,13,11,20,28,14,20,11,11,14,11,9,13,18,3,24,8,18,13,7,5,12,15,23,19,20,3,23,31,4,17,13,11,15,15,15,13,20,10,14,13,21,14,18,24,6,18,10,19,6,8,8,21,8,7,8,3,20,15,21,10,7,13,14,31,12,7,14,19,11,9,27,20,17,14,24,7,14,17,17,13,7,13,27,7,18,7,15,9,16,14,15,9,10,18,14,24,3,10,20,7,8,25,13,25,14,10,21,18,11,23,14,15,4,15,23,27,18,10,13,27,18,13,20,13,17,21,15,20,15,7,19,13,17,11,15,7,13,17,12,5,17,14,31,29,13,21,7,18,13,21,10,24,17,15,10,9,15,6,24,17,10,7,16,11,10,5,29,19,13,21,20,20,12,5,17,18,14,8,20,14,13,15,12,14,13,15,11,25,10,8,13,11,12,26,8,14,3,24,18,11,7,4,4,14,20,17,6,10,18,31,21,4,3,10,7,16,15,31,16,8,21,24,14,11,9,16,13,13,11,4,14,16,11,9,20,26,24,11,16,12,11,9,8,7,14,6,4,18,17,25,10,6,11,11,13,8,18,15,27,8,4,14,21,20,22,12,20,8,14,11,16,22,18,18,7,14,14,7,20,10,11,4,15,7,14,12,13,11,13,10,13,23,10,4,14,21,12,10,6,12,26,8,10,9,22,10,15,8,21,17,13,16,30,20,11,9,9,6,27,8,21,13,18,19,7,8,14,3,15,15,22,30,9,12,7,7,12,18,16,25,18,18,8,13,10,14,17,10,19,11,5,15,19,21,12,10,17,14,12,16,15,13,24,20,8,11,11,21,8,18,8,6,6,14,17,7,21,15,8,16,22,12,13,19,6,15,13,23,10,13,15,25,8,10,6,4,10,17,28,4,21,19,19,21,8,14,21,15,20,20,21,8,13,15,13,10,7,21,19,7,11,9,7,12,13,3,7,11,11,13,9,24,12,6,31,14,24,23,15,18,16,8,11,16,7,19,19,11,14,8,14,17,23,21,7,3,20,10,6,20,8,24,8,6,13,8,9,30,25,17,11,8,10,22,16,19,14,7,18,8,18,5,31,21,18,5,9,19,19,12,13,13,11,21,16,20,9,16,10,21,7,20,5,21,10,12,11,10,3,14,20,10,24,23,19,14,11,13,3,11,11,15,11,13,16,13,10,8,27,6,23,21,8,10,15,14,26,5,13,17,8,21,20,8,26,16,8,14,20,11,7,7,4,15,5,13,10,11,21,10,13,11,11,14,6,5,15,6,6,35,20,20,21,18,13,21,31,7,10,8,14,21,23,9,3,10,8,17,15,29,15,14,16,8,16,14,14,25,14,18,9,16,24,8,18,8,17,13,13,11,20,13,7,11,10,18,8,21,18,10,7,18,14,8,3,13,7,16,10,8,7,21,26,24,4,6,8,11,7,13,4,19,7,10,17,16,6,14,17,17,4,16,18,23,16,14,8,24,19,28,5,16,4,6,15,14,8,3,5,12,19,11,13,17,13,17,13,19,14,7,12,22,6,30,11,20,26,7,3,14,14,10,24,6,10,9,14,11,11,20,27,10,8,18,14,11,7,11,4,23,13,9,11,10,11,5,26,22,11,16,6,15,8,23,8,13,6,11,16,19,9,15,21,10,8,18,15,8,13,13,14,11,19,30,10,14,4,7,4,17,7,6,4,20,14,13,7,30,14,20,13,13,13,14,21,26,5,12,16,14,11,13,8,7,11,21,3,11,14,21,7,6,24,4,13,11,12,17,10,19,10,6,11,12,16,14,13,11,14,8,6,7,5,32,3,20,13,15,8,12,11,15,17,13,21,13,24,13,14,14,14,7,21,11,11,12,16,17,16,23,7,6,20,14,9,21,15,11,4,8,21,16,15,8,16,5,20,13,11,14,18,3,8,13,5,16,29,15,10,21,10,20,9,15,8,12,21,12,21,20,10,12,21,15,19,16,15,7,10,15,11,13,7,20,16,7,8,11,11,15,7,18,27,16,14,18,15,27,11,24,8,18,15,6,3,19,11,16,16,13,11,7,20,11,17,28,7,14,10,16,17,28],[4,3,2,2,4,4,2,2,2,6,5,2,2,4,2,4,2,5,2,3,2,2,2,4,6,4,2,4,4,2,4,10,5,8,3,4,4,4,2,3,6,2,4,3,2,3,4,4,4,4,3,5,2,4,3,3,4,3,4,2,5,4,4,4,4,4,5,3,3,8,2,4,4,2,3,4,2,4,2,2,5,3,3,4,2,3,3,4,5,4,2,3,2,2,4,4,2,4,2,4,4,4,2,2,6,3,4,6,4,4,4,3,2,2,4,4,4,2,2,4,4,5,4,4,2,3,4,3,5,4,4,6,4,4,2,5,2,4,3,3,2,2,4,3,3,4,2,5,4,2,3,7,4,4,3,3,1,2,2,4,2,3,4,3,2,6,2,5,4,6,3,2,2,8,5,2,1,6,5,2,3,4,8,4,3,2,3,3,3,2,4,5,2,3,2,3,2,0,3,2,2,4,4,4,4,5,4,4,4,4,4,4,4,3,6,4,4,5,3,2,3,4,2,3,4,3,4,4,4,2,4,4,4,7,5,2,6,2,2,4,4,4,3,4,4,2,4,3,3,4,3,4,2,5,2,3,2,4,3,4,4,2,3,4,2,3,3,2,2,4,4,2,6,4,4,4,3,3,2,3,2,4,2,3,7,2,3,2,2,3,3,4,2,2,3,4,4,4,3,2,2,3,4,2,4,3,4,5,3,2,2,4,3,4,2,4,3,2,2,4,2,2,2,4,6,2,4,2,6,5,2,4,2,2,3,2,4,3,4,3,4,4,6,4,5,4,3,2,4,4,2,4,2,3,0,2,5,4,4,2,2,3,4,6,4,4,2,4,5,8,4,3,3,5,4,2,5,4,4,2,2,4,4,4,3,4,3,4,2,5,5,4,4,4,3,2,2,4,2,4,5,3,2,4,4,6,4,2,2,3,2,4,3,4,3,4,2,4,9,4,2,4,5,5,2,2,3,2,4,2,4,6,5,8,2,6,3,3,2,3,2,5,4,4,4,4,4,3,2,8,3,2,4,3,2,4,2,2,4,8,5,2,4,2,2,4,4,4,3,4,2,4,2,8,4,3,8,2,3,2,3,2,4,4,2,5,4,2,2,6,4,4,3,2,4,5,4,2,4,4,5,2,3,3,4,4,3,4,3,4,4,2,10,4,6,2,6,2,2,4,4,2,5,2,7,2,4,5,4,2,4,4,7,3,4,2,5,4,4,2,2,1,4,4,4,2,2,4,3,2,4,3,3,3,2,3,3,3,4,2,5,2,3,4,2,4,2,4,4,4,4,4,2,4,4,2,2,4,4,4,3,4,4,3,6,2,3,3,3,2,3,2,4,4,6,4,4,3,6,3,4,4,3,2,5,4,4,10,4,4,2,4,2,4,4,3,4,4,3,4,4,4,4,3,4,6,4,3,4,3,2,4,4,3,5,2,4,3,4,3,4,4,3,6,2,5,6,4,2,2,4,2,2,2,4,2,3,4,4,4,5,5,2,4,7,4,6,4,2,5,4,2,4,6,6,4,5,2,3,2,2,4,2,2,4,7,4,4,3,8,4,4,5,5,2,6,6,8,2,4,2,3,5,2,10,2,2,6,3,2,3,1,5,4,5,2,4,2,2,4,3,4,4,2,2,5,5,2,2,0,6,3,4,4,3,7,3,4,4,4,3,4,3,2,2,2,4,4,8,4,4,3,4,2,2,4,4,3,3,2,3,4,3,2,2,3,4,2,2,4,4,4,8,4,2,3,4,2,2,4,6,4,4,4,5,5,5,4,5,2,0,4,2,2,2,4,4,4,4,4,5,4,3,2,2,3,4,4,2,0,2,3,6,4,4,4,4,4,3,4,6,4,4,5,2,4,3,2,4,4,4,2,4,3,3,2,4,2,4,8,2,3,3,2,4,6,4,9,2,4,4,2,5,2,4,2,4,4,6,4,4,4,2,4,5,3,2,2,6,4,3,3,4,2,2,8,4,4,4,4,4,3,3,2,4,4,4,4,4,3,4,2,2,5,2,4,6,4,4,2,2,4,7,4,4,3,4,2,2,3,6,4,2,4,4,2,5,4,3,4,3,3,4,2,3,2,4,3,4,1,3,4,3,5,6,5,3,2,4,4,2,4,5,3,4,4,4,6,6,3,5,4,2,2,4,2,4,2,4,4,4,3,5,2,4,2,4,4,2,4,2,4,2,2,2,2,2,8,3,2,4,4,4,3,2,3,2,5,3,4,2,3,4,2,4,2,8,4,2,2,2,5,2,3,4,4,8,3,10,4,4,4,2,2,2,4,4,3,10,3,4,4,3,4,2,2,8,4,6,2,3,3,2,3,3,2,8,3,4,1,2,4,2,5,3,4,5,2,3,3,5,2,4,4,5,2,6,3,2,4,2,2,4,3,2,3,4,4,7,5,2,3,2,2,4,3,2,4,4,2,2,4,4,2,4,3,4,3,3,5,4,2,6,7,2,2,5,4,8,4,2,3,4,2,2,4,4,3,4,2,2,7,4,4,4,3,4,2,6,4,3,3,3,3,3,2,4,4,2,4,2,2,4,4,4,4,4,3,2,3,4,2,6,3,3,4,4,4,2,2,5,5,4,3,2,3,7,4,2,4,4,2,4,4,2,4,4,3,2,2,4,2,4,7,2,4,4,4,6,2,4,4,2,2,4,5,4,3,2,4,4,2,4,3,4,3,3,3,2,2,3,3,8,2,2,4,7,4,5,4,3,4,3,4,4,2,2,2,2,7,4,2,4,4,2,6,4,2,4,2,2,4,0,3,2,4,4,3,5,2,4,4,4,4,2,4,4,4,4,2,3,4,2,2,3,3,2,4,4,2,2,2,4,4,3,4,5,3,4,4,3,4,4,4,3,4,4,4,2,4,3,3,3,4,2,4,4,3,2,3,4,2,4,4,2,2,4,2,3,4,3,8,3,6,4,4,3,10,4,4,4,2,4,7,6,2,4,7,6,3,4,2,4,2,2,4,3,4,4,3,5,5,2,2,2,2,4,3,2,2,4,4,4,4,5,4,3,3,3,0,4,8,4,2,3,2,2,3,2,3,2,7,6,2,2,2,4,10,2,2,3,4,2,2,5,2,3,2,3,2,4,2,4,5,4,3,3,4,4,4,4,7,2,4,4,3,3,4,4,4,4,7,3,2,2,9,4,3,4,3,4,3,3,3,4,2,4,3,2,3,2,2,3,2,6,5,3,3,2,4,4,3,3,2,2,7,5,5,4,4,4,2,3,4,5,4,2,2,2,4,4,4,3,2,2,7,3,2,2,8,3,3,7,4,4,4,2,6,4,3,3,3,4,4,3,2,7,2,2,4,2,4,4,2,2,3,3,6,6,2,4,4,3,2,4,4,4,2,4,2,5,3,3,4,3,4,9,2,9,6,3,4,9,6,3,2,3,4,2,4,5,2,3,4,3,2,3,2,3,4,2,4,7,4,4,4,3,5,2,2,4,3,4,3,2,3,7,3,2,3,7,4,7,4,3,4,3,3,4,4,4,3,5,3,3,4,4,4,3,5,3,9,4,7,3,4,3,4,4,2,2,5,4,3,2,3,2,4,2,2,2,4,4,3,5,5,4,2,2,4,2,8,3,2,3,4,4,3,2,10,4,5,3,6,4,4,7,2,4,3,3,2,2,4,2,4,5,5,4,2,2,4,2,2,4,3,4,3,7,3,4,4,4,4,4,3,4,5,9,2,4,4,7,4,2,4,2,3,3,7,4,4,2,2,4,4,3,4,10,4,6,3,4,3,2,2,4,4,3,5,2,3,4,3,2,2,4,4,4,4,2,7,6,2,7,4,3,3,4,4,4,4,2,3,4,5,2,4,7,2,6,2,6,2,3,2,4,2,3,2,2,3,4,4,2,2,2,4,8,3,3,3,3,2,3,6,4,4,3,9,2,4,6,4,4,3,4,4,3,2,2,3,3,4,3,4,2,2,4,4,8,2,3,4,2,2,4,4,4,3,2,4,5,2,4,4,4,2,4,3,4,4,2,4,9,4,2,4,4,3,4,3,4,3,2,4,4,5,2,3,3,4,4,4,2,3,4,7,10,4,8,2,4,4,6,3,6,4,2,2,2,3,2,7,4,2,2,2,4,3,2,6,4,2,4,3,4,4,2,2,4,5,2,7,4,4,4,2,4,4,3,2,5,2,2,3,4,3,4,2,3,2,4,4,3,2,3,2,5,4,4,2,3,4,4,4,2,2,2,3,4,3,9,4,2,6,6,3,4,2,2,2,3,4,2,3,3,4,3,4,5,3,2,4,4,4,2,3,2,4,2,2,2,4,4,3,2,2,3,2,3,4,4,8,3,2,3,5,4,4,3,5,3,4,2,4,4,4,4,3,4,3,3,5,3,2,2,4,3,4,3,3,4,4,3,2,5,2,2,4,5,4,2,2,4,6,2,2,2,5,3,3,2,5,3,4,4,10,5,3,3,3,3,5,2,4,2,5,5,4,2,4,2,3,4,2,8,2,2,2,2,5,4,4,8,4,4,2,2,2,4,4,2,4,3,2,2,6,4,4,3,3,3,4,4,4,4,7,5,2,4,2,4,3,5,1,2,2,4,4,3,4,3,2,4,10,4,2,3,2,4,2,5,3,4,4,6,2,3,2,2,2,5,10,2,4,4,4,6,2,2,6,3,5,4,6,2,4,4,4,3,2,4,4,3,4,2,3,4,2,2,2,3,2,4,2,4,3,2,6,3,7,4,4,4,4,2,3,4,3,4,2,4,4,2,4,4,4,4,3,2,5,3,2,4,3,5,3,2,3,3,3,10,5,4,2,2,3,6,4,3,5,2,2,2,2,2,8,6,4,2,3,3,4,4,3,4,3,4,4,4,3,4,2,4,3,4,2,4,2,5,4,3,2,4,4,3,9,4,5,4,2,2,2,4,2,4,4,2,4,4,3,2,5,2,8,3,2,3,4,3,5,2,4,4,3,4,7,2,8,4,3,3,6,3,2,2,2,4,2,2,3,3,4,2,3,3,4,4,2,2,3,2,2,9,4,4,5,5,4,5,5,2,3,3,3,4,4,4,0,3,2,8,4,6,4,4,4,2,4,4,3,9,2,4,3,4,6,2,4,1,3,4,4,4,4,2,2,2,3,3,2,4,4,2,3,4,2,3,2,4,2,5,3,2,2,5,10,5,2,2,2,2,2,4,2,4,3,2,4,3,2,3,3,4,2,3,2,6,4,4,2,3,4,6,2,4,2,2,2,3,2,2,2,3,8,2,4,5,4,4,5,4,3,2,4,6,2,7,2,4,5,2,2,3,2,3,7,2,3,3,3,2,7,4,4,3,3,4,4,2,3,3,0,6,2,2,2,2,3,2,6,8,4,4,2,4,3,4,2,5,2,3,4,4,3,3,4,3,2,4,3,2,4,3,3,3,4,6,3,3,2,3,2,4,2,2,2,4,2,4,2,7,4,5,4,2,2,4,4,4,2,3,4,4,4,3,2,3,4,6,2,2,4,4,2,2,6,2,2,2,4,4,3,4,3,2,2,4,5,3,4,4,3,3,2,3,2,6,2,5,4,4,2,3,2,2,3,2,4,4,8,4,3,4,2,2,4,2,2,3,4,3,4,4,3,2,4,2,2,4,3,3,2,0,3,4,3,2,2,2,4,4,2,3,4,2,2,2,2,4,6,4,2,4,2,4,3,4,1,4,5,4,4,3,2,3,4,4,4,4,4,2,3,2,3,4,1,6,2,2,3,2,3,4,2,4,6,5,3,3,3,5,2,8,2,4,3,2,2,5,3,4,4,2,2,3,4,3,4,6,2,2,3,4,4,7],[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,1,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>IPAG<\/th>\n      <th>COPDPS<\/th>\n      <th>diagnosis<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"className":"dt-center","targets":"_all"},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"IPAG","targets":1},{"name":"COPDPS","targets":2},{"name":"diagnosis","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-depression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.4: Table with data from “copd” file.
</figcaption>
</figure>
</div>
</div>
<p>Inspeccionamos los datos y el tipo de variables:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(dat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,587
Columns: 3
$ IPAG      &lt;dbl&gt; 11, 15, 4, 7, 13, 15, 13, 14, 4, 21, 17, 11, 10, 17, 9, 18, …
$ COPDPS    &lt;dbl&gt; 4, 3, 2, 2, 4, 4, 2, 2, 2, 6, 5, 2, 2, 4, 2, 4, 2, 5, 2, 3, …
$ diagnosis &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</code></pre>
</div>
</div>
<p>Uso de puntos de corte y la curva ROC</p>
<p>Según estudios previos, los puntos de corte para una respuesta positiva son:</p>
<ul>
<li><span class="math inline">\(\ge 17\)</span> para el cuestionario IPAG</li>
<li><span class="math inline">\(\ge 5\)</span> para el cuestionario COPDPS.</li>
</ul>
<p>Podemos evaluar estos valores de corte calculando sus medidas asociadas de precisión diagnóstica (es decir, Se, Sp, VPP, VPN).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span>  </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IPAG_cat =</span> <span class="fu">cut</span>(IPAG, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">17</span>, <span class="dv">38</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"-"</span>,<span class="st">"+"</span>), </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">include.lowest =</span> <span class="cn">TRUE</span>, <span class="at">right=</span><span class="cn">FALSE</span>),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">COPDPS_cat =</span> <span class="fu">cut</span>(COPDPS, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"-"</span>,<span class="st">"+"</span>), </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">include.lowest =</span> <span class="cn">TRUE</span>, <span class="at">right=</span><span class="cn">FALSE</span>))</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dat)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># we need to create a roc object for each questionnaire</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>roc1 <span class="ot">&lt;-</span> <span class="fu">roc</span>(dat<span class="sc">$</span>diagnosis, dat<span class="sc">$</span>IPAG)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>roc2 <span class="ot">&lt;-</span> <span class="fu">roc</span>(dat<span class="sc">$</span>diagnosis, dat<span class="sc">$</span>COPDPS)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="cuestionario-ipag" class="level4" data-number="1.4.4.1">
<h4 data-number="1.4.4.1" class="anchored" data-anchor-id="cuestionario-ipag"><span class="header-section-number">1.4.4.1</span> Cuestionario IPAG</h4>
<p><strong>A. El uso de un valor de corte: puntuación IPAG</strong> <span class="math inline">\(\ge 17\)</span></p>
<p>Primero, encontraremos los recuentos de individuos en cada uno de los cuatro posibles resultados en una tabla 2x2 para el punto de corte de 17:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dat<span class="sc">$</span>IPAG_cat, dat<span class="sc">$</span>diagnosis)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1
  - 1670   70
  +  644  203</code></pre>
</div>
</div>
<p>A continuación, reformateamos la tabla de la siguiente manera:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>tb1 <span class="ot">&lt;-</span> <span class="fu">as.table</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">203</span>, <span class="dv">644</span>), <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">1670</span>))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(tb1) <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test =</span> <span class="fu">c</span>(<span class="st">"+"</span>, <span class="st">"_"</span>),</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Outcome =</span> <span class="fu">c</span>(<span class="st">"+"</span>, <span class="st">"-"</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>tb1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Outcome
Test    +    -
   +  203  644
   _   70 1670</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.tests</span>(tb1, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Outcome +    Outcome -      Total
Test +          203          644        847
Test -           70         1670       1740
Total           273         2314       2587

Point estimates and 95% CIs:
--------------------------------------------------------------
Apparent prevalence *                  0.327 (0.309, 0.346)
True prevalence *                      0.106 (0.094, 0.118)
Sensitivity *                          0.744 (0.687, 0.794)
Specificity *                          0.722 (0.703, 0.740)
Positive predictive value *            0.240 (0.211, 0.270)
Negative predictive value *            0.960 (0.949, 0.969)
Positive likelihood ratio              2.672 (2.428, 2.940)
Negative likelihood ratio              0.355 (0.290, 0.436)
False T+ proportion for true D- *      0.278 (0.260, 0.297)
False T- proportion for true D+ *      0.256 (0.206, 0.313)
False T+ proportion for T+ *           0.760 (0.730, 0.789)
False T- proportion for T- *           0.040 (0.031, 0.051)
Correctly classified proportion *      0.724 (0.706, 0.741)
--------------------------------------------------------------
* Exact CIs</code></pre>
</div>
</div>
<p>Los resultados utilizando el punto de corte de 17 arrojan una Se = 0.744 (0.687 - 0.794) y una Sp = 0.722 (0.703 - 0.740). Observamos que la probabilidad de la ausencia de EPOC dado un resultado negativo de la prueba es alta, NPV = 0.960 (IC 95%: 0.949, 0.969) en esta muestra con fumadores.</p>
<p><strong>B. El área bajo la curva ROC del cuestionario IPAG</strong></p>
<p>Calculemos el AUC de ROC para el cuestionario IPAG:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.7986</code></pre>
</div>
</div>
<p>El intervalo de confianza del 95% de esta área es:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ci.auc</span>(roc1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI: 0.7687-0.8286 (DeLong)</code></pre>
</div>
</div>
<p>La capacidad del cuestionario IPAG para discriminar entre individuos con y sin EPOC se muestra gráficamente mediante la curva ROC:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the plot</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">d =</span> diagnosis, <span class="at">m =</span> IPAG)) <span class="sc">+</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_roc</span>(<span class="at">n.cuts =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#0071BF"</span>) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.015</span>)) <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"1 - Specificity"</span>, <span class="at">y =</span> <span class="st">"Sensitivity"</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add annotations to the plot</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>g1 <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="fl">0.70</span>, <span class="at">y=</span><span class="fl">0.30</span>, </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">label=</span><span class="fu">paste</span>(<span class="st">"AUC IPAG = "</span>, <span class="fl">0.799</span>, </span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"(95% CI = "</span>, <span class="fl">0.769</span>, <span class="st">" - "</span>, <span class="fl">0.829</span>, <span class="st">")"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-roc1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-roc1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="TEMA-1_files/figure-html/fig-roc1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-roc1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.5: The ROC curve of IPAG questionnaire.
</figcaption>
</figure>
</div>
</div>
</div>
<p>El AUC del cuestionario IPAG es igual a 0.799 (IC 95%: 0.769 - 0.829), lo que indica una prueba diagnóstica razonable.</p>
<p>El <strong>índice de Youden</strong>, definido como la suma de sensibilidad y especificidad menos 1, se utiliza a menudo junto con la curva ROC. El valor máximo del índice de Youden puede emplearse como criterio para seleccionar el punto de corte (umbral) óptimo para una prueba diagnóstica, como se muestra a continuación:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coords</span>(roc1, <span class="st">"best"</span>, <span class="at">ret =</span> <span class="fu">c</span>(<span class="st">"threshold"</span>, <span class="st">"sensitivity"</span>, <span class="st">"specificity"</span>),</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">best.method=</span><span class="st">"youden"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  threshold sensitivity specificity
1      18.5   0.6739927   0.8063959</code></pre>
</div>
</div>
<p>Observamos que el punto de corte (umbral) óptimo para esta muestra es igual a 18.5, lo cual es ligeramente superior al valor de 17 que se obtuvo de otros estudios.</p>
<p>También podemos calcular fácilmente el valor máximo del índice de Youden según la definición previa del índice de Youden:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.674</span> <span class="sc">+</span> <span class="fl">0.806</span> <span class="sc">-</span> <span class="dv">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.48</code></pre>
</div>
</div>
</section>
<section id="cuestionario-copdps" class="level4" data-number="1.4.4.2">
<h4 data-number="1.4.4.2" class="anchored" data-anchor-id="cuestionario-copdps"><span class="header-section-number">1.4.4.2</span> Cuestionario COPDPS</h4>
<p><strong>A. El uso de un valor de corte: puntuación COPDPS</strong> <span class="math inline">\(\ge 5\)</span></p>
<p>Primero, encontraremos los recuentos de individuos en cada uno de los cuatro posibles resultados en una tabla 2x2 para el punto de corte de 5:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dat<span class="sc">$</span>COPDPS_cat, dat<span class="sc">$</span>diagnosis)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1
  - 2089  121
  +  225  152</code></pre>
</div>
</div>
<p>A continuación, reformateamos la tabla de la siguiente manera:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>tb2 <span class="ot">&lt;-</span> <span class="fu">as.table</span>(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">152</span>, <span class="dv">225</span>), <span class="fu">c</span>(<span class="dv">121</span>, <span class="dv">2089</span>))</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(tb2) <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test =</span> <span class="fu">c</span>(<span class="st">"+"</span>, <span class="st">"_"</span>),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Outcome =</span> <span class="fu">c</span>(<span class="st">"+"</span>, <span class="st">"-"</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>tb2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Outcome
Test    +    -
   +  152  225
   _  121 2089</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.tests</span>(tb2, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Outcome +    Outcome -      Total
Test +          152          225        377
Test -          121         2089       2210
Total           273         2314       2587

Point estimates and 95% CIs:
--------------------------------------------------------------
Apparent prevalence *                  0.146 (0.132, 0.160)
True prevalence *                      0.106 (0.094, 0.118)
Sensitivity *                          0.557 (0.496, 0.617)
Specificity *                          0.903 (0.890, 0.915)
Positive predictive value *            0.403 (0.353, 0.455)
Negative predictive value *            0.945 (0.935, 0.954)
Positive likelihood ratio              5.726 (4.864, 6.741)
Negative likelihood ratio              0.491 (0.430, 0.561)
False T+ proportion for true D- *      0.097 (0.085, 0.110)
False T- proportion for true D+ *      0.443 (0.383, 0.504)
False T+ proportion for T+ *           0.597 (0.545, 0.647)
False T- proportion for T- *           0.055 (0.046, 0.065)
Correctly classified proportion *      0.866 (0.853, 0.879)
--------------------------------------------------------------
* Exact CIs</code></pre>
</div>
</div>
<p>Los resultados utilizando el punto de corte de 5 arrojan Se = 0.577 (0.496 - 0.617) y Sp = 0.903 (0.890 - 0.915).</p>
<p><strong>B. El área bajo la curva ROC del cuestionario COPDPS</strong></p>
<p>El AUC de la curva ROC del cuestionario COPDPS es:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.7908</code></pre>
</div>
</div>
<p>El intervalo de confianza del 95% de esta área es:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ci.auc</span>(roc2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI: 0.7602-0.8214 (DeLong)</code></pre>
</div>
</div>
<p>La curva ROC del cuestionario COPDPS es la siguiente:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the plot</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">d =</span> diagnosis, <span class="at">m =</span> COPDPS)) <span class="sc">+</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_roc</span>(<span class="at">n.cuts =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#EFC000"</span>) <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.015</span>)) <span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"1 - Specificity"</span>, <span class="at">y =</span> <span class="st">"Sensitivity"</span>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add annotations to the plot</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>g2 <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="fl">0.70</span>, <span class="at">y=</span><span class="fl">0.25</span>, </span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">label=</span> <span class="fu">paste</span>(<span class="st">"AUC COPDPS = "</span>, <span class="fl">0.791</span>, </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"(95% CI = "</span>, <span class="fl">0.760</span>, <span class="st">" - "</span>, <span class="fl">0.821</span>, <span class="st">")"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-roc2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-roc2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="TEMA-1_files/figure-html/fig-roc2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-roc2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.6: The ROC curve of COPDPS questionnaire.
</figcaption>
</figure>
</div>
</div>
</div>
<p>El AUC del cuestionario COPDPS es igual a 0.791 (IC 95%: 0.760 - 0.821), lo que es un valor cercano al 0.799 del AUC del cuestionario IPAG.</p>
<p>El punto de corte óptimo utilizando el Índice de Youden como mejor método es:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coords</span>(roc2, <span class="st">"best"</span>, <span class="at">ret =</span> <span class="fu">c</span>(<span class="st">"threshold"</span>, <span class="st">"sensitivity"</span>, <span class="st">"specificity"</span>),</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">best.method=</span><span class="st">"youden"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  threshold sensitivity specificity
1       4.5   0.5567766   0.9027658</code></pre>
</div>
</div>
<p>Observamos que el punto de corte (umbral) óptimo para esta muestra es igual a 4.5, lo cual es cercano al valor de 5 que se obtuvo de otros estudios.</p>
<p>También podemos calcular el valor máximo del índice de Youden:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.557</span> <span class="sc">+</span> <span class="fl">0.903</span> <span class="sc">-</span> <span class="dv">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.46</code></pre>
</div>
</div>
<p>Comparación gráfica de curvas ROC</p>
<p>Podemos trazar las curvas ROC para ambos cuestionarios en el mismo gráfico y comparar el área bajo las curvas:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare the data</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>longdata <span class="ot">&lt;-</span> <span class="fu">melt_roc</span>(dat, <span class="st">"diagnosis"</span>, <span class="fu">c</span>(<span class="st">"IPAG"</span>, <span class="st">"COPDPS"</span>))</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create the plot</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(longdata, <span class="fu">aes</span>(<span class="at">d =</span> D, <span class="at">m =</span> M, <span class="at">color =</span> name)) <span class="sc">+</span> </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_roc</span>(<span class="at">n.cuts =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.015</span>)) <span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_jco</span>() <span class="sc">+</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"1 - Specificity"</span>, <span class="at">y =</span> <span class="st">"Sensitivity"</span>, <span class="at">colour=</span><span class="st">"Questionnaire"</span>)</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="co"># add annotations to the plot</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="fl">0.70</span>, <span class="at">y=</span><span class="fl">0.35</span>, <span class="at">color =</span> <span class="st">"#0071BF"</span>,</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">label=</span><span class="fu">paste</span>(<span class="st">"AUC IPAG = "</span>, <span class="fl">0.799</span>, </span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>                         <span class="st">" (95% CI = "</span>, <span class="fl">0.769</span>, <span class="st">" - "</span>, <span class="fl">0.829</span>, <span class="st">")"</span>)) <span class="sc">+</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="fl">0.70</span>, <span class="at">y=</span><span class="fl">0.28</span>, <span class="at">color =</span> <span class="st">"#EFC000"</span>,</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">label=</span> <span class="fu">paste</span>(<span class="st">"AUC COPDPS = "</span>, <span class="fl">0.791</span>, </span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>                          <span class="st">" (95% CI = "</span>, <span class="fl">0.760</span>, <span class="st">" - "</span>, <span class="fl">0.821</span>, <span class="st">")"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-rocs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rocs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="TEMA-1_files/figure-html/fig-rocs-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rocs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.7: Graphical comparison between IPAG and COPDPS ROC curves.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Los valores de AUC obtenidos de la curva ROC fueron 0.799 (IC 95%: 0.769 - 0.829) para el cuestionario IPAG y 0.791 (IC 95%: 0.760 - 0.821) para el cuestionario COPDPS. Por lo tanto, los dos cuestionarios tienen un rendimiento general similar en la muestra actual.</p>
<p>Basado en la prueba de DeLong podemos describir la hipótesis nula y alternativa e interpretar el resultado. La prueba de DeLong se puede utilizar para comparar 2 áreas bajo la curva (AUCs). La hipótesis nula y alternativa son:</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: no hay diferencia entre dos AUC (<span class="math inline">\(AUC_{IPAG} = AUC_{COPDPS}\)</span>)</li>
<li><span class="math inline">\(H_1\)</span>: existe diferencia entre dos AUC (<span class="math inline">\(AUC_{IPAG} \neq AUC_{COPDPS}\)</span>)</li>
</ul>
<p>El test de Delong en R:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">roc.test</span>(roc1, roc2, <span class="at">method=</span><span class="fu">c</span>(<span class="st">"delong"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DeLong's test for two correlated ROC curves

data:  roc1 and roc2
Z = 0.67525, p-value = 0.4995
alternative hypothesis: true difference in AUC is not equal to 0
95 percent confidence interval:
 -0.01488242  0.03052696
sample estimates:
AUC of roc1 AUC of roc2 
  0.7986393   0.7908170 </code></pre>
</div>
</div>
<p>La interpretación del resultado es la siguiente: No hubo una diferencia significativa en los valores de AUC con los dos cuestionarios (p = 0.4995 &gt; 0.05).</p>
<p><strong>Enlaces de interés:</strong><br>
<a href="https://darwin.unmc.edu/dxtests/Default.htm" class="uri">https://darwin.unmc.edu/dxtests/Default.htm</a><br>
<a href="https://epitools.ausvet.com.au/testevaluation" class="uri">https://epitools.ausvet.com.au/testevaluation</a><br>
<a href="https://www.medcalc.org/calc/diagnostic_test.php" class="uri">https://www.medcalc.org/calc/diagnostic_test.php</a></p>
</section>
</section>
</section>
<section id="ejercicios-resueltos" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="ejercicios-resueltos"><span class="header-section-number">1.5</span> Ejercicios Resueltos</h2>
<p>-<strong>Ejercicio 1:</strong></p>
<p>Suponga que 100 individuos “conocidos” con la enfermedad y 1000 individuos “conocidos” libres de la enfermedad son examinados por una prueba diagnóstica con los siguientes resultados. Calcule la sensibilidad y la especificidad de la prueba diagnóstica <span class="citation" data-cites="schulzer1994">[<a href="#ref-schulzer1994" role="doc-biblioref">9</a>]</span>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Prueba diagnóstica</strong></th>
<th style="text-align: center;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Estado real de la enfermedad</strong></td>
<td style="text-align: center;"><strong>T+</strong></td>
<td style="text-align: center;"><strong>T-</strong></td>
<td style="text-align: left;"><strong>Total</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">D+</td>
<td style="text-align: center;">90 (VP)</td>
<td style="text-align: center;">10 (FN)</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D-</td>
<td style="text-align: center;">200 (FP)</td>
<td style="text-align: center;">800 (VN)</td>
<td style="text-align: left;">1000</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Total</strong></td>
<td style="text-align: center;">290</td>
<td style="text-align: center;">810</td>
<td style="text-align: left;">1100</td>
</tr>
</tbody>
</table>
<p>Fuente: Schulzer M, Pruebas diagnósticas: una revisión estadística. Muscle &amp; Nerve, 1994; 17: 815 - 819.</p>
<p><strong>Respuesta Ejercicio 1:</strong> Nota: Transponemos la tabla para que las filas representen los resultados de la prueba y las columnas el estado real de la enfermedad. - Sensibilidad (Se) = VP / (VP + FN) = 90 / (90 + 10) = 0.90 o 90% - Especificidad (Sp) = VN / (VN + FP) = 800 / (800 + 200) = 0.80 o 80% Usando R y epiR:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epiR)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">as.table</span>(</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">200</span>), <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">800</span>))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(tb) <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test =</span> <span class="fu">c</span>(<span class="st">"+"</span>, <span class="st">"-"</span>),</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Outcome =</span> <span class="fu">c</span>(<span class="st">"+"</span>, <span class="st">"-"</span>)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.tests</span>(tb, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Outcome +    Outcome -      Total
Test +           90          200        290
Test -           10          800        810
Total           100         1000       1100

Point estimates and 95% CIs:
--------------------------------------------------------------
Apparent prevalence *                  0.264 (0.238, 0.291)
True prevalence *                      0.091 (0.075, 0.109)
Sensitivity *                          0.900 (0.824, 0.951)
Specificity *                          0.800 (0.774, 0.824)
Positive predictive value *            0.310 (0.258, 0.367)
Negative predictive value *            0.988 (0.977, 0.994)
Positive likelihood ratio              4.500 (3.912, 5.177)
Negative likelihood ratio              0.125 (0.069, 0.225)
False T+ proportion for true D- *      0.200 (0.176, 0.226)
False T- proportion for true D+ *      0.100 (0.049, 0.176)
False T+ proportion for T+ *           0.690 (0.633, 0.742)
False T- proportion for T- *           0.012 (0.006, 0.023)
Correctly classified proportion *      0.809 (0.785, 0.832)
--------------------------------------------------------------
* Exact CIs</code></pre>
</div>
</div>
<p>-<strong>Ejercicio 2:</strong></p>
<p>El cáncer de cuello uterino es una enfermedad para la cual la probabilidad de contención es alta si se detecta a tiempo. La prueba de Papanicolaou es un procedimiento de detección ampliamente aceptado que puede detectar un cáncer aún asintomático; se le ha atribuido ser el principal responsable de la disminución de la tasa de mortalidad por cáncer de cuello uterino en los últimos años. Una prueba de competencia in situ realizada en 1972, 1973 y 1978 evaluó la competencia de los técnicos que examinan las muestras de Papanicolaou en busca de anomalías. Se examinó a técnicos en 306 laboratorios de citología en 44 estados de EE. UU. En general, el 16.25% de las pruebas realizadas en mujeres con cáncer resultaron en resultados falsos negativos (es decir, la prueba de una mujer que tiene cáncer de cuello uterino indica incorrectamente que no lo tiene). No todas las mujeres con resultados positivos realmente padecían cáncer de cuello uterino. De hecho, el 18.64% de las pruebas fueron resultados falsos positivos (es decir, la prueba es positiva pero la mujer no tiene cáncer de cuello uterino). Calcule la sensibilidad y la especificidad de la prueba de Papanicolaou <span class="citation" data-cites="pagano2000">[<a href="#ref-pagano2000" role="doc-biblioref">10</a>]</span>.</p>
<p>Fuente: Pagano M, Gauvreau K y Pagano RR, Principles of Biostatistics. 2ª edición. Duxbury Press, 2000: página 136.</p>
<p><strong>Respuesta Ejercicio 2</strong> - Sensibilidad (Se) = 1 - Falso Negativo = 1 - 0.1625 = 0.8375 o 83.75% - Especificidad (Sp) = 1 - Falso Positivo = 1 - 0.1864 = 0.8136 o 81.36% Usando R y epiR:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epiR)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">as.table</span>(</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="fl">83.75</span>, <span class="fl">18.64</span>), <span class="fu">c</span>(<span class="fl">16.25</span>, <span class="fl">81.36</span>))</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(tb) <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test =</span> <span class="fu">c</span>(<span class="st">"+"</span>, <span class="st">"-"</span>),</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Outcome =</span> <span class="fu">c</span>(<span class="st">"+"</span>, <span class="st">"-"</span>)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.tests</span>(tb, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Outcome +    Outcome -      Total
Test +         83.8         18.6      102.4
Test -         16.2         81.4       97.6
Total         100.0        100.0      200.0

Point estimates and 95% CIs:
--------------------------------------------------------------
Apparent prevalence *                  0.512 (0.440, 0.583)
True prevalence *                      0.500 (0.429, 0.571)
Sensitivity *                          0.838 (0.750, 0.904)
Specificity *                          0.814 (0.723, 0.884)
Positive predictive value *            0.818 (0.729, 0.887)
Negative predictive value *            0.834 (0.745, 0.901)
Positive likelihood ratio              4.493 (2.957, 6.828)
Negative likelihood ratio              0.200 (0.127, 0.315)
False T+ proportion for true D- *      0.186 (0.116, 0.277)
False T- proportion for true D+ *      0.163 (0.096, 0.250)
False T+ proportion for T+ *           0.182 (0.113, 0.271)
False T- proportion for T- *           0.166 (0.099, 0.255)
Correctly classified proportion *      0.826 (0.766, 0.875)
--------------------------------------------------------------
* Exact CIs</code></pre>
</div>
</div>
<p>-Ejercicio 3:</p>
<p>Entre 1820 sujetos disponibles en un estudio, 30 padecían tuberculosis y 1790 no. Se realizaron radiografías de tórax a todos los individuos; 73 tuvieron una radiografía positiva, lo que implicaba evidencia significativa de enfermedad inflamatoria, mientras que los resultados de los otros 1747 fueron negativos. Los datos de este estudio se presentan en la tabla a continuación. Según un informe, en 1987, hubo 9.3 casos de tuberculosis por cada 100,000 habitantes.</p>
<p>¿Cuál es la probabilidad de que un individuo seleccionado al azar en 1987 tenga tuberculosis dado que su radiografía es positiva?</p>
<p>¿Cuál es la probabilidad de que un individuo seleccionado al azar en 1987 no tenga tuberculosis dado que su radiografía es negativa?</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Radiografía</strong></th>
<th style="text-align: center;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Tuberculosis</strong></td>
<td style="text-align: center;"><strong>No</strong></td>
<td style="text-align: center;"><strong>Sí</strong></td>
<td style="text-align: left;"><strong>Total</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Negativo</td>
<td style="text-align: center;">1739</td>
<td style="text-align: center;">8</td>
<td style="text-align: left;">1747</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Positivo</td>
<td style="text-align: center;">51</td>
<td style="text-align: center;">22</td>
<td style="text-align: left;">73</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Total</strong></td>
<td style="text-align: center;">1790</td>
<td style="text-align: center;">30</td>
<td style="text-align: left;">1820</td>
</tr>
</tbody>
</table>
<p>Fuente: Pagano M, Gauvreau K y Pagano RR, Principles of Biostatistics. 2ª edición. Duxbury Press, 2000; página 138.</p>
<p><strong>LEER:</strong> Deeks y Altman. Pruebas diagnósticas 4: razones de verosimilitud. BMJ 2004;329:168-169 <span class="citation" data-cites="deeks2004">[<a href="#ref-deeks2004" role="doc-biblioref">6</a>]</span> <a href="https://www.bmj.com/content/329/7458/168" class="uri">https://www.bmj.com/content/329/7458/168</a></p>
<p>A veces se afirma que la sensibilidad y la especificidad son características de la prueba diagnóstica en sí y que son invariables a la prevalencia de la enfermedad. Esto es cierto para una prueba diagnóstica particular en un entorno particular para un grupo particular de pacientes y ayuda a enfatizar que el VPP y el VPN pueden cambiar (a medida que cambia la probabilidad pre-prueba), pero la sensibilidad y la especificidad no (dado un entorno y un espectro de pacientes particulares). Sin embargo, no es cierto en general. Si la mezcla (espectro) de pacientes (leve vs.&nbsp;grave) con el trastorno objetivo varía cuando varía la prevalencia, entonces la sensibilidad y la especificidad cambiarán, así como el VPP y el VPN. La sensibilidad y la especificidad son características de la prueba en un entorno particular, que tiene una mezcla particular de pacientes con enfermedad leve versus grave.</p>
<p><strong>Respuesta Ejercicio 3:</strong> Calculando a mano: - Valor Predictivo Positivo (VPP) = VP / (VP + FP) = 22 / (22 + 73) = 0.231 o 23.1% - Valor Predictivo Negativo (VPN) = VN / (VN + FN) = 1739 / (1739 + 8) = 0.995 o 99.5%</p>
<p>Usando R y epiR:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epiR)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">as.table</span>(</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">73</span>), <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">1739</span>))</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(tb) <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test =</span> <span class="fu">c</span>(<span class="st">"-"</span>, <span class="st">"+"</span>),</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Outcome =</span> <span class="fu">c</span>(<span class="st">"-"</span>, <span class="st">"+"</span>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.tests</span>(tb, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Outcome +    Outcome -      Total
Test +           22           73         95
Test -            8         1739       1747
Total            30         1812       1842

Point estimates and 95% CIs:
--------------------------------------------------------------
Apparent prevalence *                  0.052 (0.042, 0.063)
True prevalence *                      0.016 (0.011, 0.023)
Sensitivity *                          0.733 (0.541, 0.877)
Specificity *                          0.960 (0.950, 0.968)
Positive predictive value *            0.232 (0.151, 0.329)
Negative predictive value *            0.995 (0.991, 0.998)
Positive likelihood ratio              18.203 (13.330, 24.857)
Negative likelihood ratio              0.278 (0.153, 0.503)
False T+ proportion for true D- *      0.040 (0.032, 0.050)
False T- proportion for true D+ *      0.267 (0.123, 0.459)
False T+ proportion for T+ *           0.768 (0.671, 0.849)
False T- proportion for T- *           0.005 (0.002, 0.009)
Correctly classified proportion *      0.956 (0.946, 0.965)
--------------------------------------------------------------
* Exact CIs</code></pre>
</div>
</div>
<p>-<strong>Ejercicio 4:</strong></p>
<p>Este ejercicio se basa en Una gammagrafía de ventilación-perfusión (V/Q scan) se utiliza para el diagnóstico de embolia pulmonar (EP). Algunos datos sobre sus características se dan en la Tabla 1 (de The PIOPED Investigators. Value of the ventilation/perfusion scan in acute pulmonary embolism. Results of the prospective investigation of pulmonary embolism diagnosis (PIOPED). J Am Med Assoc 263. 2753-9 (1990)) <span class="citation" data-cites="pioped1990">[<a href="#ref-pioped1990" role="doc-biblioref">11</a>]</span>.</p>
<p>Tabla. La relación entre los resultados de las angiografías pulmonares y los resultados de la gammagrafía V/Q (incluyendo 150 pacientes con gammagrafías V/Q de baja probabilidad/casi normales/normales, sin (136) o angiografías no interpretables (14), y sin tromboembolismo clínicamente importante en el seguimiento).</p>
<table class="caption-top table">
<colgroup>
<col style="width: 52%">
<col style="width: 24%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Categoría de la gammagrafía V/Q</strong></th>
<th style="text-align: center;"><strong>Angiograma</strong></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: center;"><strong>EP presente</strong></td>
<td style="text-align: center;"><strong>EP ausente</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Alta probabilidad</td>
<td style="text-align: center;">102</td>
<td style="text-align: center;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Probabilidad intermedia</td>
<td style="text-align: center;">105</td>
<td style="text-align: center;">217</td>
</tr>
<tr class="even">
<td style="text-align: left;">Baja probabilidad</td>
<td style="text-align: center;">39</td>
<td style="text-align: center;">273</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Casi normal / normal</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">126</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Total</strong></td>
<td style="text-align: center;">251</td>
<td style="text-align: center;">630</td>
</tr>
</tbody>
</table>
<p>Usando las razones de verosimilitud, calcule la probabilidad post-prueba de EP en los siguientes dos pacientes: -Una mujer anciana experimenta dificultad para respirar y molestias en el pecho 10 días después de la cirugía. La mayoría de los médicos estarían de acuerdo en que la probabilidad de que esta paciente tenga EP es bastante alta, alrededor del 70%. El resultado de su gammagrafía se informa como “probabilidad intermedia” de EP. ¿Cuál es la estimación post-prueba de su probabilidad de EP?</p>
<p>-Otro paciente es un hombre de 28 años con dolor torácico no específico e hiperventilación después de completar un viaje en coche de 10 horas. Los resultados de un examen físico fueron normales, pero los resultados de la gammagrafía V/Q se informaron como “probabilidad intermedia” de EP. La estimación clínica de su probabilidad pre-prueba de EP es de aproximadamente el 20%. ¿Cuál es su probabilidad post-prueba?</p>
<p><strong>Respuesta Ejercicio 4:</strong> Calcule las razones de verosimilitud de esta tabla: - Razón de verosimilitud (LR) para alta probabilidad = Se / (1 - Sp) = (102 / 251) / (14 / 630) = 18.3 - LR para probabilidad intermedia = (105 / 251) / (217 / 630) = 1.2 - LR para baja probabilidad = (39 / 251) / (273 / 630) = 0.36 - LR para casi normal / normal = (5 / 251) / (126 / 630) = 0.1 -Usando el teorema de Bayes tendríamos que la Probabilidad post-prueba = (Probabilidad pre-prueba * LR) / (Probabilidad pre-prueba * LR + (1 - Probabilidad pre-prueba)). Por ejemplo para la situación intermedia tendríamos: Probabilidad pre-prueba intermedia = 0.70 (70%) y LR = 1.2 (probabilidad intermedia) Probabilidad post-prueba = (0.70 * 1.2) / (0.70 * 1.2 + (1 - 0.70)) = 0.74 (74%) Y así sucesivamente para todoas las situaciones. Vease en la siguiente tabla las probabilidades pre-prueba, razones de verosimilitud de los resultados de la gammagrafía de ventilación/perfusión, y probabilidades post-prueba en dos pacientes con embolia pulmonar.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Probabilidad pre-prueba, % (Rango)</th>
<th style="text-align: left;">Resultado de la gammagrafía y razón de verosimilitud</th>
<th style="text-align: left;">Probabilidad post-prueba, % (Rango)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Mujer de 78 años con disnea de aparición repentina después de cirugía abdominal</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">(60) 70% (80)</td>
<td style="text-align: left;">Alta probabilidad: LR = 18.3</td>
<td style="text-align: left;">(96%) 97% (99%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(60) 70% (80)</td>
<td style="text-align: left;">Probabilidad intermedia: LR = 1.2</td>
<td style="text-align: left;">(64%) 74% (83%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">(60) 70% (80)</td>
<td style="text-align: left;">Baja probabilidad: LR = 0.36</td>
<td style="text-align: left;">(35%) 46% (59%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(60) 70% (80)</td>
<td style="text-align: left;">Normal/casi normal: LR = 0.1</td>
<td style="text-align: left;">(13%) 19% (29%)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Hombre de 28 años con disnea y dolor torácico atípico</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">(10) 20% (30)</td>
<td style="text-align: left;">Alta probabilidad: LR = 18.3</td>
<td style="text-align: left;">(67%) 82% (89%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">(10) 20% (30)</td>
<td style="text-align: left;">Probabilidad intermedia: LR = 1.2</td>
<td style="text-align: left;">(12%) 23% (34%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(10) 20% (30)</td>
<td style="text-align: left;">Baja probabilidad: LR = 0.36</td>
<td style="text-align: left;">(4%) 8% (12%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">(10) 20% (30)</td>
<td style="text-align: left;">Normal/casi normal: LR = 0.1</td>
<td style="text-align: left;">(1%) 2% (4%)</td>
</tr>
</tbody>
</table>
<p>Los valores entre paréntesis representan un rango plausible de probabilidades pre-prueba. Es decir, aunque la mejor estimación de la probabilidad pre-prueba es del 70%, valores del 60% al 80% también serían estimaciones razonables.</p>
<p>En R lo calculamos así:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epiR)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para calcular la probabilidad post-prueba usando el teorema de Bayes</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>post_test_prob <span class="ot">&lt;-</span> <span class="cf">function</span>(pre_test_prob, lr) {</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  (pre_test_prob <span class="sc">*</span> lr) <span class="sc">/</span> (pre_test_prob <span class="sc">*</span> lr <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> pre_test_prob))</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Razones de verosimilitud</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>lr_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">18.3</span>, <span class="fl">1.2</span>, <span class="fl">0.36</span>, <span class="fl">0.1</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades pre-prueba para los dos pacientes</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>pre_test_probs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="fl">0.60</span>, <span class="fl">0.70</span>, <span class="fl">0.80</span>), <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.20</span>, <span class="fl">0.30</span>))</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular probabilidades post-prueba</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">lapply</span>(pre_test_probs, <span class="cf">function</span>(pre_probs) {</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(lr_values, <span class="cf">function</span>(lr) {</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(pre_probs, <span class="cf">function</span>(pre) <span class="fu">post_test_prob</span>(pre, lr))</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>results</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
          [,1]      [,2]      [,3]      [,4]
[1,] 0.9648506 0.6428571 0.3506494 0.1304348
[2,] 0.9771167 0.7368421 0.4565217 0.1891892
[3,] 0.9865229 0.8275862 0.5901639 0.2857143

[[2]]
          [,1]      [,2]       [,3]       [,4]
[1,] 0.6703297 0.1176471 0.03846154 0.01098901
[2,] 0.8206278 0.2307692 0.08256881 0.02439024
[3,] 0.8869144 0.3396226 0.13366337 0.04109589</code></pre>
</div>
</div>
<p><strong>Tamaño de la muestra e intervalo de confianza para pruebas diagnósticas</strong> <strong>LEER:</strong> Simel et al.&nbsp;1991 <span class="citation" data-cites="simel1991">[<a href="#ref-simel1991" role="doc-biblioref">5</a>]</span></p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/1941027/" class="uri">https://pubmed.ncbi.nlm.nih.gov/1941027/</a></p>
<p>El artículo señala que las razones de verosimilitud son algebraicamente idénticas a las razones de riesgo. Esto sugiere una forma de obtener intervalos de confianza para las razones de verosimilitud y un marco para calcular el tamaño de la muestra para estudios de procedimientos diagnósticos.</p>


</section>
<section id="bibliography" class="level1 unnumbered">
<h1 class="unnumbered">Referencias</h1>
<div id="refs" class="references csl-bib-body" role="list">
<div id="ref-anaesthetist" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">ROC analysis. [cited 2025 Aug 13]; Available from: <a href="http://www.anaesthetist.com/mnm/stats/roc/Findex.htm">http://www.anaesthetist.com/mnm/stats/roc/Findex.htm</a></div>
</div>
<div id="ref-practicalstats" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Harrell F. Practical statistics for medical research with r. 2023 [cited 2023 Nov 20]; Available from: <a href="https://practical-stats-med-r.netlify.app/">https://practical-stats-med-r.netlify.app/</a></div>
</div>
<div id="ref-altman1994sensitivity" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Altman DG, Bland JM. Diagnostic tests 1: Sensitivity and specificity. BMJ [Internet]. 1994;308:1552. Available from: <a href="https://www.bmj.com/content/308/6943/1552">https://www.bmj.com/content/308/6943/1552</a></div>
</div>
<div id="ref-altman1994predictive" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Altman DG, Bland JM. Diagnostic tests 2: Predictive values. BMJ [Internet]. 1994;309:102. Available from: <a href="https://www.bmj.com/content/309/6947/102">https://www.bmj.com/content/309/6947/102</a></div>
</div>
<div id="ref-simel1991" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Simel DL, Samsa SW, Matchar DB. Likelihood ratios and their confidence intervals. An introduction for clinicians. J Gen Intern Med [Internet]. 1991;6:568–74. Available from: <a href="https://pubmed.ncbi.nlm.nih.gov/1941027/">https://pubmed.ncbi.nlm.nih.gov/1941027/</a></div>
</div>
<div id="ref-deeks2004" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Deeks JJ, Altman DG. Diagnostic tests 4: Likelihood ratios. BMJ [Internet]. 2004;329:168–9. Available from: <a href="https://www.bmj.com/content/329/7458/168">https://www.bmj.com/content/329/7458/168</a></div>
</div>
<div id="ref-hanley1982" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Hanley JA, McNeil BJ. The meaning and use of the area under a receiver operating characteristic (ROC) curve. Radiology. 1982;143:29–36. </div>
</div>
<div id="ref-delong1988" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">DeLong ER, DeLong DM, Clarke-Pearson DL. Comparing the areas under two or more correlated receiver operating characteristic curves: A nonparametric approach. Biometrics [Internet]. 1988;44(3):837–45. Available from: <a href="https://www.jstor.org/stable/2531595">https://www.jstor.org/stable/2531595</a></div>
</div>
<div id="ref-schulzer1994" class="csl-entry" role="listitem">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">Schulzer M. Pruebas diagnósticas: Una revisión estadística. Muscle &amp; Nerve. 1994;17:815–9. </div>
</div>
<div id="ref-pagano2000" class="csl-entry" role="listitem">
<div class="csl-left-margin">10. </div><div class="csl-right-inline">Pagano M, Gauvreau K, Pagano RR. Principles of biostatistics. 2nd ed. Duxbury Press; 2000. </div>
</div>
<div id="ref-pioped1990" class="csl-entry" role="listitem">
<div class="csl-left-margin">11. </div><div class="csl-right-inline">Investigators TP. Value of the ventilation/perfusion scan in acute pulmonary embolism. Results of the prospective investigation of pulmonary embolism diagnosis (PIOPED). J Am Med Assoc. 1990;263:2753–9. </div>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Bienvenido!">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Bienvenido!</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./TEMA-2.html" class="pagination-link" aria-label="TEMA 2: ANÁLISIS DE LA VARIANZA">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">TEMA 2: ANÁLISIS DE LA VARIANZA</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>